!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/material"),require("@angular/common"),require("@angular/forms"),require("ngx-bootstrap/collapse"),require("rxjs"),require("moment"),require("lodash"),require("hammerjs"),require("ngx-file-uploader"),require("@angular/platform-browser"),require("ngx-webcam"),require("@angular/material/datepicker"),require("@angular/material/form-field"),require("@angular/material/core"),require("@angular/material-moment-adapter"),require("@angular/material/select"),require("pdfmake/build/pdfmake.js"),require("pdfmake/build/vfs_fonts.js"),require("time-ago-pipe")):"function"==typeof define&&define.amd?define("@ampath-kenya/ngx-openmrs-formentry",["exports","@angular/core","@angular/material","@angular/common","@angular/forms","ngx-bootstrap/collapse","rxjs","moment","lodash","hammerjs","ngx-file-uploader","@angular/platform-browser","ngx-webcam","@angular/material/datepicker","@angular/material/form-field","@angular/material/core","@angular/material-moment-adapter","@angular/material/select","pdfmake/build/pdfmake.js","pdfmake/build/vfs_fonts.js","time-ago-pipe"],t):t(((e=e||self)["ampath-kenya"]=e["ampath-kenya"]||{},e["ampath-kenya"]["ngx-openmrs-formentry"]={}),e.ng.core,e.ng.material,e.ng.common,e.ng.forms,e.collapse,e.rxjs,e.moment_,e.lodash,null,e.ngxFileUploader,e.ng.platformBrowser,e.ngxWebcam,e.ng.material.datepicker,e.ng.material["form-field"],e.ng.material.core,e.ng["material-moment-adapter"],e.ng.material.select,e.pdfMake,null,e.timeAgoPipe)}(this,(function(exports,core,material,common,forms,collapse,rxjs,moment_,lodash,hammerjs,ngxFileUploader,platformBrowser,ngxWebcam,datepicker,formField,core$1,materialMomentAdapter,select,pdfMake,vfs_fonts_js,timeAgoPipe){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function __extends(e,t){function o(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function __rest(e,t){var o={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(o[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(o[n[r]]=e[n[r]])}return o}function __decorate(e,t,o,n){var r,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,o,a):r(t,o))||a);return i>3&&a&&Object.defineProperty(t,o,a),a}function __param(e,t){return function(o,n){t(o,n,e)}}function __metadata(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function __awaiter(e,t,o,n){return new(o||(o=Promise))((function(r,i){function a(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){e.done?r(e.value):new o((function(t){t(e.value)})).then(a,s)}l((n=n.apply(e,t||[])).next())}))}function __generator(e,t){var o,n,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function __exportStar(e,t){for(var o in e)t.hasOwnProperty(o)||(t[o]=e[o])}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],o=0;return t?t.call(e):{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}}}function __read(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return a}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function __spreadArrays(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<o;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)n[r]=i[a];return n}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=o.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){r[e]&&(n[e]=function(t){return new Promise((function(o,n){i.push([e,t,o,n])>1||s(e,t)}))})}function s(e,t){try{(o=r[e](t)).value instanceof __await?Promise.resolve(o.value.v).then(l,c):u(i[0][2],o)}catch(e){u(i[0][3],e)}var o}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function __asyncDelegator(e){var t,o;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,r){t[n]=e[n]?function(t){return(o=!o)?{value:__await(e[n](t)),done:"return"===n}:r?r(t):t}:r}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,o=e[Symbol.asyncIterator];return o?o.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=e[o]&&function(t){return new Promise((function(n,r){(function(e,t,o,n){Promise.resolve(n).then((function(t){e({value:t,done:o})}),t)})(n,r,(t=e[o](t)).done,t.value)}))}}}function __makeTemplateObject(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function __importStar(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function __importDefault(e){return e&&e.__esModule?e:{default:e}}var DebugModeService=function(){function e(){this.cookieKey="formDebug"}return e.prototype.debugEnabled=function(){return!1},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),FormErrorsService=function(){function e(){this.announceErrorFieldSource=new rxjs.Subject,this.announceErrorField$=this.announceErrorFieldSource.asObservable()}return e.prototype.announceErrorField=function(e){this.announceErrorFieldSource.next(e)},e.control=null,e.tab=null,e=__decorate([core.Injectable()],e)}(),ControlRelation=function(){function e(e,t){this._control=e,this._relatedTo=t,this._registerForChangesFromRelatedControl()}return Object.defineProperty(e.prototype,"control",{get:function(){return this._control},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relatedTo",{get:function(){return this._relatedTo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastUpdateValue",{get:function(){return this._lastUpdateValue},enumerable:!0,configurable:!0}),e.prototype.updateControlBasedOnRelation=function(e){return e!==this._lastUpdateValue&&(this._lastUpdateValue=e,this._control.updateCalculatedValue&&this._control.updateCalculatedValue(),this._control.updateValueAndValidity(),this._control.updateHiddenState&&this._control.updateHiddenState(),this._control.updateDisabledState&&this._control.updateDisabledState(),this._control.updateAlert&&this._control.updateAlert(),!0)},e.prototype._registerForChangesFromRelatedControl=function(){var e=this;this._relatedTo.valueChanges.subscribe((function(t){e.updateControlBasedOnRelation(t)}))},e}(),ControlRelations=function(){function e(e,t){this._otherRelations=[],this._relationFor=e,this._relations=[],t&&this.addRelatedControls(t)}return Object.defineProperty(e.prototype,"relationsFor",{get:function(){return this._relationFor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relations",{get:function(){return this._relations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"otherRelations",{get:function(){return this._otherRelations},enumerable:!0,configurable:!0}),e.prototype.addRelatedControls=function(e){if(e instanceof forms.AbstractControl&&this.relations.push(new ControlRelation(this._relationFor,e)),e instanceof Array)for(var t=0;t<e.length;t++)this.relations.push(new ControlRelation(this._relationFor,e[t]))},e}(),HiderHelper=function(){function e(){}return e.prototype.hideControl=function(e){e.hidden=!0,e.disable&&e.disable()},e.prototype.showControl=function(e){e.hidden=!1},e.prototype.setHiderForControl=function(e,t){e.hiders.push(t)},e.prototype.clearHidersForControl=function(e){e.hiders.splice(0),e.hidden=!1},e.prototype.evaluateControlHiders=function(e){var t=!1;e.hiders.forEach((function(e){e.reEvaluateHidingExpression(),!0===e.toHide&&(t=!0)})),e.hidden=t,e.hidden&&e.disable&&e.disable()},e.prototype.setUpReEvaluationWhenValueChanges=function(e){e.updateHiddenState&&e.valueChanges.subscribe((function(t){e.updateHiddenState()}))},e}(),AlertHelper=function(){function e(){}return e.prototype.hideAlert=function(e){e.shown=!1},e.prototype.showAlert=function(e){e.shown=!0},e.prototype.setAlertsForControl=function(e,t){e.alerts.push(t)},e.prototype.clearAlertsForControl=function(e){e.alerts.splice(0),e.alert=""},e.prototype.evaluateControlAlerts=function(e){var t="";e.alerts.forEach((function(e){e.reEvaluateAlertExpression(),t=!0===e.shown?e.alertMessage:""})),e.alert=t},e.prototype.setUpReEvaluationWhenValueChanges=function(e){e.updateAlert&&e.valueChanges.subscribe((function(t){e.updateAlert()}))},e}(),DisablerHelper=function(){function e(){}return e.prototype.setDisablerForControl=function(e,t){e.disablers.push(t)},e.prototype.clearDisablersForControl=function(e){e.disablers.splice(0),e.disable()},e.prototype.evaluateControlDisablers=function(e){var t=!1;e.disablers.forEach((function(e){e.reEvaluateDisablingExpression(),!0===e.toDisable&&(t=!0)})),t?e.disable():e.enable()},e.prototype.setUpReEvaluationWhenValueChanges=function(e){e.updateDisabledState&&e.valueChanges.subscribe((function(t){e.updateDisabledState()}))},e}(),NodeBase=function(){function e(e,t,o,n){this._control=t,this._questionModel=e,this._form=o,this._path=n?n+"."+e.key:e.key}return Object.defineProperty(e.prototype,"question",{get:function(){return this._questionModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"control",{get:function(){return this._control},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{get:function(){return this._form},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),e.prototype.removeAt=function(e){},e.prototype.createChildNode=function(){},e.prototype.removeChildNode=function(){},e}(),LeafNode=function(e){function t(t,o,n,r,i){return e.call(this,t,o,r,i)||this}return __extends(t,e),t}(NodeBase),GroupNode=function(e){function t(t,o,n,r,i){var a=e.call(this,t,o,r,i)||this;return a._children={},a}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),t.prototype.setChild=function(e,t){this.children[e]=t},t}(NodeBase),ArrayNode=function(e){function t(t,o,n,r,i,a){var s=e.call(this,t,o,i,a)||this;return s.formFactory=r,s.childNodeCreatedEvents=[],s._children=[],s.childNodeCreatedEvents=[],s}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),t.prototype.createChildNode=function(){if(this.createChildFunc){var e=this.createChildFunc(this.question,this,this.formFactory);return this.fireChildNodeCreatedListener(e),e}return null},t.prototype.removeAt=function(e){this.removeChildFunc&&this.removeChildFunc(e,this)},t.prototype.addChildNodeCreatedListener=function(e){this.childNodeCreatedEvents.push(e)},t.prototype.fireChildNodeCreatedListener=function(e){for(var t=0;t<this.childNodeCreatedEvents.length;t++){(0,this.childNodeCreatedEvents[t])(e)}},t}(NodeBase),ValidationModel=function(e){this.type=e.type,this.message=e.message||null},JsExpressionValidationModel=function(e){function t(t){var o=e.call(this,t)||this;return o.failsWhenExpression=t.failsWhenExpression,o}return __extends(t,e),t}(ValidationModel),ConditionalValidationModel=function(e){function t(t){var o=e.call(this,t)||this;return o.referenceQuestionId=t.referenceQuestionId,o.referenceQuestionAnswers=t.referenceQuestionAnswers,o}return __extends(t,e),t}(ValidationModel),ControlRelationsFactory=function(){function e(){}return e.prototype.buildRelations=function(e){var t=this.mapControlIds(e,{});for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];this.setRelations(t,n)}},e.prototype.buildArrayNodeRelations=function(e){var t=e.form;if(t){var o=t.rootNode;this.buildRelations(e);var n=this.mapControlIds(o,{}),r=this.mapControlIds(e,{});for(var i in n){if(n.hasOwnProperty(i))if((l=n[i])instanceof LeafNode){var a=l.question;a.key&&a.key.length>0&&this.setRelations(r,l)}}for(var s in this.createRelationsToArrayControls(e),r)if(r.hasOwnProperty(s)){var l,c=(l=r[s]).control;c.updateHiddenState(),c.updateAlert()}}},e.prototype.createRelationsToArrayControls=function(e){var t=e.form.rootNode,o=this.mapControlIds(t,{}),n=this.mapControlIds(e,{});for(var r in o)if(o.hasOwnProperty(r)){var i=o[r],a=e.path.substring(0,e.path.lastIndexOf("."));if(-1===i.path.indexOf(a+".")){var s=function(o){if(n.hasOwnProperty(o)){var r=n[o],s=r.question.key;if(l.hasRelation(s,i.question)){var c=e.form.searchNodeByPath(t,a,[]);if(c.length>0){var u=c[0],d=i.control;-1===d.controlRelations.otherRelations.indexOf(u)&&d.controlRelations.otherRelations.push(u),r.control.addValueChangeListener((function(e){d.updateCalculatedValue&&d.updateCalculatedValue(),d.updateValueAndValidity(),d.updateHiddenState&&d.updateHiddenState(),d.updateAlert&&d.updateAlert(),d.updateDisabledState&&d.updateDisabledState()}))}}}},l=this;for(var c in n)s(c)}}},e.prototype.getRelationsForControl=function(e,t){var o=new Array,n=t.form.searchNodeByQuestionId(e);if(n.length>0){var r=n[0],i=this.mapControlIds(t,{});for(var a in i)i.hasOwnProperty(a)&&this.hasRelation(i[a].question.key,r.question)&&o.push(i[a].control)}return o},e.prototype.mapControlIds=function(e,t){var o=e.children;for(var n in o)if(o.hasOwnProperty(n)){var r=o[n];if(r instanceof GroupNode)this.mapControlIds(r,t);else if(r instanceof LeafNode){(i=r.question).key&&i.key.length>0&&(t[i.key]=r)}else if(r instanceof ArrayNode){var i;(i=r.question).key&&i.key.length>0&&(t[i.key]=r)}}return t},e.prototype.setRelations=function(e,t){var o=t.question.key;for(var n in e)if(e.hasOwnProperty(n)&&n!==o){var r=e[n],i=r.question;if(this.hasRelation(o,i,t)&&this.addRelationToControl(r.control,t.control),"object"==typeof i.required){var a=i.required;"conditionalRequired"===a.type&&a.referenceQuestionId===o&&this.addRelationToControl(r.control,t.control)}}},e.prototype.hasRelation=function(e,t,o){var n=!1;if(t.validators&&t.validators.length>0&&t.validators.forEach((function(t){if(t instanceof JsExpressionValidationModel){var o=t.failsWhenExpression;o&&-1!==o.indexOf(e)&&(n=!0)}else t instanceof ConditionalValidationModel&&"conditionalAnswered"===t.type&&t.referenceQuestionId===e&&(n=!0)})),!n){if("string"==typeof t.hide){var r=t.hide;r.length>0&&-1!==r.indexOf(e)&&(n=!0)}else if("object"==typeof t.hide){t.hide.field===e&&(n=!0)}if(t.alert&&"object"==typeof t.alert&&(n=!0),"string"==typeof t.disable){var i=t.disable;i.length>0&&-1!==i.indexOf(e)&&(n=!0)}}return!n&&t.calculateExpression&&t.calculateExpression.length>0&&-1!==t.calculateExpression.indexOf(e)&&(n=!0),n},e.prototype.addRelationToControl=function(e,t){e.controlRelations.addRelatedControls(t)},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),moment=moment_,ExpressionRunner=function(){function ExpressionRunner(){}return ExpressionRunner.prototype.getRunnable=function(expression,control,helper,dataDependencies,form){var runner=this,runnable={run:function(){var scope={};control.uuid&&(scope[control.uuid]=control.value),window.moment=moment,scope.myValue=control.value,runner.getControlRelationValueString(control,scope),runner.getHelperMethods(helper,scope),runner.getDataDependencies(dataDependencies,scope),form&&runner.getDataDependencies(form.dataSourcesContainer.dataSources,scope);var paramList="",argList="";for(var o in scope)paramList=""===paramList?paramList+o:paramList+","+o,argList=""===argList?argList+"scope['"+o+"']":argList+",scope['"+o+"']";-1===expression.indexOf("return")&&(expression='"return '+expression+'"');var funcDeclarationCode='var afeDynamicFunc = new Function("'+paramList+'", '+expression+");",funcCallCode="afeDynamicFunc.call(this "+(""===argList?"":","+argList)+");";try{return Object.keys(scope).indexOf("undefined")>=0?(console.warn("Missing reference found",expression,scope),!1):eval(funcDeclarationCode+funcCallCode)}catch(e){return!1}}};return runnable},ExpressionRunner.prototype.getControlRelationValueString=function(e,t){var o=this;e&&e.controlRelations&&e.controlRelations.relations&&e.controlRelations.relations.forEach((function(e){if(e.relatedTo){var o=e.relatedTo,n=e.relatedTo;n&&Array.isArray(n.value)?t[o.uuid]=e.relatedTo.value:t[o.uuid]=e.relatedTo.value&&e.relatedTo.value.value?e.relatedTo.value.value:e.relatedTo.value}})),e&&e.controlRelations&&e.controlRelations.otherRelations&&e.controlRelations.otherRelations.length>0&&e.controlRelations.otherRelations.forEach((function(n){if(n instanceof ArrayNode){var r=n,i=e.uuid,a=new ControlRelationsFactory,s=[];r.children.forEach((function(e){s=s.concat(a.getRelationsForControl(i,e))})),o.setControlArrayValues(e,s,t)}}))},ExpressionRunner.prototype.setControlArrayValues=function(e,t,o){var n=this;this._getFormControlKeys(t).forEach((function(e){var r=n._getValuesForKey(e,t);o[e]=r}))},ExpressionRunner.prototype._getFormControlKeys=function(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e.uuid)&&t.push(e.uuid)})),t},ExpressionRunner.prototype._getValuesForKey=function(e,t){var o=[];return t.forEach((function(t){t.uuid===e&&o.push(t.value)})),o},ExpressionRunner.prototype.getHelperMethods=function(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},ExpressionRunner.prototype.getDataDependencies=function(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},ExpressionRunner}(),AfeFormControl=function(e){function t(t,o,n){var r=e.call(this,t,o,n)||this;return r.hidden=!1,r.hiderHelper=new HiderHelper,r.disablerHelper=new DisablerHelper,r.AlertHelper=new AlertHelper,r._controlRelations=new ControlRelations(r),r.hiders=[],r.disablers=[],r.alerts=[],r.valueChanges.subscribe((function(e){r._previousValue!==e&&(r.fireValueChangeListener(e),r._previousValue=e)})),r}return __extends(t,e),Object.defineProperty(t.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),t.prototype.disable=function(t){e.prototype.disable.call(this,t),e.prototype.setValue.call(this,"")},t.prototype.hide=function(){this.hiderHelper.hideControl(this)},t.prototype.show=function(){this.hiderHelper.showControl(this)},t.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},t.prototype.setCalculatorFn=function(e){this.calculator=e},t.prototype.updateCalculatedValue=function(){if(this.calculator){var e=this.calculator.call(ExpressionRunner,{});this.setValue(e)}},t.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},t.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},t.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},t.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},t.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},t.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},t.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},t.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},t.prototype.addValueChangeListener=function(e){this._valueChangeListener=e},t.prototype.fireValueChangeListener=function(e){this._valueChangeListener&&"function"==typeof this._valueChangeListener&&this._valueChangeListener(e)},t.prototype.setValue=function(t){e.prototype.setValue.call(this,t)},t}(forms.FormControl),AfeFormGroup=function(e){function t(t,o,n){var r=e.call(this,t,o,n)||this;return r.hiderHelper=new HiderHelper,r.disablerHelper=new DisablerHelper,r.AlertHelper=new AlertHelper,r._controlRelations=new ControlRelations(r),r.hiders=[],r.disablers=[],r.alerts=[],r}return __extends(t,e),Object.defineProperty(t.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),t.prototype.hide=function(){this.hiderHelper.hideControl(this)},t.prototype.show=function(){this.hiderHelper.showControl(this)},t.prototype.disable=function(t){e.prototype.disable.call(this,t),e.prototype.setValue.call(this,{})},t.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},t.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},t.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},t.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},t.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},t.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},t.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},t.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},t.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},t.prototype.setValue=function(t){e.prototype.setValue.call(this,t)},t}(forms.FormGroup),AfeFormArray=function(e){function t(t,o,n){var r=e.call(this,t,o,n)||this;return r.hiderHelper=new HiderHelper,r.AlertHelper=new AlertHelper,r.disablerHelper=new DisablerHelper,r._controlRelations=new ControlRelations(r),r.hiders=[],r.alerts=[],r.disablers=[],r.valueChanges.subscribe((function(e){r._previousValue!==e&&(r.fireValueChangeListener(e),r._previousValue=e)})),r}return __extends(t,e),Object.defineProperty(t.prototype,"uuid",{get:function(){return this._uuid},set:function(e){this._uuid=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controlRelations",{get:function(){return this._controlRelations},enumerable:!0,configurable:!0}),t.prototype.hide=function(){this.hiderHelper.hideControl(this)},t.prototype.show=function(){this.hiderHelper.showControl(this)},t.prototype.disable=function(t){e.prototype.disable.call(this,t),e.prototype.setValue.call(this,[])},t.prototype.setHidingFn=function(e){this.hiderHelper.setHiderForControl(this,e)},t.prototype.clearHidingFns=function(){this.hiderHelper.clearHidersForControl(this)},t.prototype.updateHiddenState=function(){this.hiderHelper.evaluateControlHiders(this)},t.prototype.setDisablingFn=function(e){this.disablerHelper.setDisablerForControl(this,e)},t.prototype.clearDisablingFns=function(){this.disablerHelper.clearDisablersForControl(this)},t.prototype.updateDisabledState=function(){this.disablerHelper.evaluateControlDisablers(this)},t.prototype.setAlertFn=function(e){this.AlertHelper.setAlertsForControl(this,e)},t.prototype.clearMessageFns=function(){this.AlertHelper.clearAlertsForControl(this)},t.prototype.updateAlert=function(){this.AlertHelper.evaluateControlAlerts(this)},t.prototype.addValueChangeListener=function(e){this._valueChangeListener=e},t.prototype.fireValueChangeListener=function(e){this.alerts.length>0&&this.updateAlert(),this._valueChangeListener&&"function"==typeof this._valueChangeListener&&this._valueChangeListener(e)},t.prototype.setValue=function(t){e.prototype.setValue.call(this,t)},t}(forms.FormArray),AfeControlType;AfeControlType=exports.AfeControlType||(exports.AfeControlType={}),AfeControlType[AfeControlType.AfeFormControl=0]="AfeFormControl",AfeControlType[AfeControlType.AfeFormArray=1]="AfeFormArray",AfeControlType[AfeControlType.AfeFormGroup=2]="AfeFormGroup",AfeControlType[AfeControlType.None=3]="None";var QuestionBase=function(){function e(e){this.defaultValue=e.defaultValue,this.originalValue=e.originalValue,this.extras=e.extras,this.renderingType=e.type,this.key=e.key||"",this.label=e.label||"",this.validators=e.validators||[],this.required=e.required,this.hide=e.hide,this.disable=e.disable,this.alert=e.alert,this.historicalDataValue=e.historicalDataValue,this.calculateExpression=e.calculateExpression}return e.prototype.setHistoricalValue=function(e){this.enableHistoricalValue=e},e.prototype.showHistoricalEncounterDate=function(e){this.showHistoricalValueDate=void 0===e||e},e}(),ConditionalRequiredValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){var o,n=t.value,r=null,i=e.referenceQuestionId,a=e.referenceQuestionAnswers;return t&&t.controlRelations&&t.controlRelations.relations&&t.controlRelations.relations.forEach((function(e){var t=e.relatedTo;t.uuid===i&&(r=t&&Array.isArray(t.value)?e.relatedTo.value:e.relatedTo.value&&e.relatedTo.value.value?e.relatedTo.value.value:e.relatedTo.value)})),"object"==typeof a&&-1!==a.indexOf(r)&&(o=!0),o&&!n?{conditional_required:{message:e.message}}:null}},e}(),ConditionalAnsweredValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){var o=t.value,n=null,r=e.referenceQuestionId,i=e.referenceQuestionAnswers,a=!0;return o&&t&&t.controlRelations&&t.controlRelations.relations&&t.controlRelations.relations.forEach((function(e){var t=e.relatedTo;t.uuid===r&&(n=Array.isArray(t.value)?t.value:t.value&&"object"==typeof t.value&&t.value.value?t.value.value:t.value),n?"object"==typeof i&&-1===i.indexOf(n)&&(a=!1):a=!1})),a?null:{conditional_answered:{message:e.message}}}},e}(),RequiredValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value;return null==t||"string"==typeof t&&0===t.length?{required:!0}:null},e}(),DateValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value;return t&&0!==t.length?!/Invalid|NaN/.test(new Date(t).toString())?null:{date:!0}:null},e}(),MinValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){if(t.hidden)return null;if(t.value&&0!==t.value.length){var o=t.value;return o>=e?null:{min:{requiredValue:e,actualValue:o}}}return null}},e}(),MaxValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){if(t.hidden)return null;if(t.value&&0!==t.value.length){var o=t.value;return o<=e?null:{max:{requiredValue:e,actualValue:o}}}return null}},e}(),MinDateValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){if(t.hidden)return null;if(t.value&&0!==t.value.length){if((new DateValidator).validate(t.value))return{mindate:{requiredDate:e}};var o=new Date(t.value);return o.getTime()<e.getTime()?{mindate:{requiredDate:e,actualDate:o}}:null}return null}},e}(),MaxDateValidator=function(){function e(){}return e.prototype.validate=function(e){return function(t){if(t.hidden)return null;if(t.value&&0!==t.value.length){if((new DateValidator).validate(t.value))return{maxdate:{requiredDate:e}};var o=new Date(t.value);return o.getTime()>e.getTime()?{maxdate:{requiredDate:e,actualDate:o}}:null}return null}},e}(),FutureDateRestrictionValidator=function(){function e(){}return e.prototype.validate=function(e){if(e.hidden)return null;var t=e.value,o=new Date;if(t&&0!==t.length&&!(new DateValidator).validate(t))return new Date(t).getTime()>o.getTime()?{futureDateRestriction:!0}:null;return null},e}(),JsExpressionHelper=function(){function e(){}return e.prototype.calcBMI=function(e,t){var o;return e&&t&&(o=(t/(e/100*e/100)).toFixed(1)),e&&t?parseFloat(o):null},e.prototype.calcBMIForAgeZscore=function(e,t,o){var n;t&&o&&(n=(o/(t/100*t/100)).toFixed(1));var r,i=lodash.first(e);if(i){var a=Object.keys(i).map((function(e){return i[e]})).map((function(e){return e})),s=Object.keys(i),l=a[1],c=[];n<l?c.push(l):lodash.forEach(a,(function(e){e<=n&&c.push(e)}));var u=lodash.last(c);(r=s[lodash.findIndex(a,(function(e){return e===u}))].replace("SD","")).includes("neg")&&(r="-"+(r=r.substring(1,0))),"S"!==r&&"L"!==r&&"M"!==r&&"-5"!==r||(r="-4")}return n&&i?r:null},e.prototype.calcWeightForHeightZscore=function(e,t,o){var n,r;t&&o&&(t=parseFloat(t).toFixed(1));t<45||t>110?r=-4:n=lodash.filter(e,(function(e){return parseFloat(e.Length).toFixed(1)===t}));var i=lodash.first(n);if(i){var a=Object.keys(i).map((function(e){return i[e]})).map((function(e){return e})),s=Object.keys(i),l=a[1],c=[];o<l?c.push(l):lodash.forEach(a,(function(e){e<=o&&c.push(e)}));var u=lodash.last(c);(r=s[lodash.findIndex(a,(function(e){return e===u}))].replace("SD","")).includes("neg")&&(r="-"+(r=r.substring(1,0))),"S"!==r&&"L"!==r&&"M"!==r&&"-5"!==r||(r="-4")}return t&&o?r:null},e.prototype.calcHeightForAgeZscore=function(e,t,o){var n,r=lodash.first(e);if(r){var i=Object.keys(r).map((function(e){return r[e]})).map((function(e){return e})),a=Object.keys(r),s=i[1],l=[];t<s?l.push(s):lodash.forEach(i,(function(e){e<=t&&l.push(e)}));var c=lodash.last(l);(n=a[lodash.findIndex(i,(function(e){return e===c}))].replace("SD","")).includes("neg")&&(n="-"+(n=n.substring(1,0))),"S"!==n&&"L"!==n&&"M"!==n&&"-5"!==n||(n="-4")}return t&&o&&r?n:null},e.prototype.isEmpty=function(e){return null==e||""===e||"null"===e||"undefined"===e||!(!Array.isArray(e)||0!==e.length)},e.prototype.arrayContains=function(e,t){if(Array.isArray(t)){if(0===t.length)return!0;for(var o=!0,n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&(o=!1)}return o}return-1!==e.indexOf(t)},e.prototype.extractRepeatingGroupValues=function(e,t){return t.map((function(t){return t[e]}))},e.prototype.formatDate=function(e,t,o){if(t=t||"yyyy-MM-dd",o=o||"+0300",!(e instanceof Date)&&null==(e=new Date(e)))throw new Error("DateFormatException: value passed is not a valid date");return e},e.prototype.arrayContainsAny=function(e,t){if(Array.isArray(t)){if(0===t.length)return!0;for(var o=!1,n=0;n<t.length;n++){var r=t[n];-1!==e.indexOf(r)&&(o=!0)}return o}return-1!==e.indexOf(t)},Object.defineProperty(e.prototype,"helperFunctions",{get:function(){return{arrayContainsAny:this.arrayContainsAny,calcBMI:this.calcBMI,calcBMIForAgeZscore:this.calcBMIForAgeZscore,calcWeightForHeightZscore:this.calcWeightForHeightZscore,calcHeightForAgeZscore:this.calcHeightForAgeZscore,isEmpty:this.isEmpty,arrayContains:this.arrayContains,extractRepeatingGroupValues:this.extractRepeatingGroupValues}},enumerable:!0,configurable:!0}),e}(),Validations=function(){function e(){}return e.JSExpressionValidatorsEnabled=!1,e}(),JsExpressionValidator=function(){function e(){}return e.prototype.validate=function(e,t){return function(o){if(!Validations.JSExpressionValidatorsEnabled)return null;var n=e.failsWhenExpression,r=(new JsExpressionHelper).helperFunctions;return(new ExpressionRunner).getRunnable(n,o,r,{},t).run()?{js_expression:{expression:n,message:e.message}}:null}},e}(),Messages=function(){function e(){}return e.REQUIRED_FIELD_MSG="This field is required!",e.INVALID_DATE_MSG="Provided date is invalid!",e.FUTURE_DATE_RESTRICTION_MSG="Future date is not allowed!",e.MIN_LENGTH_MSG="Min Length should be {minLength}",e.MAX_LENGTH_MSG="Max Length should be {maxLength}",e.MAX_DATE_MSG="Max Date should be {maxDate}",e.MIN_DATE_MSG="Min Date should be {minDate}",e.MAX_MSG="Max value should be {max}",e.MIN_MSG="Min value should be {min}",e}(),ValidationFactory=function(){function e(){}return e.prototype.getValidators=function(e,t){var o=this,n=[];return e.validators&&lodash.forEach(e.validators,(function(e){switch(e.type){case"date":n.push(o.dateValidator),e.allowFutureDates||n.push(o.futureDateRestrictionValidator);break;case"js_expression":n.push(o.jsExpressionValidator.validate(e,t));break;case"max":n.push(o.getMaxValueValidator(e.max));break;case"min":n.push(o.getMinValueValidator(e.min));break;case"conditionalRequired":n.push(o.conditionalRequiredValidator.validate(e));break;case"conditionalAnswered":n.push(o.conditionalAnsweredValidator.validate(e))}})),e.required&&"string"==typeof e.required&&"true"===e.required&&n.push(this.requiredValidator),n},Object.defineProperty(e.prototype,"conditionalRequiredValidator",{get:function(){return new ConditionalRequiredValidator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"conditionalAnsweredValidator",{get:function(){return new ConditionalAnsweredValidator},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requiredValidator",{get:function(){return(new RequiredValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateValidator",{get:function(){return(new DateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"futureDateRestrictionValidator",{get:function(){return(new FutureDateRestrictionValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDateValidator",{get:function(){return(new MaxDateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDateValidator",{get:function(){return(new MinDateValidator).validate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minLengthValidator",{get:function(){return forms.Validators.minLength},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxLengthValidator",{get:function(){return forms.Validators.maxLength},enumerable:!0,configurable:!0}),e.prototype.getMinValueValidator=function(e){return(new MinValidator).validate(e)},e.prototype.getMaxValueValidator=function(e){return(new MaxValidator).validate(e)},Object.defineProperty(e.prototype,"jsExpressionValidator",{get:function(){return new JsExpressionValidator},enumerable:!0,configurable:!0}),e.prototype.errors=function(e,t){var o=[];for(var n in e)if(e.hasOwnProperty(n))switch(n){case"required":o.push(Messages.REQUIRED_FIELD_MSG);break;case"date":o.push(Messages.INVALID_DATE_MSG);break;case"futureDateRestriction":o.push(Messages.FUTURE_DATE_RESTRICTION_MSG);break;case"minlength":o.push(Messages.MIN_LENGTH_MSG.replace("{minLength}",e.minlength.requiredLength));break;case"maxlength":o.push(Messages.MIN_LENGTH_MSG.replace("{maxLength}",e.maxlength.requiredLength));break;case"maxdate":o.push(Messages.MAX_DATE_MSG.replace("{maxDate}",e.maxdate.requiredDate));break;case"mindate":o.push(Messages.MIN_DATE_MSG.replace("{minDate}",e.mindate.requiredDate));break;case"max":o.push(Messages.MAX_MSG.replace("{max}",e.max.requiredValue));break;case"min":o.push(Messages.MIN_MSG.replace("{min}",e.min.requiredValue));break;case"js_expression":o.push(e.js_expression.message);break;case"conditional_required":o.push(e.conditional_required.message);break;case"conditional_answered":o.push(e.conditional_answered.message)}return o},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),HidersDisablersFactory=function(){function e(e,t,o){this.expressionRunner=e,this.expressionHelper=t,this._debugModeService=o}return e.prototype.getJsExpressionDisabler=function(e,t,o){var n=this.expressionRunner.getRunnable(e.disable,t,this.expressionHelper.helperFunctions,{},o),r={toDisable:!1,disableWhenExpression:e.disable,reEvaluateDisablingExpression:function(){var e=n.run();r.toDisable=e}};return r},e.prototype.getJsExpressionHider=function(e,t,o){var n=e.hide,r="object"==typeof n?this.convertHideObjectToString(n):e.hide,i=this._debugModeService.debugEnabled(),a=this.expressionRunner.getRunnable(r,t,this.expressionHelper.helperFunctions,{},o),s={toHide:!1,hideWhenExpression:r,reEvaluateHidingExpression:function(){s.toHide=!0!==i&&a.run()}};return s},e.prototype.convertHideObjectToString=function(e){return e.value instanceof Array?"!arrayContains(["+("'"+e.value.join("','")+"'")+"],"+e.field+")":""},e.ctorParameters=function(){return[{type:ExpressionRunner},{type:JsExpressionHelper},{type:DebugModeService}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[ExpressionRunner,JsExpressionHelper,DebugModeService])],e)}(),AlertsFactory=function(){function e(e,t){this.expressionRunner=e,this.expressionHelper=t}return e.prototype.getJsExpressionshowAlert=function(e,t,o){var n=this.expressionRunner.getRunnable(e.alert.alertWhenExpression,t,this.expressionHelper.helperFunctions,{},o),r={shown:!1,alertWhenExpression:e.alert.alertWhenExpression,alertMessage:e.alert.message,reEvaluateAlertExpression:function(){var e=n.run();r.shown=e}};return r},e.ctorParameters=function(){return[{type:ExpressionRunner},{type:JsExpressionHelper}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[ExpressionRunner,JsExpressionHelper])],e)}(),FormControlService=function(){function e(e,t,o){this.alertsFactory=o,this.controls=[],this.validationFactory=e,this.hidersDisablersFactory=t}return e.prototype.generateControlModel=function(e,t,o,n){if(e instanceof QuestionBase){if(e.controlType===exports.AfeControlType.AfeFormArray)return this.generateFormArray(e,t,n);if(e.controlType===exports.AfeControlType.AfeFormGroup)return this.generateFormGroupModel(e,o,t,n);if(e.controlType===exports.AfeControlType.AfeFormControl)return this.generateFormControl(e,t,n)}return null},e.prototype.generateFormGroupModel=function(e,t,o,n){var r=new AfeFormGroup({});this.wireHidersDisablers(e,r,n),this.wireAlerts(e,r,n),o instanceof AfeFormGroup&&o.setControl(e.key,r);var i=e;return t&&i&&i.questions.length>0&&this._generateFormGroupChildrenModel(i.questions,r,n),r},e.prototype._generateFormGroupChildrenModel=function(e,t,o){var n=this;e.length>0&&e.forEach((function(e){var r=n.generateControlModel(e,t,!0,o);null!==r&&t.addControl(e.key,r)}))},e.prototype.generateFormArray=function(e,t,o){var n,r=this.validationFactory.getValidators(e,o);return(n=r&&r.length>0?new AfeFormArray([],r[0]):new AfeFormArray([])).uuid=e.key,this.wireHidersDisablers(e,n,o),this.wireAlerts(e,n,o),t instanceof AfeFormGroup&&t.setControl(e.key,n),n},e.prototype.generateFormControl=function(e,t,o){var n=e.defaultValue||"",r=this.validationFactory.getValidators(e,o),i=new AfeFormControl(n,r);return i.uuid=e.key,this.wireHidersDisablers(e,i,o),this.wireAlerts(e,i,o),this.wireCalculator(e,i,o?o.dataSourcesContainer.dataSources:null),t instanceof AfeFormGroup&&t.setControl(e.key,i),i},e.prototype.wireAlerts=function(e,t,o){if(e.alert&&""!==e.alert){var n=this.alertsFactory.getJsExpressionshowAlert(e,t,o);t.setAlertFn(n)}},e.prototype.wireHidersDisablers=function(e,t,o){if(e.hide&&""!==e.hide){var n=this.hidersDisablersFactory.getJsExpressionHider(e,t,o);t.setHidingFn(n)}if(e.disable&&""!==e.disable){var r=this.hidersDisablersFactory.getJsExpressionDisabler(e,t,o);t.setDisablingFn(r)}},e.prototype.wireCalculator=function(e,t,o){if(e.calculateExpression&&""!==e.calculateExpression){var n=new JsExpressionHelper,r=(new ExpressionRunner).getRunnable(e.calculateExpression,t,n.helperFunctions,o);t.setCalculatorFn(r.run)}},e.ctorParameters=function(){return[{type:ValidationFactory},{type:HidersDisablersFactory},{type:AlertsFactory}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[ValidationFactory,HidersDisablersFactory,AlertsFactory])],e)}(),DEFAULT_STYLES='a {\n      color: white;\n      text-decoration: none;\n      font-size: 12px;\n      text-transform: uppercase;\n    }\n\n    ul {\n      list-style-type: none;\n      margin: 2px auto;\n      position: relative;\n    }\n\n    li {\n      display: block;\n      padding: 10px 20px;\n      white-space: nowrap;\n      transition: all 0.3s ease-in;\n      border-bottom: 4px solid transparent;\n    }\n\n    li:hover {\n      border-bottom: 4px solid white;\n      opacity: 0.7;\n      cursor: pointer;\n    }\n\n    .owl-theme .owl-controls .owl-nav {\n      position: absolute;\n      width: 100%;\n      top: 0;\n    }\n\n    .owl-theme .owl-controls .owl-nav [class*="owl-"] {\n      position: absolute;\n      background: none;\n      color: black;\n    }\n\n    .owl-theme .owl-controls .owl-nav [class*="owl-"]:hover {\n      background: none;\n      color: black;\n    }\n\n    .owl-theme .owl-controls .owl-nav .owl-next {\n      right: 0;\n      transform: translate(120%);\n    }\n\n    .owl-theme .owl-controls .owl-nav .owl-prev {\n      left: 0;\n      transform: translate(-120%);\n    }\n\n    .slick-initialized .swipe-tab-content {\n      position: relative;\n      min-height: 365px;\n    }\n    @media screen and (min-width: 767px) {\n      .slick-initialized .swipe-tab-content {\n        min-height: 500px;\n      }\n    }\n    .slick-initialized .swipe-tab {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      height: 50px;\n      background: none;\n      border: 0;\n      color: #757575;\n      cursor: pointer;\n      text-align: center;\n      border-bottom: 2px solid rgba(51, 122, 183, 0);\n      transition: all 0.5s;\n    }\n    .slick-initialized .swipe-tab:hover {\n      color: #337AB7;\n    }\n    .slick-initialized .swipe-tab.active-tab {\n      border-bottom-color: #337AB7;\n      color: #337AB7;\n      font-weight: bold;\n    }\n\n    .disabled {\n      opacity: .5;\n      pointer-events: none;\n    }\n\n    .select2-container {\n      margin-top: -5px;\n    }\n\n    .btn {\n      padding: 0px 12px !important;\n    }\n\n    .form-tooltip{\n      color:rgb(51, 122, 183);\n      display: inline-block;\n    }\n    .question-info{\n          opacity:0;\n          height:0px;\n          display: none;\n          transition-duration: opacity 1s ease-out;\n          transtion-delay: 0.5s;\n          padding-top: 2px;\n          padding-bottom: 2px;\n          color: #696969;\n          border-style: ridge;\n          border-width: 1px;\n          border-color: #337ab7;\n          margin-top: 2px;\n    }\n    .hide-info{\n      display:none;\n      height:0px;\n    }\n    .form-tooltip:hover ~ .question-info {\n          display:block;\n          opacity:1;\n          height:auto;\n     }\n    .form-tooltip .tooltipcontent::after {\n          content: " ";\n          position: absolute;\n          bottom: 100%;  /* At the top of the tooltip */\n          right: 0%;\n          margin-left: -5px;\n          border-width: 5px;\n          border-style: solid;\n          border-top-color: transparent;\n          border-right-color: transparent;\n          border-bottom-color: #337ab7;\n          border-left-color: transparent;\n }\n\n    ng-select.form-control {\n      padding-top: 0;\n      height: auto;\n      padding-bottom: 0;\n    }\n\n .forms-dropdown-menu {\n     max-height: 450px;\n     overflow-y: scroll;\n }\n .no-border {\n  border: 0;\n  box-shadow: none;\n}\n\n    ',DataSources=function(){function e(){this._dataSources={}}return Object.defineProperty(e.prototype,"dataSources",{get:function(){return this._dataSources},enumerable:!0,configurable:!0}),e.prototype.registerDataSource=function(e,t,o){if(void 0===o&&(o=!1),o)for(var n in t)console.log("registering",n,t[n]),this.registerDataSource(n,t[n],!1);this.dataSources[e]&&console.warn("Overriding registered data source",e),this._dataSources[e]=t},e.prototype.clearDataSource=function(e){delete this._dataSources[e]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),FormRendererComponent=function(){function e(e,t,o,n){this.validationFactory=e,this.dataSources=t,this.formErrorsService=o,this.document=n,this.childComponents=[],this.isCollapsed=!1,this.activeTab=0}return e.prototype.ngOnInit=function(){var e=this;if(this.setUpRemoteSelect(),this.setUpFileUpload(),this.node&&this.node.form){var t=this.node.form.valueProcessingInfo.lastFormTab;t&&t!==this.activeTab&&(this.activeTab=t)}this.node&&"form"===this.node.question.renderingType&&this.formErrorsService.announceErrorField$.subscribe((function(t){e.scrollToControl(t)})),this.node&&"section"===this.node.question.renderingType&&(this.isCollapsed=!this.node.question.isExpanded),this.parentComponent&&this.parentComponent.addChildComponent(this)},e.prototype.addChildComponent=function(e){this.childComponents.push(e)},e.prototype.setUpRemoteSelect=function(){this.node&&this.node.question.extras&&"remote-select"===this.node.question.renderingType&&(this.dataSource=this.dataSources.dataSources[this.node.question.dataSource],this.dataSource&&this.node.question.dataSourceOptions&&(this.dataSource.dataSourceOptions=this.node.question.dataSourceOptions))},e.prototype.setUpFileUpload=function(){this.node&&this.node.question.extras&&"file"===this.node.question.renderingType&&(this.dataSource=this.dataSources.dataSources[this.node.question.dataSource])},e.prototype.checkSection=function(e){if("section"===e.question.renderingType){var t=!1;return!Object.keys(e.children).every((function(o){var n=e.children[o];return n instanceof GroupNode&&(t=Object.keys(n.children).every((function(e){return n.children[e].control.hidden}))),e.children[o].control.hidden||t}))}return!0},e.prototype.clickTab=function(e){this.activeTab=e},e.prototype.loadPreviousTab=function(){this.isCurrentTabFirst()||(this.clickTab(this.activeTab-1),document.body.scrollTop=0)},e.prototype.isCurrentTabFirst=function(){return 0===this.activeTab},e.prototype.isCurrentTabLast=function(){return this.activeTab===this.node.question.questions.length-1},e.prototype.loadNextTab=function(){this.isCurrentTabLast()||(this.clickTab(this.activeTab+1),document.body.scrollTop=0)},e.prototype.tabSelected=function(e){this.activeTab=e,this.setPreviousTab()},e.prototype.setPreviousTab=function(){this.node&&this.node.form&&(this.node.form.valueProcessingInfo.lastFormTab=this.activeTab)},e.prototype.hasErrors=function(){return this.node.control.touched&&!this.node.control.valid},e.prototype.errors=function(){return this.getErrors(this.node)},e.prototype.scrollToControl=function(e){var t=this,o=+e.split(",")[0],n=e.split(",")[1]+"id",r=this.childComponents[o];this.clickTab(o),setTimeout((function(){r.childComponents.forEach((function(e){e.isCollapsed=!1,setTimeout((function(){var e=t.document.getElementById(n);null!==e&&e.focus&&(e.focus(),e.scrollIntoView({behavior:"smooth",block:"center"}))}),100)}))}),200)},e.prototype.onDateChanged=function(e){this.node=e},e.prototype.upload=function(e){},e.prototype.toggleInformation=function(e){var t=document.getElementById(e);"block"===t.style.display?t.style.display="none":t.style.display="block",console.log("InfoId",e)},e.prototype.getErrors=function(e){var t=e.control.errors;return t?this.validationFactory.errors(t,e.question):[]},e.ctorParameters=function(){return[{type:ValidationFactory},{type:DataSources},{type:FormErrorsService},{type:void 0,decorators:[{type:core.Inject,args:[common.DOCUMENT]}]}]},__decorate([core.Input(),__metadata("design:type",e)],e.prototype,"parentComponent",void 0),__decorate([core.Input(),__metadata("design:type",NodeBase)],e.prototype,"node",void 0),__decorate([core.Input(),__metadata("design:type",AfeFormGroup)],e.prototype,"parentGroup",void 0),e=__decorate([core.Component({selector:"form-renderer",template:'\x3c!--CONTAINERS--\x3e\n<div *ngIf="node.question.renderingType === \'form\'">\n  <div class="dropdown dropdown-tabs forms-dropdown">\n    <a class="btn dropdown-toggle" data-toggle="dropdown">\n      <i class="fa fa-angle-double-down"></i>\n    </a>\n    <ul class="dropdown-menu dropdown-menu-right forms-dropdown-menu" role="menu" aria-labelledby="dropdownMenu">\n      <li *ngFor="let question of node.question.questions; let i = index;" (click)="clickTab(i)">\n        {{question.label}}\n      </li>\n    </ul>\n  </div>\n  <mat-tab-group (selectedIndexChange)=\'tabSelected($event)\' [selectedIndex]=\'activeTab\'>\n    <mat-tab [label]=\'question.label\' *ngFor="let question of node.question.questions; let i = index;">\n      <div (swipeLeft)=\'loadNextTab()\' (swipeRight)=\'loadPreviousTab()\'>\n        <form-renderer [node]="node.children[question.key]" [parentComponent]="this" [parentGroup]="node.control"></form-renderer>\n      </div>\n    </mat-tab>\n  </mat-tab-group>\n\n  <div style="text-align: center;">\n    <button type="button" class="btn btn-default" (click)="loadPreviousTab()" [ngClass]="{disabled: isCurrentTabFirst()}">&lt;&lt;</button>\n    <button type="button" class="btn btn-default" (click)="loadNextTab()" [ngClass]="{disabled: isCurrentTabLast()}">\n      &gt;&gt;</button>\n  </div>\n</div>\n<div *ngIf="node.question.renderingType === \'page\'">\n  \x3c!--<h2>{{node.question.label}}</h2>--\x3e\n  <form-renderer *ngFor="let question of node.question.questions" [parentComponent]="this" [node]="node.children[question.key]"\n    [parentGroup]="parentGroup"></form-renderer>\n</div>\n<div *ngIf="node.question.renderingType === \'section\' && checkSection(node)"> \n  <div class="panel  panel-primary">\n    <div class="panel-heading">\n      <button type="button" class="btn btn-primary pull-right" (click)="isCollapsed = !isCollapsed">\n        {{isCollapsed ? \'Show\' : \'Hide\'}}\n      </button> {{node.question.label}}\n    </div>\n    <div class="panel-body" [collapse]="isCollapsed">\n      <form-renderer *ngFor="let question of node.question.questions" [parentComponent]="this" [node]="node.children[question.key]"\n        [parentGroup]="parentGroup"></form-renderer>\n    </div>\n  </div>\n</div>\n\n\x3c!-- MESSAGES --\x3e\n<div *ngIf="node.control && node.control.alert && node.control.alert !== \'\'" class="alert alert-warning">\n  <a class="close" data-dismiss="alert">&times;</a> {{node.control.alert}}\n</div>\n\n\x3c!--CONTROLS--\x3e\n\n<div *ngIf="node.question.controlType === 0" class="form-group" [formGroup]="parentGroup" [hidden]="node.control.hidden"\n  [ngClass]="{disabled: node.control.disabled}">\n  \x3c!--LEAF CONTROL--\x3e\n  <div class="question-area">\n    <a class="form-tooltip pull-right" (click)="toggleInformation(node.question.extras.id)" data-placement="right"\n      *ngIf="node.question && node.question.extras.questionInfo  && node.question.extras.questionInfo !== \'\'  && node.question.extras.questionInfo !== \' \'">\n      <i class="glyphicon glyphicon-question-sign" aria-hidden="true"></i>\n    </a>\n\n    <label *ngIf="node.question.label" [style.color]="hasErrors()? \'red\' :\'\'" class="control-label" [attr.for]="node.question.key">\n      {{node.question.required ? \'*\':\'\'}} {{node.question.label}}\n    </label>\n    <div [ngSwitch]="node.question.renderingType">\n      <select class="form-control" *ngSwitchCase="\'select\'" [formControlName]="node.question.key" [id]="node.question.key + \'id\'">\n        <option *ngFor="let o of node.question.options" [ngValue]="o.value">{{o.label}}\n        </option>\n      </select>\n\n      <app-file-upload *ngSwitchCase="\'file\'" [dataSource]="dataSource" [formControlName]="node.question.key" [id]="node.question.key + \'id\'"\n        (fileChanged)="upload($event)">\n      </app-file-upload>\n      <textarea [placeholder]="node.question.placeholder" [rows]="node.question.rows" class="form-control"\n        *ngSwitchCase="\'textarea\'" [formControlName]="node.question.key" [id]="node.question.key + \'id\'">\n      </textarea>\n      \x3c!--\n      <ng-select *ngSwitchCase="\'remote-select\'" [items]="items$ | async" bindLabel="label" bindValue="value" placeholder="{{node.question.placeholder}}"\n        [hideSelected]="true" [loading]="itemsLoading"  [typeahead]="itemsInput$" [formControlName]="node.question.key" [id]="node.question.key + \'id\'">\n      </ng-select>\n    --\x3e\n      <remote-select *ngSwitchCase="\'remote-select\'" [placeholder]="node.question.placeholder" tabindex="0"\n        [dataSource]="dataSource" [componentID]="node.question.key + \'id\'" [formControlName]="node.question.key" [id]="node.question.key + \'id\'"></remote-select>\n      \x3c!--  \n      <date-time-picker *ngSwitchCase="\'date\'" [showTime]="node.question.showTime" tabindex="0" [weeks]=\'node.question.extras.questionOptions.weeksList\'\n        (onDateChange)="onDateChanged(node)" [showWeeks]="node.question.showWeeksAdder" [formControlName]="node.question.key"\n        [id]="node.question.key + \'id\'"></date-time-picker>\n  --\x3e\n\n      <ngx-date-time-picker *ngSwitchCase="\'date\'" [showTime]="node.question.showTime" [id]="node.question.key + \'id\'"\n        [formControlName]="node.question.key" [weeks]=\'node.question.extras.questionOptions.weeksList\' (onDateChange)="onDateChanged(node)"\n        [showWeeks]="node.question.showWeeksAdder"></ngx-date-time-picker>\n      <ng-select *ngSwitchCase="\'multi-select\'" [style.height]="\'auto\'"  [style.overflow-x]="\'hidden\'" tabindex="0" [formControlName]="node.question.key" [id]="node.question.key + \'id\'"\n          [options]="node.question.options" [multiple]="true">\n      </ng-select>\n      <ng-select *ngSwitchCase="\'single-select\'" [style.height]=\'auto\'  tabindex="0" [formControlName]="node.question.key"\n        [id]="node.question.key + \'id\'" [options]="node.question.options" [multiple]="false">\n      </ng-select>\n      <input class="form-control" *ngSwitchCase="\'number\'" [formControlName]="node.question.key " [attr.placeholder]="node.question.placeholder "\n        [type]="\'number\'" [id]="node.question.key + \'id\' " [step]="\'any\'" [min]="node.question.extras.questionOptions.min"\n        [max]="node.question.extras.questionOptions.max">\n      <input class="form-control" *ngSwitchDefault [formControlName]="node.question.key " [attr.placeholder]="node.question.placeholder "\n        [type]="node.question.renderingType" [id]="node.question.key + \'id\' ">\n\n      <div *ngSwitchCase="\'radio\'">\n        <div *ngFor="let o of node.question.options">\n          <label class="form-control no-border">\n            <input type="radio" [formControlName]="node.question.key" [id]="node.question.key + \'id\'" [value]="o.value">\n            {{ o.label }}\n          </label>\n        </div>\n      </div>\n\n      <div *ngSwitchCase="\'checkbox\'">\n        <checkbox [id]="node.question.key + \'id\'" [formControlName]="node.question.key" [options]="node.question.options" [selected]="node.control.value"></checkbox>\n      </div>\n\n      <div *ngIf="node.question.enableHistoricalValue && node.question.historicalDisplay" style="margin-top: 2px;">\n        <div class="container-fluid">\n          <div class="row">\n            <div class="col-xs-9">\n              <span class="text-warning">Previous Value: </span>\n              <strong>{{node.question.historicalDisplay?.text}}</strong>\n              <span *ngIf="node.question.showHistoricalValueDate">\n                <span> | </span>\n                <strong class="text-primary">{{node.question.historicalDisplay?._date}} </strong>\n                <span class="text-primary" *ngIf="node.question.historicalDisplay && node.question.historicalDisplay._date "> ({{node.question.historicalDisplay._date | timeAgo}})</span>\n              </span>\n\n            </div>\n            <button type="button" [node]="node" [name]="\'historyValue\'" class="btn btn-primary btn-small col-xs-3">Use\n              Value\n            </button>\n          </div>\n        </div>\n      </div>\n      <appointments-overview [node]="node"></appointments-overview>\n      <div *ngIf="hasErrors() ">\n        <p *ngFor="let e of errors() ">\n          <span class="text-danger ">{{e}}</span>\n        </p>\n      </div>\n    </div>\n\n    <div class="question-info col-md-12 col-lg-12 col-sm-12" id="{{node.question.extras.id}}" *ngIf="node.question && node.question.extras.questionInfo  && node.question.extras.questionInfo !== \'\'  && node.question.extras.questionInfo !== \' \'">\n      {{node.question.extras.questionInfo}}\n    </div>\n\n  </div>\n</div>\n<div *ngIf="node.question.controlType === 1" [hidden]="node.control.hidden" [ngClass]="{disabled: node.control.disabled}">\n\n\n  \x3c!--ARRAY CONTROL--\x3e\n  <div [ngSwitch]="node.question.renderingType ">\n    <div class=\'well\' style="padding: 2px; " *ngSwitchCase=" \'repeating\' ">\n      <h4 style="margin: 2px; font-weight: bold;">{{node.question.label}}</h4>\n      <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:2px;" />\n      <div [ngSwitch]="node.question.extras.type">\n        <div *ngSwitchCase="\'testOrder\'">\n          <div *ngFor="let child of node.children; let i=index ">\n            <form-renderer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n            "\n              [parentGroup]="child.control "></form-renderer>\n            <div>{{child.orderNumber}}</div>\n            <button type="button " class=\'btn btn-sm btn-danger\' (click)="node.removeAt(i) ">Remove</button>\n            <br />\n            <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:1px;" />\n          </div>\n        </div>\n\n        <div *ngSwitchCase="\'obsGroup\'" style="margin-bottom:20px;">\n          <div *ngFor="let child of node.children; let i=index ">\n            <form-renderer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n            "\n              [parentGroup]="child.control "></form-renderer>\n            <button type="button " class=\'btn btn-sm btn-danger\' (click)="node.removeAt(i) ">Remove</button>\n            <br />\n            <hr style="margin-left:-2px; margin-right:-2px; margin-bottom:4px; margin-top:8px; border-width:1px;" />\n          </div>\n        </div>\n      </div>\n      <button type="button " class=\'btn btn-primary\' (click)="node.createChildNode() ">Add</button>\n    </div>\n  </div>\n\n</div>\n<div *ngIf="node.question.controlType === 2" [hidden]="node.control.hidden" [ngClass]="{disabled: node.control.disabled}">\n\n  \x3c!--GROUP--\x3e\n  <div [ngSwitch]="node.question.renderingType ">\n    <div *ngSwitchCase=" \'group\' ">\n      <form-renderer *ngFor="let question of node.question.questions " [parentComponent]="this" [node]="node.children[question.key]\n            "\n        [parentGroup]="node.control "></form-renderer>\n    </div>\n    <div *ngSwitchCase=" \'field-set\' " style="border: 1px solid #eeeeee; padding: 2px; margin: 2px;">\n      <form-renderer *ngFor="let question of node.question.questions " [parentComponent]="this" [node]="node.children[question.key]\n            "\n        [parentGroup]="node.control "></form-renderer>\n    </div>\n  </div>\n\n</div>\n',styles:["../../style/app.css",DEFAULT_STYLES]}),__param(3,core.Inject(common.DOCUMENT)),__metadata("design:paramtypes",[ValidationFactory,DataSources,FormErrorsService,Object])],e)}(),Form=function(){function e(e,t,o){this.schema=e,this.formFactory=t,this.questionFactory=o,this.valueProcessingInfo={},this.existingOrders={},this._showErrors=!1,this._dataSourcesContainer=new DataSources}return Object.defineProperty(e.prototype,"dataSourcesContainer",{get:function(){return this._dataSourcesContainer},enumerable:!0,configurable:!0}),e.prototype.searchNodeByPath=function(e,t,o){var n=this,r=e.children;for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];if(a instanceof GroupNode){if(t===a.path)return o.push(a),o;this.searchNodeByPath(a,t,o)}else if(a instanceof LeafNode){if(t===a.path)return o.push(a),o}else if(a instanceof ArrayNode){if(t===a.path)return o.push(a),o;a.children.forEach((function(e){n.searchNodeByPath(e,t,o)}))}}return o},e.prototype.searchNodeByQuestionId=function(e,t){var o=[];return t?this.searchNodeByQuestionType(this.rootNode,t,o):this.findNodesByQuestionId(this.rootNode,e,o),o},e.prototype.searchNodeByQuestionType=function(e,t,o){var n=this;if(e instanceof GroupNode){var r=e;for(var i in r.children)this.searchNodeByQuestionType(r.children[i],t,o)}e instanceof ArrayNode&&e.children.forEach((function(e){n.searchNodeByQuestionType(e,t,o)}));if(e instanceof LeafNode){var a=e.question;a.extras&&a.extras.type&&a.extras.type===t&&o.push(e)}},e.prototype.findNodesByQuestionId=function(e,t,o){var n=this;if(e.question.key===t&&o.push(e),e instanceof GroupNode){var r=e;for(var i in r.children)this.findNodesByQuestionId(r.children[i],t,o)}e instanceof ArrayNode&&e.children.forEach((function(e){n.findNodesByQuestionId(e,t,o)}))},Object.defineProperty(e.prototype,"valid",{get:function(){return this.rootNode.control.valid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showErrors",{get:function(){return this._showErrors},set:function(e){this._showErrors=e},enumerable:!0,configurable:!0}),e.prototype.markInvalidControls=function(e,t){var o=this,n=e.children;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];if(i instanceof GroupNode)this.markInvalidControls(i,t);else if(i instanceof LeafNode){var a=i.question;if(a.key&&a.key.length>0){var s=i.control;s.valid||s.disabled||(t&&t.push(i),s.markAsTouched())}}else if(i instanceof ArrayNode){var l=i;l&&l.children&&l.children.length>0&&lodash.forEach(l.children,(function(e){o.markInvalidControls(e,t)}))}}return t},e.prototype.updateHiddenDisabledStateForAllControls=function(){this._updateHiddenDisabledStateForAllControls(this.rootNode)},e.prototype.updateAlertsForAllControls=function(){this._updateAlertsForAllControls(this.rootNode)},e.prototype._updateAlertsForAllControls=function(e){var t=this;if(e.control&&e.control.updateAlert&&e.control.updateAlert(),e instanceof GroupNode){var o=e;for(var n in o.children)this._updateAlertsForAllControls(o.children[n])}e instanceof ArrayNode&&e.children.forEach((function(e){t._updateAlertsForAllControls(e)}))},e.prototype._updateHiddenDisabledStateForAllControls=function(e){var t=this;if(e.control&&(e.control.updateDisabledState&&e.control.updateDisabledState(),e.control.updateHiddenState&&e.control.updateHiddenState()),e instanceof GroupNode){var o=e;for(var n in o.children)this._updateHiddenDisabledStateForAllControls(o.children[n])}e instanceof ArrayNode&&e.children.forEach((function(e){t._updateHiddenDisabledStateForAllControls(e)}))},e}(),ErrorRendererComponent=function(){function e(e,t){this.validationFactory=e,this.formErrorsService=t}return e.prototype.ngOnInit=function(){},e.prototype.showErrors=function(){return!this.form.valid&&this.form.showErrors},Object.defineProperty(e.prototype,"errorNodes",{get:function(){return this.form.markInvalidControls(this.form.rootNode,[])},enumerable:!0,configurable:!0}),e.prototype.getControlError=function(e){var t=e.control.errors;return t?this.validationFactory.errors(t,e.question):[]},e.prototype.announceErrorField=function(e){var t=this,o=this.form.searchNodeByQuestionId(e.path.substring(0,e.path.indexOf(".")));lodash.forEach(o,(function(o){if("page"===o.question.renderingType){var n=t.getPageIndex(o);t.formErrorsService.announceErrorField(n+","+e.question.key)}}))},e.prototype.getPageIndex=function(e){return this.form.rootNode.question.questions.indexOf(e.question)},e.ctorParameters=function(){return[{type:ValidationFactory},{type:FormErrorsService}]},__decorate([core.Input(),__metadata("design:type",Form)],e.prototype,"form",void 0),e=__decorate([core.Component({selector:"error-renderer",template:'<div *ngIf="showErrors()" class="container">\n<ul class="list-group">\n  <li class="list-group-item list-group-item-warning" *ngFor="let errorNode of errorNodes" (click)=announceErrorField(errorNode)>\n    <div class="error" *ngIf="errorNode.control.valid == false">\n      <h4>{{errorNode.question.label}}</h4>\n      <span class="text-danger"> {{getControlError(errorNode)}}</span>\n    </div>\n  </li>\n</ul>\n</div>\n',styles:["ul{list-style:none}.list-group-item{padding:2px 15px;cursor:pointer}ul li:hover{background-color:#fff}h4{margin-top:7px;margin-bottom:7px}"]}),__metadata("design:paramtypes",[ValidationFactory,FormErrorsService])],e)}(),HistoricalFieldHelperService=function(){function e(){}return e.prototype.getDisplayTextFromOptions=function(e,t,o){var n="",r=e.historicalDataValue;if(lodash.isArray(r.value)){var i=0;lodash.each(r.value,(function(r){lodash.each(e.options,(function(e){e[t]===r&&(0===i?n+=e[o]:n=n+", "+e[o],i++)}))}))}else lodash.each(e.options,(function(e){e[t]===r.value&&(n=e[o])}));return n},e}(),HistoricalValueDirective=function(){function e(e){this.historicalFieldHelper=e,this._nodeChange=new core.EventEmitter}return e.prototype.setValue=function(e){"historyValue"===e.target.name&&(!this._node||this.compareString(this._node.question.renderingType,"page")&&this.compareString(this._node.question.renderingType,"section")||(this._node.control.setValue(this._node.question.historicalDataValue.value),this._node.question.historicalValue=this._node.question.historicalDataValue,e.stopPropagation(),this._nodeChange.emit(this._node)))},e.prototype.compareString=function(e,t){return e===t},Object.defineProperty(e.prototype,"node",{set:function(e){if(e&&(this._node=e,this._node.question.enableHistoricalValue&&!lodash.isUndefined(this._node.question.historicalDataValue))){var t={text:"",_date:""};"select"===this._node.question.renderingType||"multi-select"===this._node.question.renderingType||"single-select"===this._node.question.renderingType?(t.text=this.historicalFieldHelper.getDisplayTextFromOptions(this._node.question,"value","label"),t._date=this._node.question.historicalDataValue.valueDate,this._node.question.historicalDisplay=t):lodash.isUndefined(this._node.question.historicalDataValue)||(t.text=this._node.question.historicalDataValue.value,t._date=this._node.question.historicalDataValue.valueDate,this._node.question.historicalDisplay=t)}},enumerable:!0,configurable:!0}),e.ctorParameters=function(){return[{type:HistoricalFieldHelperService}]},__decorate([core.Input(),__metadata("design:type",NodeBase)],e.prototype,"_node",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"_nodeChange",void 0),__decorate([core.HostListener("click",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],e.prototype,"setValue",null),__decorate([core.Input(),__metadata("design:type",NodeBase),__metadata("design:paramtypes",[NodeBase])],e.prototype,"node",null),e=__decorate([core.Directive({selector:"[node]"}),__metadata("design:paramtypes",[HistoricalFieldHelperService])],e)}(),STYLE="\nng-select {\n  display: inline-block;\n  margin: 0;\n  position: relative;\n  vertical-align: middle;\n  width: 100%;\n}\nng-select * {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nng-select > div {\n  border: 1px solid #ddd;\n  box-sizing: border-box;\n  cursor: pointer;\n  user-select: none;\n  width: 100%;\n}\nng-select > div.disabled {\n  background-color: #eee;\n  color: #aaa;\n  cursor: default;\n  pointer-events: none;\n}\nng-select > div > div.single {\n  display: flex;\n  height: 30px;\n  width: 100%;\n}\nng-select > div > div.single > div.value,\nng-select > div > div.single > div.placeholder {\n  flex: 1;\n  line-height: 30px;\n  overflow: hidden;\n  padding: 0 10px;\n  white-space: nowrap;\n}\nng-select > div > div.single > div.placeholder {\n  color: #a9a9a9;\n}\nng-select > div > div.single > div.clear,\nng-select > div > div.single > div.toggle {\n  color: #aaa;\n  line-height: 30px;\n  text-align: center;\n  width: 30px;\n}\nng-select > div > div.single > div.clear:hover,\nng-select > div > div.single > div.toggle:hover {\n  background-color: #ececec;\n}\nng-select > div > div.single > div.clear {\n  font-size: 18px;\n}\nng-select > div > div.single > div.toggle {\n  font-size: 14px;\n}\nng-select > div > div.multiple {\n  display: flex;\n  flex-flow: row wrap;\n  height: 100%;\n  min-height: 30px;\n  padding: 0 10px;\n  width: 100%;\n}\nng-select > div > div.multiple > div.option {\n  background-color: #eee;\n  border: 1px solid #aaa;\n  border-radius: 4px;\n  color: #333;\n  cursor: default;\n  display: inline-block;\n  flex-shrink: 0;\n  font-size: 14px;\n  line-height: 22px;\n  margin: 3px 5px 3px 0;\n  padding: 0 4px;\n}\nng-select > div > div.multiple > div.option span.deselect-option {\n  color: #aaa;\n  cursor: pointer;\n  font-size: 14px;\n  height: 20px;\n  line-height: 20px;\n}\nng-select > div > div.multiple > div.option span.deselect-option:hover {\n  color: #555;\n}\nng-select > div > div.multiple input {\n  background-color: transparent;\n  border: none;\n  height: 30px;\n  line-height: 30px;\n  padding: 0;\n}\nng-select > div > div.multiple input:focus {\n  outline: none;\n}\n",STYLE$1="select-dropdown {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nselect-dropdown * {\n  box-sizing: border-box;\n  font-family: Sans-Serif;\n}\nselect-dropdown > div {\n  background-color: #fff;\n  border: 1px solid #ccc;\n  border-top: none;\n  box-sizing: border-box;\n  position: absolute;\n  z-index: 1;\n}\nselect-dropdown > div .filter {\n  padding: 3px;\n  width: 100%;\n}\nselect-dropdown > div .filter input {\n  border: 1px solid #eee;\n  box-sizing: border-box;\n  padding: 4px;\n  width: 100%;\n}\nselect-dropdown > div .options {\n  max-height: 200px;\n  overflow-y: auto;\n}\nselect-dropdown > div .options ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\nselect-dropdown > div .options ul li {\n  padding: 4px 8px;\n  cursor: pointer;\n  user-select: none;\n}\nselect-dropdown .selected {\n  background-color: #e0e0e0;\n}\nselect-dropdown .selected.highlighted {\n  background-color: #2196F3;\n  color: #fff;\n}\nselect-dropdown .highlighted {\n  background-color: #2196F3;\n  color: #fff;\n}\nselect-dropdown .disabled {\n  background-color: #fff;\n  color: #9e9e9e;\n  cursor: default;\n  pointer-events: none;\n}",Option=function(){function e(e,t){this.value=e,this.label=t,this.disabled=!1,this.highlighted=!1,this.selected=!1,this.shown=!0}return e.prototype.show=function(){this.shown=!0},e.prototype.hide=function(){this.shown=!1},e.prototype.disable=function(){this.disabled=!0},e.prototype.enable=function(){this.disabled=!1},e.prototype.undecoratedCopy=function(){return{label:this.label,value:this.value}},e}(),Diacritics=function(){function e(){}return e.strip=function(e){var t=this;return e?e.replace(/[^\u0000-\u007E]/g,(function(e){return t.DIACRITICS[e]||e})):""},e.DIACRITICS={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""},e}(),OptionList=function(){function e(e){this._highlightedOption=null,null==e&&(e=[]),this._options=e.map((function(e){var t=new Option(e.value,e.label);return e.disabled&&t.disable(),t})),this.highlight()}return e.equalValues=function(e,t){if(e.length!==t.length)return!1;var o=e.slice().sort(),n=t.slice().sort();return o.every((function(e,t){return e===n[t]}))},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.getOptionsByValue=function(e){return this.options.filter((function(t){return t.value===e}))},Object.defineProperty(e.prototype,"value",{get:function(){return this.selection.map((function(e){return e.value}))},set:function(e){e=null==e?[]:e,this.options.forEach((function(t){t.selected=e.indexOf(t.value)>-1}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.options.filter((function(e){return e.selected}))},enumerable:!0,configurable:!0}),e.prototype.select=function(e,t){t||this.clearSelection(),e.selected=!0},e.prototype.deselect=function(e){e.selected=!1},e.prototype.clearSelection=function(){this.options.forEach((function(e){e.selected=!1}))},Object.defineProperty(e.prototype,"filtered",{get:function(){return this.options.filter((function(e){return e.shown}))},enumerable:!0,configurable:!0}),e.prototype.filter=function(e){""===e.trim()?this.resetFilter():this.options.forEach((function(t){var o=Diacritics.strip(t.label).toUpperCase(),n=Diacritics.strip(e).toUpperCase();t.shown=o.indexOf(n)>-1})),this.highlight()},e.prototype.resetFilter=function(){this.options.forEach((function(e){e.shown=!0}))},Object.defineProperty(e.prototype,"highlightedOption",{get:function(){return this._highlightedOption},enumerable:!0,configurable:!0}),e.prototype.highlight=function(){var e=this.hasShownSelected()?this.getFirstShownSelected():this.getFirstShown();this.highlightOption(e)},e.prototype.highlightOption=function(e){this.clearHighlightedOption(),null!==e&&(e.highlighted=!0,this._highlightedOption=e)},e.prototype.highlightNextOption=function(){var e=this.filtered,t=this.getHighlightedIndexFromList(e);t>-1&&t<e.length-1&&this.highlightOption(e[t+1])},e.prototype.highlightPreviousOption=function(){var e=this.filtered,t=this.getHighlightedIndexFromList(e);t>0&&this.highlightOption(e[t-1])},e.prototype.clearHighlightedOption=function(){null!==this.highlightedOption&&(this.highlightedOption.highlighted=!1,this._highlightedOption=null)},e.prototype.getHighlightedIndexFromList=function(e){for(var t=0;t<e.length;t++)if(e[t].highlighted)return t;return-1},e.prototype.getHighlightedIndex=function(){return this.getHighlightedIndexFromList(this.filtered)},e.prototype.hasShown=function(){return this.options.some((function(e){return e.shown}))},e.prototype.hasSelected=function(){return this.options.some((function(e){return e.selected}))},e.prototype.hasShownSelected=function(){return this.options.some((function(e){return e.shown&&e.selected}))},e.prototype.getFirstShown=function(){var e,t;try{for(var o=__values(this.options),n=o.next();!n.done;n=o.next()){var r=n.value;if(r.shown)return r}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return null},e.prototype.getFirstShownSelected=function(){var e,t;try{for(var o=__values(this.options),n=o.next();!n.done;n=o.next()){var r=n.value;if(r.shown&&r.selected)return r}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return null},e}(),SelectDropdownComponent=function(){function e(){this.close=new core.EventEmitter,this.optionClicked=new core.EventEmitter,this.singleFilterClick=new core.EventEmitter,this.singleFilterInput=new core.EventEmitter,this.singleFilterKeydown=new core.EventEmitter,this.disabledColor="#fff",this.disabledTextColor="9e9e9e"}return e.prototype.ngOnInit=function(){this.optionsReset()},e.prototype.ngOnChanges=function(e){e.hasOwnProperty("optionList")&&this.optionsReset()},e.prototype.ngAfterViewInit=function(){this.moveHighlightedIntoView(),!this.multiple&&this.filterEnabled&&this.filterInput.nativeElement.focus()},e.prototype.onSingleFilterClick=function(e){this.singleFilterClick.emit(null)},e.prototype.onSingleFilterInput=function(e){this.singleFilterInput.emit(e.target.value)},e.prototype.onSingleFilterKeydown=function(e){this.singleFilterKeydown.emit(e)},e.prototype.onOptionsWheel=function(e){this.handleOptionsWheel(e)},e.prototype.onOptionMouseover=function(e){this.optionList.highlightOption(e)},e.prototype.onOptionClick=function(e){this.optionClicked.emit(e)},e.prototype.optionsReset=function(){this.optionList.resetFilter(),this.optionList.highlight()},e.prototype.getOptionStyle=function(e){return e.highlighted?{"background-color":this.highlightColor,color:this.highlightTextColor}:{}},e.prototype.clearFilterInput=function(){this.filterEnabled&&(this.filterInput.nativeElement.value="")},e.prototype.moveHighlightedIntoView=function(){var e=this.optionsList.nativeElement,t=e.offsetHeight,o=this.optionList.getHighlightedIndex();if(o>-1){var n=e.children[0].children[o].offsetHeight,r=o*n,i=r+n,a=e.scrollTop;i>a+t?e.scrollTop=i-t:r<a&&(e.scrollTop=r)}},e.prototype.handleOptionsWheel=function(e){var t=this.optionsList.nativeElement,o=0===t.scrollTop,n=t.offsetHeight+t.scrollTop===t.scrollHeight;o&&e.deltaY<0?e.preventDefault():n&&e.deltaY>0&&e.preventDefault()},__decorate([core.Input(),__metadata("design:type",Boolean)],e.prototype,"filterEnabled",void 0),__decorate([core.Input(),__metadata("design:type",String)],e.prototype,"highlightColor",void 0),__decorate([core.Input(),__metadata("design:type",String)],e.prototype,"highlightTextColor",void 0),__decorate([core.Input(),__metadata("design:type",Number)],e.prototype,"left",void 0),__decorate([core.Input(),__metadata("design:type",Boolean)],e.prototype,"multiple",void 0),__decorate([core.Input(),__metadata("design:type",String)],e.prototype,"notFoundMsg",void 0),__decorate([core.Input(),__metadata("design:type",OptionList)],e.prototype,"optionList",void 0),__decorate([core.Input(),__metadata("design:type",Number)],e.prototype,"top",void 0),__decorate([core.Input(),__metadata("design:type",Number)],e.prototype,"width",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"close",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"optionClicked",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"singleFilterClick",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"singleFilterInput",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"singleFilterKeydown",void 0),__decorate([core.ViewChild("filterInput",{static:!1}),__metadata("design:type",Object)],e.prototype,"filterInput",void 0),__decorate([core.ViewChild("optionsList",{static:!1}),__metadata("design:type",Object)],e.prototype,"optionsList",void 0),e=__decorate([core.Component({selector:"select-dropdown",template:'<div\n    [ngStyle]="{\'top.px\': top, \'left.px\': left, \'width.px\': width}">\n\n    <div class="filter"\n        *ngIf="!multiple">\n        <input\n            *ngIf="filterEnabled"\n            #filterInput\n            (click)="onSingleFilterClick($event)"\n            (input)="onSingleFilterInput($event)"\n            (keydown)="onSingleFilterKeydown($event)">\n    </div>\n\n    <div class="options"\n        #optionsList>\n        <ul\n            (wheel)="onOptionsWheel($event)">\n            <li *ngFor="let option of optionList.filtered"\n                [ngClass]="{\'highlighted\': option.highlighted, \'selected\': option.selected, \'disabled\': option.disabled}"\n                [ngStyle]="getOptionStyle(option)"\n                (click)="onOptionClick(option)"\n                (mouseover)="onOptionMouseover(option)">\n                {{option.label}}\n            </li>\n            <li\n                *ngIf="!optionList.hasShown()"\n                class="message">\n                {{notFoundMsg}}\n            </li>\n        </ul>\n    </div>\n</div>\n',encapsulation:core.ViewEncapsulation.None,styles:[STYLE$1]})],e)}(),SELECT_VALUE_ACCESSOR={provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return SelectComponent})),multi:!0},SelectComponent=function(){function e(){this.KEYS={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,SPACE:32,UP:38,DOWN:40},this.allowClear=!1,this.disabled=!1,this.highlightColor="#2196f3",this.highlightTextColor="#fff",this.multiple=!1,this.noFilter=0,this.notFoundMsg="No results found",this.placeholder="",this.opened=new core.EventEmitter,this.closed=new core.EventEmitter,this.selected=new core.EventEmitter,this.deselected=new core.EventEmitter,this.typed=new core.EventEmitter,this._value=[],this.hasSelected=!1,this.filterEnabled=!0,this.filterInputWidth=1,this.hasFocus=!1,this.isBelow=!0,this.isDisabled=!1,this.isOpen=!1,this.placeholderView="",this.clearClicked=!1,this.selectContainerClicked=!1,this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){this.placeholderView=this.placeholder},e.prototype.ngAfterViewInit=function(){this.updateFilterWidth()},e.prototype.ngOnChanges=function(e){if(e.hasOwnProperty("options")&&this.updateOptionsList(e.options.isFirstChange()),e.hasOwnProperty("noFilter")){var t=this.optionList.options.length,o=e.noFilter.currentValue;this.filterEnabled=t>=o}},e.prototype.onWindowClick=function(){this.selectContainerClicked||this.closeDropdown(),this.clearClicked=!1,this.selectContainerClicked=!1},e.prototype.onWindowResize=function(){this.updateWidth()},e.prototype.onSelectContainerClick=function(e){this.selectContainerClicked=!0,this.clearClicked||this.toggleDropdown()},e.prototype.onSelectContainerFocus=function(){this.onTouched()},e.prototype.onSelectContainerKeydown=function(e){this.handleSelectContainerKeydown(e)},e.prototype.onDropdownOptionClicked=function(e){this.multiple?this.toggleSelectOption(e):this.selectOption(e)},e.prototype.onDropdownClose=function(e){this.closeDropdown(e)},e.prototype.onSingleFilterClick=function(){this.selectContainerClicked=!0},e.prototype.onSingleFilterInput=function(e){var t=this;setTimeout((function(){e.length>2&&t.typed.emit(e)}),500),this.optionList.filter(e)},e.prototype.onSingleFilterKeydown=function(e){this.handleSingleFilterKeydown(e)},e.prototype.onMultipleFilterInput=function(e){var t=this;this.isOpen||this.openDropdown(),this.updateFilterWidth(),setTimeout((function(){t.optionList.filter(e.target.value)}))},e.prototype.onMultipleFilterKeydown=function(e){this.handleMultipleFilterKeydown(e)},e.prototype.onClearSelectionClick=function(e){this.clearClicked=!0,this.clearSelection(),this.closeDropdown(!0)},e.prototype.onDeselectOptionClick=function(e){this.clearClicked=!0,this.deselectOption(e)},e.prototype.open=function(){this.openDropdown()},e.prototype.close=function(){this.closeDropdown()},e.prototype.clear=function(){this.clearSelection()},e.prototype.select=function(e){var t=this;this.optionList.getOptionsByValue(e).forEach((function(e){t.selectOption(e)})),this.valueChanged()},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this.disabled=e},Object.defineProperty(e.prototype,"value",{get:function(){return 0===this._value.length?"":this.multiple?this._value:this._value[0]},set:function(e){if(null==e||""===e)e=[];else if("string"==typeof e)e=[e];else if(!Array.isArray(e))throw new TypeError("Value must be a string or an array.");OptionList.equalValues(e,this._value)||(this.optionList.value=e,this.valueChanged())},enumerable:!0,configurable:!0}),e.prototype.valueChanged=function(){this._value=this.optionList.value,this.hasSelected=this._value.length>0,this.placeholderView=this.hasSelected?"":this.placeholder,this.updateFilterWidth(),this.onChange(this.value)},e.prototype.updateOptionsList=function(e){var t;e||(t=this.optionList.value),this.optionList=new OptionList(this.options),e||(this.optionList.value=t,this.valueChanged())},e.prototype.toggleDropdown=function(){this.isDisabled||(this.isOpen?this.closeDropdown(!0):this.openDropdown())},e.prototype.openDropdown=function(){this.isOpen||(this.updateWidth(),this.updatePosition(),this.isOpen=!0,this.multiple&&this.filterEnabled&&this.filterInput.nativeElement.focus(),this.opened.emit(null))},e.prototype.closeDropdown=function(e){void 0===e&&(e=!1),this.isOpen&&(this.clearFilterInput(),this.isOpen=!1,e&&this.focus(),this.closed.emit(null))},e.prototype.selectOption=function(e){e.selected||(this.optionList.select(e,this.multiple),this.valueChanged(),this.selected.emit(e.undecoratedCopy()))},e.prototype.deselectOption=function(e){var t=this;e.selected&&(this.optionList.deselect(e),this.valueChanged(),this.deselected.emit(e.undecoratedCopy()),setTimeout((function(){t.multiple&&(t.updatePosition(),t.optionList.highlight(),t.isOpen&&t.dropdown.moveHighlightedIntoView())})))},e.prototype.clearSelection=function(){var e=this.optionList.selection;e.length>0&&(this.optionList.clearSelection(),this.valueChanged(),1===e.length?this.deselected.emit(e[0].undecoratedCopy()):this.deselected.emit(e.map((function(e){return e.undecoratedCopy()}))))},e.prototype.toggleSelectOption=function(e){e.selected?this.deselectOption(e):this.selectOption(e)},e.prototype.selectHighlightedOption=function(){var e=this.optionList.highlightedOption;null!==e&&(this.selectOption(e),this.closeDropdown(!0))},e.prototype.deselectLast=function(){var e=this.optionList.selection;if(e.length>0){var t=e[e.length-1];this.deselectOption(t),this.setMultipleFilterInput(t.label+" ")}},e.prototype.clearFilterInput=function(){this.multiple&&this.filterEnabled?this.filterInput.nativeElement.value="":this.dropdown.clearFilterInput()},e.prototype.setMultipleFilterInput=function(e){this.filterEnabled&&(this.filterInput.nativeElement.value=e)},e.prototype.handleSelectContainerKeydown=function(e){var t=this,o=e.which;this.isOpen?o===this.KEYS.ESC||o===this.KEYS.UP&&e.altKey?this.closeDropdown(!0):o===this.KEYS.TAB?this.closeDropdown():o===this.KEYS.ENTER?this.selectHighlightedOption():o===this.KEYS.UP?(this.optionList.highlightPreviousOption(),this.dropdown.moveHighlightedIntoView(),this.filterEnabled||e.preventDefault()):o===this.KEYS.DOWN&&(this.optionList.highlightNextOption(),this.dropdown.moveHighlightedIntoView(),this.filterEnabled||e.preventDefault()):(o===this.KEYS.ENTER||o===this.KEYS.SPACE||o===this.KEYS.DOWN&&e.altKey)&&setTimeout((function(){t.openDropdown()}))},e.prototype.handleMultipleFilterKeydown=function(e){e.which===this.KEYS.BACKSPACE&&this.hasSelected&&this.filterEnabled&&""===this.filterInput.nativeElement.value&&this.deselectLast()},e.prototype.handleSingleFilterKeydown=function(e){var t=e.which;t!==this.KEYS.ESC&&t!==this.KEYS.TAB&&t!==this.KEYS.UP&&t!==this.KEYS.DOWN&&t!==this.KEYS.ENTER||this.handleSelectContainerKeydown(e)},e.prototype.focus=function(){this.hasFocus=!0,this.multiple&&this.filterEnabled?this.filterInput.nativeElement.focus():this.selectionSpan.nativeElement.focus()},e.prototype.blur=function(){this.hasFocus=!1,this.selectionSpan.nativeElement.blur()},e.prototype.updateWidth=function(){this.width=this.selectionSpan.nativeElement.offsetWidth},e.prototype.updatePosition=function(){var e=this.selectionSpan.nativeElement;this.left=e.offsetLeft,this.top=e.offsetTop+e.offsetHeight},e.prototype.updateFilterWidth=function(){if(void 0!==this.filterInput){var e=this.filterInput.nativeElement.value;this.filterInputWidth=0===e.length?1+10*this.placeholderView.length:1+10*e.length}},__decorate([core.Input(),__metadata("design:type",Array)],e.prototype,"options",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"allowClear",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"disabled",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"highlightColor",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"highlightTextColor",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"multiple",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"noFilter",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"notFoundMsg",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"placeholder",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"opened",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"closed",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"selected",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"deselected",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"typed",void 0),__decorate([core.ViewChild("selection",{static:!1}),__metadata("design:type",Object)],e.prototype,"selectionSpan",void 0),__decorate([core.ViewChild("dropdown",{static:!1}),__metadata("design:type",SelectDropdownComponent)],e.prototype,"dropdown",void 0),__decorate([core.ViewChild("filterInput",{static:!1}),__metadata("design:type",Object)],e.prototype,"filterInput",void 0),e=__decorate([core.Component({selector:"ng-select",template:'<div\n    #selection\n    [attr.tabindex]="disabled ? null : 0"\n    [ngClass]="{\'open\': isOpen, \'focus\': hasFocus, \'below\': isBelow, \'disabled\': disabled}"\n    (click)="onSelectContainerClick($event)"\n    (focus)="onSelectContainerFocus()"\n    (keydown)="onSelectContainerKeydown($event)"\n    (window:click)="onWindowClick()"\n    (window:resize)="onWindowResize()">\n\n    <div class="single"\n        *ngIf="!multiple">\n        <div class="value"\n            *ngIf="optionList.hasSelected()">\n            {{optionList.selection[0].label}}\n        </div>\n        <div class="placeholder"\n            *ngIf="!optionList.hasSelected()">\n            {{placeholderView}}\n        </div>\n        <div class="clear"\n            *ngIf="allowClear"\n            (click)="onClearSelectionClick($event)">\n            &#x2715;\n        </div>\n        <div class="toggle"\n            *ngIf="isOpen">\n            &#x25B2;\n        </div>\n        <div class="toggle"\n            *ngIf="!isOpen">\n            &#x25BC;\n        </div>\n    </div>\n\n    <div class="multiple"\n        *ngIf="multiple">\n        <div class="option"\n            *ngFor="let option of optionList.selection">\n            <span class="deselect-option"\n                (click)=onDeselectOptionClick(option)>\n                &#x2715;\n            </span>\n            {{option.label}}\n        </div>\n        <input\n            *ngIf="filterEnabled"\n            filterInput\n            tabindex="-1"\n            [placeholder]="placeholderView"\n            [ngStyle]="{\'width.px\': filterInputWidth}"\n            (input)="onMultipleFilterInput($event)"\n            (keydown)="onMultipleFilterKeydown($event)"/>\n    </div>\n\n</div>\n<select-dropdown\n    *ngIf="isOpen"\n    #dropdown\n    [multiple]="multiple"\n    [optionList]="optionList"\n    [notFoundMsg]="notFoundMsg"\n    [highlightColor]="highlightColor"\n    [highlightTextColor]="highlightTextColor"\n    [filterEnabled]="filterEnabled"\n    [width]="width"\n    [top]="top"\n    [left]="left"\n    (close)="onDropdownClose($event)"\n    (optionClicked)="onDropdownOptionClicked($event)"\n    (singleFilterClick)="onSingleFilterClick()"\n    (singleFilterInput)="onSingleFilterInput($event)"\n    (singleFilterKeydown)="onSingleFilterKeydown($event)">\n</select-dropdown>\n',providers:[SELECT_VALUE_ACCESSOR],encapsulation:core.ViewEncapsulation.None,styles:[STYLE]})],e)}(),SelectModule=function(){function e(){}return e=__decorate([core.NgModule({declarations:[SelectComponent,SelectDropdownComponent],exports:[SelectComponent],imports:[common.CommonModule,forms.FormsModule]})],e)}(),SecurePipe=function(){function e(e,t){this._ref=e,this.sanitizer=t,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._result=new rxjs.BehaviorSubject(null),this.result=this._result.asObservable(),this._internalSubscription=null}return e.prototype.ngOnDestroy=function(){this._subscription&&this._dispose()},e.prototype.transform=function(e,t){this.getfile=t;var o=this.internalTransform(e);return this.asyncTrasnform(o)},e.prototype.internalTransform=function(e){var t=this;return e?(this.previousUrl!==e&&(this.previousUrl=e,this._internalSubscription=this.getfile(e).subscribe((function(e){var o=t.sanitizer.bypassSecurityTrustUrl(e);t._result.next(o)}))),this.result):this.result},e.prototype.asyncTrasnform=function(e){return this._obj?e!==this._obj?(this._dispose(),this.asyncTrasnform(e)):this._latestValue===this._latestReturnedValue?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,core.WrappedValue.wrap(this._latestValue)):(e&&this._subscribe(e),this._latestReturnedValue=this._latestValue,this._latestValue)},e.prototype._subscribe=function(e){var t=this;this._obj=e,this._subscription=e.subscribe({next:function(o){return t._updateLatestValue(e,o)},error:function(e){throw e}})},e.prototype._dispose=function(){this._subscription&&this._subscription.unsubscribe(),this._internalSubscription&&this._internalSubscription.unsubscribe(),this._internalSubscription=null,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null},e.prototype._updateLatestValue=function(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())},e.ctorParameters=function(){return[{type:core.ChangeDetectorRef},{type:platformBrowser.DomSanitizer}]},e=__decorate([core.Pipe({name:"secure",pure:!1}),__metadata("design:paramtypes",[core.ChangeDetectorRef,platformBrowser.DomSanitizer])],e)}(),SharedModule=function(){function e(){}return e=__decorate([core.NgModule({declarations:[SecurePipe],imports:[common.CommonModule],exports:[SecurePipe],providers:[DataSources]})],e)}(),FileUploadComponent=function(){function e(e){this.renderer=e,this.uploading=!1,this.fileUuid=null,this.pdfUploaded=!1,this.formEntryMode=!0,this.propagateChange=function(e){}}var t;return t=e,Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.fileUuid&&this.checkFileType()},e.prototype.onFileChange=function(e){var t,o;try{for(var n=__values(e),r=n.next();!r.done;r=n.next()){var i=r.value;this.upload(i)}}catch(e){t={error:e}}finally{try{r&&!r.done&&(o=n.return)&&o.call(n)}finally{if(t)throw t.error}}},e.prototype.upload=function(e){var t=this;this.dataSource&&(this.uploading=!0,this.dataSource.fileUpload(e).subscribe((function(e){t.fileUuid=e.image,t.checkFileType(),t.propagateChange(t.fileUuid),t.uploading=!1}),(function(e){t.uploading=!1})))},e.prototype.writeValue=function(e){e!==this.fileUuid&&(this.fileUuid=e,this.checkFileType())},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.onChange=function(e){this.propagateChange(e.id)},e.prototype.clearValue=function(){this.fileUuid=null,this.pdfUploaded=!1,this.pdfUrl=null,this.propagateChange(this.fileUuid)},e.prototype.getPdfUrl=function(e){var t=this;this.dataSource.fetchFile(e,"pdf").subscribe((function(e){t.pdfUploaded=!0,t.pdfUrl=e.changingThisBreaksApplicationSecurity}))},e.prototype.checkFileType=function(){-1!==this.fileUuid.search(/pdf/gi)&&this.getPdfUrl(this.fileUuid)},e.ctorParameters=function(){return[{type:core.Renderer2}]},__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"dataSource",null),e=t=__decorate([core.Component({selector:"app-file-upload",template:'<lib-file-uploader [srcUrl]="pdfUrl" [formEntry]="formEntryMode" [(ngModel)]="fileUuid" (_onClear)="clearValue()" (uploadData)="onFileChange($event)">\n</lib-file-uploader>\n<div *ngIf="fileUuid">\n    <img *ngIf="!pdfUploaded" class="img-responsive" [src]="fileUuid | secure:this.dataSource.fetchFile" alt="" />\n</div>',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}],styles:["img {\n        margin-left: auto;margin-right: auto;display: block;\n    }"]}),__metadata("design:paramtypes",[core.Renderer2])],e)}(),RemoteFileUploadModule=function(){function e(){}return e=__decorate([core.NgModule({imports:[common.CommonModule,SelectModule,forms.FormsModule,SharedModule,ngxWebcam.WebcamModule,ngxFileUploader.NgxFileUploaderModule],exports:[FileUploadComponent],declarations:[FileUploadComponent],providers:[]})],e)}(),moment$1=moment_,DatePickerComponent=function(){function e(){this.locale="en",this.viewFormat="ll",this.returnObject="js",this.onDatePickerCancel=new core.EventEmitter,this.onSelectDate=new core.EventEmitter,this.onDisplayMonths=!1,this.onDisplayYears=!1,this.displayYearsIndex=0,this.monthsShort=moment$1.monthsShort()}return e.prototype.ngOnInit=function(){var e=this;this.initValue(),lodash.each(this.fullYearRange,(function(t,o){e.currentYear=e.calendarDate.clone().startOf("year").year(),-1!==t.indexOf(e.currentYear)&&(e.displayYearsIndex=o)})),this.displayYearRange=this.fullYearRange[this.displayYearsIndex],this.generateCalendar()},e.prototype.prev=function(){this.onDisplayYears?(this.displayYearsIndex--,this.displayYearsIndex<0&&(this.displayYearsIndex=0),this.displayYearRange=this.fullYearRange[this.displayYearsIndex]):this.calendarDate=this.calendarDate.clone().subtract(1,"M"),this.generateCalendar()},e.prototype.showMonthSelection=function(){this.onDisplayMonths=!0,this.onDisplayYears=!1},e.prototype.showYearSelection=function(){this.onDisplayYears=!0,this.onDisplayMonths=!1},e.prototype.next=function(){this.onDisplayYears?(this.displayYearsIndex++,this.displayYearsIndex>=this.fullYearRange.length&&(this.displayYearsIndex=this.fullYearRange.length-1),this.displayYearRange=this.fullYearRange[this.displayYearsIndex++]):this.calendarDate=this.calendarDate.clone().add(1,"M"),this.generateCalendar()},e.prototype.selectDay=function(e){var t=e.diff(this.calendarDate.clone().startOf("date"),"days");e=this.calendarDate.clone().add(t,"d");var o=this.parseToReturnObjectType(e);this.onSelectDate.emit(o),this.cancelDatePicker()},e.prototype.selectMonth=function(e){this.calendarDate=this.calendarDate.clone().month(e),this.onDisplayMonths=!1,this.generateCalendar()},e.prototype.selectYear=function(e){this.calendarDate=this.calendarDate.clone().year(e),this.onDisplayYears=!1,this.generateCalendar()},e.prototype.selectToday=function(){var e=this.parseToReturnObjectType(moment$1());this.onSelectDate.emit(e),this.cancelDatePicker()},e.prototype.clearPickDate=function(){this.onSelectDate.emit(null),this.cancelDatePicker()},e.prototype.cancelDatePicker=function(){this.onDatePickerCancel.emit(!1)},e.prototype.generateYears=function(){for(var e=moment$1().year(),t=[],o=this.calendarDate.clone().subtract(100,"y").year();o<=e;o++)t.push(o);this.fullYearRange=lodash.chunk(t,14)},e.prototype.initValue=function(){moment$1.locale(this.locale),this.today=moment$1().startOf("date"),this.currentMonth=this.monthsShort[moment$1().month()],this.currentYear=moment$1().year(),this.dayNames=moment$1.weekdaysShort(!0),this.initDate?(this.calendarDate="string"===this.returnObject?moment$1(this.initDate,this.viewFormat):moment$1(this.initDate),this.selectedDate=this.calendarDate.clone().startOf("date")):this.calendarDate=moment$1(),this.generateYears()},e.prototype.generateCalendar=function(){this.calendarDays=[];for(var e=0-(this.calendarDate.clone().startOf("month").day()+(7-moment$1.localeData().firstDayOfWeek()))%7,t=41+e,o=e;o<=t;o+=1){var n=this.calendarDate.clone().startOf("month").add(o,"days");this.calendarDays.push(n)}},e.prototype.parseToReturnObjectType=function(e){switch(this.returnObject){case"js":return e.toDate();case"string":return e.format(this.viewFormat);case"moment":return e;case"json":return e.toJSON();case"array":return e.toArray();case"iso":return e.toISOString();case"object":return e.toObject();default:return e}},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"initDate",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"locale",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"viewFormat",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"returnObject",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onDatePickerCancel",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onSelectDate",void 0),e=__decorate([core.Component({selector:"date-picker",template:'<picker-modal (onOverlayClick)="cancelDatePicker()">\n  <div class="picker-wrap">\n    <div class="picker-box">\n      <div class="picker-header">\n        <div class="picker-header-nav">\n          <span class="nav-prev" (click)="prev()"></span>\n        </div>\n        <div class="picker-header-content">\n          <div class="content">\n            <span (click)="showMonthSelection()" class="month">{{calendarDate | moment: "MMMM"}}</span>\n            <span class="seperator">|</span>\n            <span (click)="showYearSelection()" class="year">{{calendarDate | moment: "YYYY"}}</span>\n          </div>\n        </div>\n        <div class="picker-header-nav">\n          <span class="nav-next" (click)="next()"></span>\n        </div>\n      </div>\n      <div class="picker-calendar">\n        <div class="picker-calendar-row" *ngIf="!onDisplayMonths && !onDisplayYears">\n          <span class="picker-weekday" *ngFor="let day of dayNames">{{ day }}</span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="!onDisplayMonths && !onDisplayYears">\n                    <span class="picker-day" (click)="selectDay(day)" [ngClass]="{\n                       \'out-focus\': day.month() != calendarDate.month(),\n                       \'today\': day.isSame(today),\n                       \'selected\': day.isSame(selectedDate)\n                      }" *ngFor="let day of calendarDays">\n                    {{ day | moment: \'D\'}}\n                </span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="onDisplayMonths">\n                    <span class="picker-month" *ngFor="let month of monthsShort"\n                          (click)="selectMonth(month)"\n                          [ngClass]="{\n                       \'selected\': month === currentMonth\n                      }">\n                    {{ month }}\n                </span>\n        </div>\n        <div class="picker-calendar-row" *ngIf="onDisplayYears">\n                    <span class="picker-year" *ngFor="let year of displayYearRange"\n                          (click)="selectYear(year)"\n                          [ngClass]="{\n                       \'selected\': year === currentYear\n                      }">\n                    {{ year }}\n                </span>\n        </div>\n      </div>\n      <div class="picker-footer">\n        <div class="picker-action action-today" (click)="selectToday()"><span class="text">Today</span></div>\n        <div class="picker-action action-clear" (click)="clearPickDate()"><span class="text">Clear</span></div>\n        <div class="picker-action action-close" (click)="cancelDatePicker()"><span class="text">Close</span></div>\n      </div>\n    </div>\n  </div>\n</picker-modal>\n',styles:['*,::after,::before{box-sizing:border-box}.picker-wrap{width:95vw;max-width:666px}.picker-box{font-family:\'Open Sans\';min-width:400px!important;padding:.625rem 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-footer,.picker-header{font-size:1.333rem;line-height:2.5rem;display:-webkit-box;display:flex;height:2.5rem;width:100%}.picker-header-nav{position:relative;cursor:pointer;width:calc(100% / 8)}.picker-header-nav>*{position:absolute;top:50%;right:auto;bottom:auto;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.picker-header-nav .nav-next::before,.picker-header-nav .nav-prev::before{content:" ";border-top:.5em solid transparent;border-bottom:.5em solid transparent;border-right:.75em solid #000;width:0;height:0;display:block;margin:0 auto}.picker-header-nav .nav-next::before{border-right:0;border-left:.75em solid #000}.picker-header-content{width:calc(100% * 6 / 8);text-align:center}.picker-header-content .month{font-size:1.778rem;line-height:2.5rem;margin-right:.5rem;font-weight:700}.picker-header-content .year{font-style:italic;color:#999}.picker-calendar{width:100%}.picker-calendar .picker-calendar-row{display:-webkit-box;display:flex;flex-wrap:wrap;width:100%;margin-bottom:.625rem}.picker-calendar .picker-weekday{font-weight:700;text-align:left;color:#999;width:calc(100% / 7)}.picker-calendar .picker-day,.picker-calendar .picker-month,.picker-calendar .picker-year{font-size:1.333rem;line-height:2.5rem;position:relative;height:2.5rem;text-align:center;cursor:pointer;width:calc(100% / 7)}.picker-calendar .picker-day:hover,.picker-calendar .picker-month:hover,.picker-calendar .picker-year:hover{background:#b1dcfb}.picker-calendar .out-focus{color:#ddd}.picker-calendar .out-focus:hover{color:#000}.picker-calendar .selected{background:#0089ec;color:#fff}.picker-calendar .selected:hover{background:#0089ec}.picker-calendar .today::before{content:" ";position:absolute;top:2px;right:2px;width:0;height:0;border-top:.5em solid #0059bc;border-left:.5em solid transparent}.picker-footer{cursor:pointer}.picker-footer .picker-action{text-align:center;width:calc(100% / 3)}.picker-footer .picker-action:hover{background-color:#b1dcfb}.picker-footer .picker-action .text{padding-left:.8rem}.picker-footer .action-clear::before,.picker-footer .action-close::before,.picker-footer .action-today::before{content:" ";position:relative;display:inline-block;height:0;width:0}.picker-footer .action-today::before{border-top:.66em solid #0059bc;border-left:.66em solid transparent}.picker-footer .action-clear::before{top:-.5rem;width:1rem;border-top:3px solid #e20}.picker-footer .action-close::before{width:1rem;height:1rem;background:-webkit-gradient(linear,left top,left bottom,color-stop(35%,transparent),color-stop(35%,#777),color-stop(65%,#777),color-stop(65%,transparent)),-webkit-gradient(linear,left top,right top,color-stop(35%,transparent),color-stop(35%,#777),color-stop(65%,#777),color-stop(65%,transparent));background:linear-gradient(to bottom,transparent 35%,#777 35%,#777 65%,transparent 65%),linear-gradient(to right,transparent 35%,#777 35%,#777 65%,transparent 65%);-webkit-transform:rotate(45deg);transform:rotate(45deg)}']}),__metadata("design:paramtypes",[])],e)}(),moment$2=moment_,TimePickerComponent=function(){function e(){this.showSecond=!0,this.viewFormat="hh:mm A",this.use12Hour=!1,this.returnObject="js",this.onSelectTime=new core.EventEmitter,this.onTimePickerCancel=new core.EventEmitter,this.hourFormat="HH"}return e.prototype.ngOnInit=function(){this.use12Hour&&(this.hourFormat="hh"),this.time=this.initTime?moment$2(this.initTime,this.viewFormat):moment$2(),this.initTime?this.time="string"===this.returnObject?moment$2(this.initTime,this.viewFormat):moment$2(this.initTime):this.time=moment$2()},e.prototype.increaseHour=function(){this.time=this.time.clone().add(1,"h")},e.prototype.decreaseHour=function(){this.time=this.time.clone().subtract(1,"h")},e.prototype.increaseMinute=function(){this.time=this.time.clone().add(1,"m")},e.prototype.decreaseMinute=function(){this.time=this.time.clone().subtract(1,"m")},e.prototype.increaseSecond=function(){this.time=this.time.clone().add(1,"s")},e.prototype.decreaseSecond=function(){this.time=this.time.clone().subtract(1,"s")},e.prototype.selectTime=function(){var e=this.parseToReturnObjectType(this.time);this.onSelectTime.emit(e),this.cancelTimePicker()},e.prototype.selectNow=function(){var e=this.parseToReturnObjectType(moment$2());this.onSelectTime.emit(e),this.cancelTimePicker()},e.prototype.clearTime=function(){this.onSelectTime.emit(null),this.cancelTimePicker()},e.prototype.cancelTimePicker=function(){this.onTimePickerCancel.emit(!1)},e.prototype.parseToReturnObjectType=function(e){switch(this.returnObject){case"js":return e.toDate();case"string":return e.format(this.viewFormat);case"moment":return e;case"json":return e.toJSON();case"array":return e.toArray();case"iso":return e.toISOString();case"object":return e.toObject();default:return e}},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"initTime",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showSecond",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"viewFormat",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"use12Hour",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"returnObject",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onSelectTime",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onTimePickerCancel",void 0),e=__decorate([core.Component({selector:"time-picker",template:'<picker-modal (onOverlayClick)="cancelTimePicker()">\n    <div class="picker-wrap">\n        <div class="picker-box">\n            <div class="picker-header">Time Picker</div>\n            <div class="picker-table">\n                <ul class="picker-table-time">\n                    <li class="picker-table-number hour">\n                        <span class="arrow up" (click)="increaseHour()"></span>\n                        {{time | moment: hourFormat}}\n                        <span class="arrow down" (click)="decreaseHour()"></span>\n                    </li>\n                    <li class="picker-table-separator">:</li>\n                    <li class="picker-table-number minute">\n                        <span class="arrow up" (click)="increaseMinute()"></span>\n                        {{time | moment: \'mm\'}}\n                        <span class="arrow down" (click)="decreaseMinute()"></span>\n                    </li>\n                    <li *ngIf="showSecond" class="picker-table-separator">:</li>\n                    <li *ngIf="showSecond" class="picker-table-number second">\n                        <span class="arrow up" (click)="increaseSecond()"></span>\n                        {{time | moment: \'ss\'}}\n                        <span class="arrow down" (click)="decreaseSecond()"></span>\n                    </li>\n                    <li *ngIf="use12Hour" class="picker-table-meridiem meridiem">\n                        {{time | moment: \'A\'}}\n                    </li>\n                </ul>\n            </div>\n            <div class="picker-footer">\n                <div class="picker-action action-now" (click)="selectNow()"><span class="text">Now</span></div>\n                <div class="picker-action action-confirm" (click)="selectTime()"><span class="text">Confirm</span></div>\n                <div class="picker-action action-clear" (click)="clearTime()"><span class="text">Clear</span></div>\n                <div class="picker-action action-close" (click)="cancelTimePicker()"><span class="text">Close</span></div>\n            </div>\n        </div>\n    </div>\n</picker-modal>\n',styles:["*,::after,::before{box-sizing:border-box}.picker-wrap{width:95vw;max-width:40rem;font-family:'Open Sans'}.picker-box{width:100%;padding:.625rem 1rem;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-footer,.picker-header{font-size:1.333rem;line-height:2.5rem;height:2.5rem;width:100%}.picker-header{text-align:center}.picker-table{width:100%;margin:2.5rem 0}.picker-table-time{font-size:2.37rem;line-height:2.5rem;list-style:none;margin:0;padding:0;display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;width:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.picker-table-meridiem,.picker-table-number,.picker-table-separator{text-align:center}.picker-table-meridiem,.picker-table-number{position:relative;width:20%}.arrow{position:absolute;left:50%;border:solid #777;border-width:0 .2rem .2rem 0;display:inline-block;padding:.25rem;cursor:pointer}.arrow.up{top:-1rem;-webkit-transform:translateX(-50%) rotate(-135deg);transform:translateX(-50%) rotate(-135deg)}.arrow.down{bottom:-1rem;-webkit-transform:translateX(-50%) rotate(45deg);transform:translateX(-50%) rotate(45deg)}.arrow:hover{border-color:#1975d2}.picker-table-separator{width:calc(20% / 3)}.picker-footer{display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;width:100%;cursor:pointer}.picker-footer .picker-action{width:25%;text-align:center}.picker-footer .picker-action:hover{background-color:#b1dcfb}.picker-footer .picker-action .text{padding-left:.8rem}.picker-footer .action-clear::before,.picker-footer .action-close::before,.picker-footer .action-confirm::before,.picker-footer .action-now::before{content:\" \";position:relative;display:inline-block;height:0;width:0}.picker-footer .action-now::before{border-top:.66em solid #0059bc;border-left:.66em solid transparent}.picker-footer .action-confirm::before{width:1rem;height:1rem;border-radius:100%;background-color:#00b5ad}.picker-footer .action-clear::before{top:-.5rem;width:1rem;border-top:3px solid #e20}.picker-footer .action-close::before{width:1rem;height:1rem;background:-webkit-gradient(linear,left top,left bottom,color-stop(35%,transparent),color-stop(35%,#777),color-stop(65%,#777),color-stop(65%,transparent)),-webkit-gradient(linear,left top,right top,color-stop(35%,transparent),color-stop(35%,#777),color-stop(65%,#777),color-stop(65%,transparent));background:linear-gradient(to bottom,transparent 35%,#777 35%,#777 65%,transparent 65%),linear-gradient(to right,transparent 35%,#777 35%,#777 65%,transparent 65%);-webkit-transform:rotate(45deg);transform:rotate(45deg)}"]}),__metadata("design:paramtypes",[])],e)}(),ModalComponent=function(){function e(){this.onOverlayClick=new core.EventEmitter}return e.prototype.ngOnInit=function(){},e.prototype.closeModal=function(){this.onOverlayClick.emit(!1)},__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onOverlayClick",void 0),e=__decorate([core.Component({selector:"picker-modal",template:'<section class="x-modal">\n    <section class="modal-overlay" (click)="closeModal()"></section>\n    <section class="modal-main" id="section-modal-main">\n        <ng-content></ng-content>\n    </section>\n</section>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,animations:[],styles:[":host{z-index:9999999999}*,::after,::before{box-sizing:border-box}.modal-main{position:absolute;left:19.6%;right:auto;top:auto;z-index:111;background-color:#fff;border:1px solid #d7dad7;border-radius:6px;-webkit-transform:translate(-50%,0);transform:translate(-50%,0);box-shadow:0 5px 15px rgba(0,0,0,.3)}"]}),__metadata("design:paramtypes",[])],e)}(),MomentPipe=function(){function e(){}return e.prototype.transform=function(e,t){return t?e.format(t):e.format("MMM DD, YYYY")},e=__decorate([core.Pipe({name:"moment"})],e)}(),Moment=moment_,DateTimePickerComponent=function(){function e(){this.showDate=!0,this.showTime=!1,this.showWeeks=!1,this.weeks=[2,4,6,8,12,16,24],this.onDateChange=new core.EventEmitter,this.showDatePicker=!1,this.showTimePicker=!1,this.onChange=function(){},this.onTouched=function(){}}var t;return t=e,e.prototype.ngOnInit=function(){},e.prototype.weeksSelected=function(e){var t=new Date,o=t.setDate(t.getDate()+7*e);this.value=Moment(o).format()},e.prototype.setDate=function(e){this.value=e&&""!==e?Moment(e).format():e},e.prototype.setTime=function(e){this.value=e&&""!==e?Moment(e).format():e},e.prototype.toggleDatePicker=function(e){this.showDatePicker=e},e.prototype.toggleTimePicker=function(e){this.showTimePicker=e},Object.defineProperty(e.prototype,"value",{get:function(){return this.modelValue},set:function(e){this.modelValue=e,this.onDateChange.emit(e),this.onChange(e),this.onTouched()},enumerable:!0,configurable:!0}),e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.writeValue=function(e){e instanceof Date?this.value=Moment(e).format():this.value=e},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"modelValue",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showDate",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showTime",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showWeeks",void 0),__decorate([core.Input(),__metadata("design:type",Array)],e.prototype,"weeks",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onDateChange",void 0),e=t=__decorate([core.Component({selector:"date-time-picker",template:'<div class=\'row\'>\n    <div *ngIf="!showTime" class=\'col-xs-12 col-md-12\'>\n        <input *ngIf="!showWeeks" type="text" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n            readonly placeholder="Select Date" />\n        <div *ngIf="showWeeks" class="input-group">\n            <input type="text" class="form-control" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n                readonly placeholder="Select Date">\n            <div class="input-group-btn">\n                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Weeks <span class="caret"></span></button>\n                <ul class="dropdown-menu up">\n                    <li (click)="weeksSelected(count)" *ngFor="let count of weeks"><span> {{count}} Weeks</span></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div *ngIf="showTime" class=\'col-xs-8 col-md-8\'>\n        <input *ngIf="!showWeeks" type="text" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n            readonly placeholder="Select Date" />\n        <div *ngIf="showWeeks" class="input-group">\n            <input type="text" class="form-control" class="form-control" [value]="value | date: \'mediumDate\'" (focus)="toggleDatePicker(true)"\n                readonly placeholder="Select Date">\n            <div class="input-group-btn">\n                <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Weeks <span class="caret"></span></button>\n                <ul class="dropdown-menu up">\n                    <li (click)="weeksSelected(count)" *ngFor="let count of weeks"><span> {{count}} Weeks</span></li>\n                </ul>\n            </div>\n        </div>\n    </div>\n    <div *ngIf="showTime" class=\'col-xs-4 col-md-4\'>\n        <input type="text" class="form-control" [value]="value | date: \'shortTime\'" (focus)="toggleTimePicker(true)" readonly placeholder="Select Time"\n        />\n    </div>\n</div>\n<date-picker *ngIf="showDatePicker" [initDate]="value" (onSelectDate)="setDate($event)" (onDatePickerCancel)="toggleDatePicker($event)"></date-picker>\n\n<time-picker *ngIf="showTimePicker" [initTime]="value" [use12Hour]="true" (onSelectTime)="setTime($event)" (onTimePickerCancel)="toggleTimePicker($event)"></time-picker>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}],styles:["input[readonly]{background-color:#fff}.up{bottom:100%!important;top:auto!important}.glyphicon{top:1px}"]}),__metadata("design:paramtypes",[])],e)}(),DateTimePickerModule=function(){function e(){}return e=__decorate([core.NgModule({imports:[common.CommonModule,forms.FormsModule],declarations:[DatePickerComponent,TimePickerComponent,ModalComponent,MomentPipe,DateTimePickerComponent],exports:[DatePickerComponent,TimePickerComponent,ModalComponent,MomentPipe,DateTimePickerComponent],providers:[]})],e)}(),moment$3=moment_,MY_FORMATS={parse:{dateInput:"LL"},display:{dateInput:"LL",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},NgxDateTimePickerComponent=function(){function e(){this.selectedTime=moment$3().format(),this.selectedDate=moment$3().format(),this.loadInitial=!1,this.showTimePicker=!1,this.weeks=[0,2,4,6,8,12,16,24],this.showTime=!1,this.showWeeks=!0,this.onDateChange=new core.EventEmitter,this.onChange=function(){},this.onTouched=function(){}}var t;return t=e,e.prototype.ngOnInit=function(){},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){},e.prototype.onTimeSelect=function(e){var t=moment$3(this.selectedDate),o=e;this.setDateTime(t,o)},e.prototype.onDateSelect=function(e){var t=moment$3(e.value),o=this.selectedTime,n=this.setDateTime(t,o);e.value;this.value=n},e.prototype.toggleTimePicker=function(e){this.showTimePicker=e},e.prototype.setCurrentTime=function(){var e=moment$3(this.selectedDate),t=moment$3().format("HH:mm:ss");this.setDateTime(e,t)},e.prototype.weekSelect=function(e){var t=moment$3().format(),o=moment$3(t).add(e.value,"weeks"),n=t;this.setDateTime(o,n)},e.prototype.selectionChange=function(e){console.log("Week selected",e)},e.prototype.getWeekPickerCssClass=function(){return this.showTime?"col-sm-2 form-group":"col-sm-3 form-group"},e.prototype.getDatePickerCssClass=function(){return this.showTime&&this.showWeeks?"col-sm-5 form-group":!0===this.showWeeks?"col-sm-9 form-group":!0===this.showTime?"col-sm-8 form-group":"col-sm-12 form-group"},e.prototype.getTimePickerCssClass=function(){return this.showTime&&this.showWeeks?"col-sm-5 form-group":!0===this.showWeeks?"col-sm-9 form-group":"col-sm-4 form-group"},e.prototype.setDateTime=function(e,t){var o,n=moment$3(e).format("DD-MM-YYYY");o=this.showTime?moment$3(t).format("HH:mm:ss"):"00:00:00";var r=moment$3(n+""+o,"DD-MM-YYYY HH:mm:ss"),i=moment$3(r).format();return this.selectedDate=i,this.selectedTime=i,this.value=i,this.onChange(this.value),i},__decorate([core.Input(),__metadata("design:type",Array)],e.prototype,"weeks",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"modelValue",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showTime",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"showWeeks",void 0),__decorate([core.Output(),__metadata("design:type",Object)],e.prototype,"onDateChange",void 0),e=t=__decorate([core.Component({selector:"ngx-date-time-picker",template:'<div>\n  <div class="row">\n    <div [class]="getDatePickerCssClass()">\n      <div class="input-group">\n        <input matInput \n              [matDatepicker]="picker" \n              class="form-control" \n              [value]="value" \n              placeholder="Choose a date" \n              (dateChange)="onDateSelect($event)"\n              (click)="picker.open()"\n              readonly\n        >\n        <mat-datepicker #picker disabled="false"></mat-datepicker>\n        <mat-datepicker-toggle matSuffix [for]="picker" class="input-group-btn"></mat-datepicker-toggle>\n      </div>\n    </div>\n    <div [class]="getWeekPickerCssClass()" *ngIf="showWeeks">\n      <mat-select placeholder="Select Weeks"  class="form-control" name="weeks" (selectionChange) ="weekSelect($event)">\n        <mat-option *ngFor="let count of weeks" [value]="count">\n          {{count}} Weeks\n        </mat-option>\n      </mat-select>\n    </div>\n    <div [class]="getTimePickerCssClass()" *ngIf="showTime">\n          <input type="text" class="form-control" [value]="value | date: \'shortTime\'" (focus)="toggleTimePicker(true)" readonly placeholder="Select Time"\n          />\n          <time-picker *ngIf="showTimePicker" [initTime]="value" [use12Hour]="true" (onSelectTime)="onTimeSelect($event)" (onTimePickerCancel)="toggleTimePicker($event)"></time-picker>\n    </div>\n  </div>\n</div>\n\n',providers:[{provide:core$1.MAT_DATE_FORMATS,useValue:MY_FORMATS},{provide:core$1.DateAdapter,useClass:materialMomentAdapter.MomentDateAdapter},{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}],styles:["#time-section{display:inline-block}#ngx-atp-time-picker,#ngx-mat-form-field{width:100%}.up{bottom:100%!important;top:auto!important}.time-btn{margin-top:-20px}"]})],e)}(),NgxDateTimePickerModule=function(){function e(){}return e=__decorate([core.NgModule({imports:[common.CommonModule,forms.FormsModule,forms.ReactiveFormsModule,datepicker.MatDatepickerModule,formField.MatFormFieldModule,material.MatNativeDateModule,material.MatInputModule,DateTimePickerModule,select.MatSelectModule],declarations:[NgxDateTimePickerComponent],exports:[datepicker.MatDatepickerModule,formField.MatFormFieldModule,material.MatNativeDateModule,material.MatInputModule,NgxDateTimePickerComponent],providers:[]})],e)}(),Option$1=function(e){this.label=e.label,this.value=e.value},AfeNgSelectComponent=function(){function e(){this.question_options=[],this.errors=[],this.propagateChange=function(e){}}var t;return t=e,e.prototype.getChangingText=function(e){var t=this;this.getData(e).subscribe((function(e){t.question_options=e}))},e.prototype.writeValue=function(e){},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(e){},e.prototype.ngOnChanges=function(e){},e.prototype.ngOnInit=function(){var e=this;this.extras&&this.extras.originalValue&&this.resolveSelectedOption(this.extras.originalValue).subscribe((function(t){e.selected_question_option=t}))},e.prototype.getData=function(e){var t=this;return this.subject=new rxjs.BehaviorSubject([]),this.dataSource.searchOptions(e).subscribe((function(e){for(var o=new Array,n=0;n<e.length;n++)o.push(new Option$1(e[n]));t.subject.next(o)}),(function(e){t.subject.error(e)})),this.subject.asObservable()},e.prototype.onValueChange=function(e){},e.prototype.resolveSelectedOption=function(e){var t=this;return this.subjectOption=new rxjs.BehaviorSubject(null),this.dataSource.resolveSelectedValue(e).subscribe((function(e){t.subjectOption.next(e)}),(function(e){t.subjectOption.error(e)})),this.subjectOption.asObservable()},e.prototype.resetOptions=function(){this.subject.next(new Array)},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"dataSource",void 0),__decorate([core.Input(),__metadata("design:type",Boolean)],e.prototype,"multiple",void 0),__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"extras",void 0),e=t=__decorate([core.Component({selector:"afe-ng-select",template:'<ng-select\n                   (searchInputText)="getChangingText($event)"\n                    (ngModelChange)="onValueChange($event)"\n                    [options]="question_options"\n                    [multiple]="multiple" >\n            </ng-select>\n  ',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}]})],e)}(),FormSchemaCompiler=function(){function e(){}return e.prototype.compileFormSchema=function(e,t){var o=this.getReferencedForms(e,t);if(lodash.isEmpty(o))return e;var n=this.getAllPlaceholderObjects(e);return lodash.isEmpty(n)?e:(this.replaceAllPlaceholdersWithActualObjects(o,n),e)},e.prototype.findSchemaByName=function(e,t){if(!lodash.isEmpty(e)&&!lodash.isEmpty(t)){var o={};return lodash.each(e,(function(e){e.name===t&&(o=e)})),o}},e.prototype.getPageInSchemaByLabel=function(e,t){if(!lodash.isEmpty(e)&&!lodash.isEmpty(t)){var o={};return lodash.each(e.pages,(function(e){e.label===t&&(o=e)})),o}},e.prototype.getSectionInSchemaByPageLabelBySectionLabel=function(e,t,o){if(!(lodash.isEmpty(e)||lodash.isEmpty(t)||lodash.isEmpty(o))){var n=this.getPageInSchemaByLabel(e,t);if(!lodash.isEmpty(n)){var r={};return lodash.each(n.sections,(function(e){e.label===o&&(r=e)})),r}}},e.prototype.getQuestionByIdInSchema=function(e,t){if(!lodash.isEmpty(e)&&!lodash.isEmpty(t)){if(Array.isArray(e)){for(var o=void 0,n=0;n<e.length&&(lodash.isEmpty(e[n])||(o=this.getQuestionByIdInSchema(e[n],t)),lodash.isEmpty(o));n++);return o}if("object"!=typeof e);else{if(this.isQuestionObjectWithId(e,t))return e;if(this.isSchemaSubObjectExpandable(e)){var r=e.pages||e.sections||e.questions;return this.getQuestionByIdInSchema(r,t)}}}},e.prototype.getQuestionsArrayByQuestionIdInSchema=function(e,t){if(!lodash.isEmpty(e)&&!lodash.isEmpty(t))return this.getQuestionsArrayByQuestionId(e,e,t)},e.prototype.getQuestionsArrayByQuestionId=function(e,t,o){if(Array.isArray(t)){for(var n=void 0,r=0;r<t.length&&(lodash.isEmpty(t[r])||(n=this.getQuestionsArrayByQuestionId(t,t[r],o)),lodash.isEmpty(n));r++);return n}if("object"!=typeof t);else{if(this.isQuestionObjectWithId(t,o))return e;if(this.isSchemaSubObjectExpandable(t)){var i=t.pages||t.sections||t.questions;return this.getQuestionsArrayByQuestionId(i,i,o)}}},e.prototype.isSchemaSubObjectExpandable=function(e){if("object"==typeof e){var t=Object.keys(e);if(lodash.includes(t,"pages")||lodash.includes(t,"sections")||lodash.includes(t,"questions"))return!0}return!1},e.prototype.isQuestionObjectWithId=function(e,t){return e.id===t},e.prototype.getAllPlaceholderObjects=function(e){var t=[];return this.extractPlaceholderObjects(e,t),t},e.prototype.extractPlaceholderObjects=function(e,t){if(!lodash.isEmpty(e))if(Array.isArray(e))for(var o=0;o<e.length;o++)lodash.isEmpty(e[o])||this.extractPlaceholderObjects(e[o],t);else if("object"==typeof e)if(lodash.isEmpty(e.reference)){if(this.isSchemaSubObjectExpandable(e)){var n=e.pages||e.sections||e.questions;this.extractPlaceholderObjects(n,t)}}else t.push(e)},e.prototype.fillPlaceholderObject=function(e,t){for(var o in t)lodash.isEmpty(e[o])&&(e[o]=t[o]);return e},e.prototype.replaceAllPlaceholdersWithActualObjects=function(e,t){var o=this;return lodash.each(t,(function(t){var n=o.getReferencedObject(t.reference,e);lodash.isEmpty(n)?console.error("Form compile: Error finding referenced object",t.reference):(t=o.fillPlaceholderObject(t,n),delete(t=o.removeExcludedQuestionsFromPlaceholder(t)).reference)})),t},e.prototype.removeObjectFromArray=function(e,t){var o=e.indexOf(t);-1!==o&&e.splice(o,1)},e.prototype.removeExcludedQuestionsFromPlaceholder=function(e){var t=this;return Array.isArray(e.reference.excludeQuestions)&&lodash.each(e.reference.excludeQuestions,(function(o){var n=t.getQuestionsArrayByQuestionIdInSchema(e,o);if(Array.isArray(n)){var r=t.getQuestionByIdInSchema(n,o);t.removeObjectFromArray(n,r)}})),e},e.prototype.getReferencedObject=function(e,t){if(lodash.isEmpty(e.form))console.error("Form compile: reference missing form attribute",e);else{if(!lodash.isEmpty(t[e.form]))return lodash.isEmpty(e.questionId)?lodash.isEmpty(e.page)||lodash.isEmpty(e.section)?lodash.isEmpty(e.page)?void console.error("Form compile: Unsupported reference type",e.reference):this.getPageInSchemaByLabel(t[e.form],e.page):this.getSectionInSchemaByPageLabelBySectionLabel(t[e.form],e.page,e.section):this.getQuestionByIdInSchema(t[e.form],e.questionId);console.error("Form compile: referenced form alias not found",e)}},e.prototype.getReferencedForms=function(e,t){var o=this,n=e.referencedForms;if(!lodash.isEmpty(n)){var r={};return lodash.each(n,(function(e){r[e.alias]=o.findSchemaByName(t,e.formName)})),r}},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),TextInputQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.placeholder=t.placeholder||"",o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),TextAreaInputQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.placeholder=t.placeholder||"",o.isExpanded=t.isExpanded||!1,o.rows=t.rows||18,o.renderingType="textarea",o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(TextInputQuestion),SelectQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="select",o.options=t.options||[],o.controlType=exports.AfeControlType.AfeFormControl,o.dataSource=t.dataSource||"",o}return __extends(t,e),t}(QuestionBase),UiSelectQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="ui-select",o.options=t.options||[],o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),DateQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.showTime=!0,o.showWeeksAdder=!1,o.renderingType="date",o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),MultiSelectQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="multi-select",o.options=t.options||[],o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(SelectQuestion),NestedQuestion=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(QuestionBase),QuestionGroup=function(e){function t(t){var o=e.call(this,t)||this;return o.isExpanded=!0,o.renderingType="group",o.questions=t.questions||[],o.controlType=exports.AfeControlType.AfeFormGroup,o}return __extends(t,e),t}(NestedQuestion),RepeatingQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="repeating",o.questions=t.questions||[],o.controlType=exports.AfeControlType.AfeFormArray,o}return __extends(t,e),t}(NestedQuestion),CheckBoxQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="checkbox",o.options=t.options||[],o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),FileUploadQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.showTime=!0,o.showWeeksAdder=!1,o.renderingType="file",o.dataSource=t.dataSource,o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),TestOrderQuestion=function(e){function t(t){var o=e.call(this,t)||this;return o.renderingType="select",o.orderType=t.orderType,o.selectableOrders=t.selectableOrders,o.options=t.options,o.orderSettingUuid=t.orderSettingUuid,o.rendering=t.orderSettingUuid,o.controlType=exports.AfeControlType.AfeFormControl,o}return __extends(t,e),t}(QuestionBase),DateValidationModel=function(e){function t(t){var o=e.call(this,t)||this;return o.allowFutureDates=!1,o.allowFutureDates="true"===t.allowFutureDates,o}return __extends(t,e),t}(ValidationModel),MaxValidationModel=function(e){function t(t){var o=e.call(this,t)||this,n=t.max;return o.max=+n,o}return __extends(t,e),t}(ValidationModel),MinValidationModel=function(e){function t(t){var o=e.call(this,t)||this,n=t.min;return o.min=+n,o}return __extends(t,e),t}(ValidationModel),DummyDataSource=function(){function e(){this.returnErrorOnNext=!1}return e.prototype.resolveSelectedValue=function(e){var t=this.sampleData();t=(t=t.map((function(e){return new Option$1({label:e.label,value:e.concept})}))).filter((function(t){return t.value===e}));var o=new rxjs.BehaviorSubject([]);return this.returnErrorOnNext?o.error(new Error("Error loading Options")):o.next(t[0]),o.asObservable()},e.prototype.fileUpload=function(e){return rxjs.of({image:""})},e.prototype.fetchFile=function(e){return rxjs.of({image:""})},e.prototype.searchOptions=function(e){var t=this.sampleData();t=(t=t.map((function(e){return new Option$1({label:e.label,value:e.concept})}))).filter((function(t){return-1!==t.label.indexOf(e)}));var o=new rxjs.BehaviorSubject([]);return this.returnErrorOnNext?o.error(new Error("Error loading Options")):o.next(t),o.asObservable()},e.prototype.sampleData=function(){return[{concept:"a899e0ac-1350-11df-a1f1-0026b9348838",label:"None"},{concept:"a8ad1276-1350-11df-a1f1-0026b9348838",label:"Breathlessness"},{concept:"a892e4b4-1350-11df-a1f1-0026b9348838",label:"Chest pain"},{concept:"a8afc8b8-1350-11df-a1f1-0026b9348838",label:"Cough = 2 weeks"},{concept:"d7adae14-c386-49cc-8f7c-765d8ceec566",label:"Fever for = 2 weeks"},{concept:"3f57aafc-7162-41da-a51b-6a804cb6f5e8",label:"New exposure to household contact with TB"},{concept:"a89807f0-1350-11df-a1f1-0026b9348838",label:"Noticeable Weight loss"},{concept:"e1862fef-68ed-4df4-90dd-a00152f719aa",label:"Night sweats = 2 weeks"},{concept:"a8ad462e-1350-11df-a1f1-0026b9348838",label:"Abdomen"},{concept:"f218c60e-4b54-475a-a4fa-facab9216da8",label:"Groin"},{concept:"a8a774b0-1350-11df-a1f1-0026b9348838",label:"Joints"},{concept:"4639388c-ee31-4dcf-abb4-ad71253493bb",label:"Neck Kw"}]},e}(),moment$4=moment_,HistoricalEncounterDataService=function(){function e(){this.dataSources={}}return e.prototype.registerEncounters=function(e,t){var o=this,n={data:[],getValue:function(e,t){void 0===t&&(t=0);var r=e.split(".");return r.length>0?o.getFirstValue(r,n.data[t]):n.data[t][e]},getAllObjects:function(){return n.data},getSingleObject:function(e){return void 0===e&&(e=0),n.data[e]}};if(lodash.isArray(t)){var r=[];lodash.each(t,(function(e){r.push(o._transformEncounter(e))})),n.data=lodash.sortBy(r,"encounterDatetime").reverse()}else n.data.push(this._transformEncounter(t));this.putObject(e,n)},e.prototype.putObject=function(e,t){this.dataSources[e]=t},e.prototype.getObject=function(e){return this.dataSources[e]||null},e.prototype.getFirstValue=function(e,t){var o=[];if(this.getAllValues(e,t,o),o.length>0)return{value:o[0],valueDate:moment$4(t.encounterDatetime).format("ll")}},e.prototype.getAllValues=function(e,t,o){var n=this;if(!lodash.isNil(t))if(e.length<=1)lodash.isNil(t[e[0]])||o.push(t[e[0]]);else{var r=e.splice(1),i=e[0];lodash.isArray(t[i])&&t[i].length>0?lodash.each(t[i],(function(e){n.getAllValues(r.slice(0),e,o)})):this.getAllValues(r.slice(0),t[i],o)}},e.prototype._transformEncounter=function(e){if(!lodash.isNil(e)){var t={encounterDatetime:e.encounterDatetime};if(e.location&&e.location.uuid&&(t.location=e.location.uuid),e.patient&&e.patient.uuid&&(t.patient=e.patient.uuid),e.form&&e.form.uuid&&(t.form=e.form.uuid),e.encounterType&&e.encounterType.uuid&&(t.encounterType=e.encounterType.uuid),e.provider){var o=e.provider;t.provider=o.uuid}if(e.obs){var n=this._transformObs(e.obs);lodash.extend(t,n)}return t}},e.prototype._transformObs=function(e){var t=this;if(!e)return null;var o={};if(lodash.isArray(e))return lodash.each(e,(function(e){t._augumentObs(o,t._transformObs(e))})),o;if(e.groupMembers){var n={};return lodash.each(e.groupMembers,(function(e){t._augumentObs(n,t._transformObs(e))})),o[e.concept.uuid]&&lodash.isArray(o[e.concept.uuid])?o[e.concept.uuid].push(n):o[e.concept.uuid]=[n],o}return e.value instanceof Object?o[e.concept.uuid]=e.value.uuid:o[e.concept.uuid]=e.value,o},e.prototype._augumentObs=function(e,t){for(var o in t)if(lodash.has(e,o)){if(!lodash.isArray(e[o])){var n=e[o];e[o]=[n]}lodash.isArray(t[o])?Array.prototype.push.apply(e[o],t[o]):e[o].push(t[o])}else e[o]=t[o];return e},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),HistoricalHelperService=function(){function e(){}return e.prototype.evaluate=function(e,t,o){var n=new HistoricalEncounterDataService;n.registerEncounters("prevEnc",t.rawPrevEnc);var r={HD:n};if(o)for(var i in o)o[i]&&(r[i]=o[i]);var a=new JsExpressionHelper,s=new AfeFormControl;return(new ExpressionRunner).getRunnable(e,s,a.helperFunctions,r).run()},e.prototype.evaluatePrecondition=function(e,t,o){var n={histValue:o};return this.evaluate(e,t,n)},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),moment$5=moment_,QuestionFactory=function(){function e(){this.dataSources={},this.historicalHelperService=new HistoricalHelperService}return e.prototype.createQuestionModel=function(e,t){if(t){var o=t.dataSourcesContainer.dataSources;this.dataSources=o}return this.toFormQuestionModel(e)},e.prototype.toSelectQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.options=e.questionOptions.answers.map((function(e){return{label:e.label,value:e.concept}})),t.options.splice(0,0,{label:"",value:""}),t.renderingType=e.questionOptions.rendering,t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toNumericQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="number",t.placeholder=e.questionOptions.placeholder,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toNumberQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="number",t.placeholder=e.questionOptions.placeholder||"",t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),t.validators=this.addValidators(e),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toDateQuestion=function(e){if("encounterDatetime"===e.type)return this.toEncounterDatetimeQuestion(e);var t=new DateQuestion({type:"",key:""});t.renderingType="date",t.validators=this.addValidators(e),t.extras=e,t.showTime=e.questionOptions.showTime,t.showWeeksAdder=!!e.questionOptions.weeksList;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toEncounterDatetimeQuestion=function(e){var t=new DateQuestion({type:"",key:""});t.label=e.label,t.renderingType="date",t.key=e.id,t.validators=this.addValidators(e),t.extras=e,t.showWeeksAdder=!!e.questionOptions.weeksList;return t.showTime=!0,this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toCheckBoxQuestion=function(e){var t=new CheckBoxQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.extras=e,t.options=e.questionOptions.answers.map((function(e){return{label:e.label,value:e.concept}})),t.options.splice(0,0),t.renderingType=e.questionOptions.rendering;return this.copyProperties({label:"label",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toMultiCheckboxQuestion=function(e){var t=new MultiSelectQuestion({renderType:"",options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.options=e.questionOptions.answers.map((function(e){return{label:e.label,value:e.concept}})),t.validators=this.addValidators(e),t.dataSource=new DummyDataSource,t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTextAreaQuestion=function(e){var t=new TextAreaInputQuestion({isExpanded:!1,rows:18,placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.placeholder=e.questionOptions.placeholder,t.isExpanded=e.isExpanded,t.rows=e.questionOptions.rows,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTextQuestion=function(e){var t=new TextInputQuestion({placeholder:"",type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="text",t.placeholder=e.questionOptions.placeholder,t.validators=this.addValidators(e),t.extras=e,t.placeholder=e.questionOptions.placeholder||"";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toFileUploadQuestion=function(e){var t=new FileUploadQuestion({type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="file",t.dataSource="file",t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toDrugQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="drug";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toProblemQuestion=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="problem";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toConceptAnswerSelect=function(e){var t=new SelectQuestion({options:[],type:"",key:""});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource=e.questionOptions.dataSource||"conceptAnswers",t.dataSourceOptions={concept:e.questionOptions.concept};return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toRepeatingQuestion=function(e){var t=new RepeatingQuestion({questions:[],type:"",key:""});if(t.label=e.label,t.questions=this.getChildrenQuestionModels(e.questions),t.key=e.id,t.validators=this.addValidators(e),t.extras=e,"testOrder"===e.type){var o=this.toTestOrderQuestion(e),n=[];n.push(o),t.questions=n}return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toGroupQuestion=function(e){var t=new QuestionGroup({questions:[],type:"",key:""});t.label=e.label,t.questions=this.getChildrenQuestionModels(e.questions),t.key=e.id,t.validators=this.addValidators(e),t.extras=e;return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toPageQuestion=function(e){var t=this,o=new QuestionGroup({questions:[],type:"",key:""});return o.label=e.label,o.key=e.label,o.renderingType="page",o.controlType=exports.AfeControlType.None,o.questions=[],e.sections.forEach((function(e){o.questions.push(t.toSectionQuestion(e))})),o},e.prototype.toFormQuestionModel=function(e){var t=this,o=new QuestionGroup({questions:[],type:"",key:""});return o.label=e.label,o.key=e.label,o.renderingType="form",o.controlType=exports.AfeControlType.AfeFormGroup,o.extras=e,o.questions=[],e.pages.forEach((function(e){o.questions.push(t.toPageQuestion(e))})),o},e.prototype.toSectionQuestion=function(e){var t=new QuestionGroup({questions:[],type:"",key:""});return t.label=e.label,t.key=e.label,t.renderingType="section",t.controlType=exports.AfeControlType.None,t.isExpanded="true"===e.isExpanded,t.questions=this.getSchemaQuestions(e.questions),t},e.prototype.toPersonAttributeQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="personAttribute";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addHistoricalExpressions(e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toEncounterProviderQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="provider";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toFieldSetQuestion=function(e){var t=this.toGroupQuestion(e);return t.renderingType="field-set",t},e.prototype.toEncounterLocationQuestion=function(e){var t=new UiSelectQuestion({options:[],type:"",key:"",searchFunction:function(){},resolveFunction:function(){}});t.label=e.label,t.key=e.id,t.renderingType=e.type,t.renderingType="remote-select",t.validators=this.addValidators(e),t.extras=e,t.dataSource="location";return this.copyProperties({label:"label",required:"required",id:"key"},e,t),this.addDisableOrHideProperty(e,t),this.addAlertProperty(e,t),this.addHistoricalExpressions(e,t),this.addCalculatorProperty(e,t),t},e.prototype.toTestOrderQuestion=function(e){var t=new TestOrderQuestion({type:"",key:"",orderType:"",selectableOrders:[],orderSettingUuid:"",label:"",rendering:""});t.label=e.label,t.key=e.id,t.validators=this.addValidators(e),t.extras=e,t.options=e.questionOptions.selectableOrders.map((function(e){return{label:e.label,value:e.concept}}));return this.copyProperties({label:"label",required:"required",id:"key"},e,t),t},e.prototype.getSchemaQuestions=function(e){var t=new Array;return this.getQuestions(e,t),t},e.prototype.getQuestions=function(e,t){if(Array.isArray(t)||(t=[]),Array.isArray(e))for(var o in e)e.hasOwnProperty(o)&&this.getQuestions(e[o],t);if(e&&!Array.isArray(e)&&"object"==typeof e)if(e.questionOptions)"group"===e.questionOptions.rendering||"repeating"===e.questionOptions.rendering?t.push(this.toModel(e,e.questionOptions.rendering)):"field-set"===e.questionOptions.rendering||t.push(this.toModel(e,e.questionOptions.rendering));else for(var n in e)e.hasOwnProperty(n)&&this.getQuestions(e[n],t)},e.prototype.getChildrenQuestionModels=function(e){var t=[];return this.getQuestions(e,t),t},e.prototype.toModel=function(e,t){switch("ui-select-extended"===t&&(t=e.type),e.id||(e.id=this.generateId(10)),!e.questionOptions||!0!==e.questionOptions.showDate&&"true"!==e.questionOptions.showDate||(e=this.convertOldVersionComplexObsQuestionToNewVersion(e),t="field-set"),t){case"select":case"single-select":case"multi-select":return this.toSelectQuestion(e);case"numeric":return this.toNumericQuestion(e);case"number":return this.toNumberQuestion(e);case"encounterDatetime":return this.toEncounterDatetimeQuestion(e);case"date":return this.toDateQuestion(e);case"multiCheckbox":return this.toMultiCheckboxQuestion(e);case"drug":return this.toDrugQuestion(e);case"problem":return this.toProblemQuestion(e);case"group":return this.toGroupQuestion(e);case"field-set":return this.toFieldSetQuestion(e);case"repeating":return this.toRepeatingQuestion(e);case"personAttribute":return this.toPersonAttributeQuestion(e);case"text":return this.toTextQuestion(e);case"textarea":case"textarea":return this.toTextAreaQuestion(e);case"select-concept-answers":return this.toConceptAnswerSelect(e);case"encounterLocation":return this.toEncounterLocationQuestion(e);case"encounterDatetime":return this.toEncounterDatetimeQuestion(e);case"encounterProvider":return this.toEncounterProviderQuestion(e);case"radio":case"checkbox":return this.toCheckBoxQuestion(e);case"encounterProvider":return this.toEncounterProviderQuestion(e);case"file":return this.toFileUploadQuestion(e);default:return console.warn("New Schema Question Type found........."+t),this.toTextQuestion(e)}},e.prototype.convertOldVersionComplexObsQuestionToNewVersion=function(e){var t={type:"complex-obs"};t.label=e.label,t.id="complex_"+e.id,t.questionOptions={},t.questionOptions.concept=e.questionOptions.concept,t.questionOptions.rendering="field-set",t.questions=[],t.validators=[];var o=JSON.parse(JSON.stringify(e));o.type="complex-obs-child",delete o.questionOptions.showDate,delete o.questionOptions.shownDateOptions,o.questionOptions.obsField="value";var n={type:"complex-obs-child"};n.label="Date of "+o.label,n.id="date_"+o.id,n.questionOptions={},n.questionOptions.concept=e.questionOptions.concept,n.questionOptions.rendering="date",n.questionOptions.obsField="obsDatetime";var r=Object.assign({},e.questionOptions.shownDateOptions);return n.validators=r.validators,n.hide=r.hide,t.questions.push(o),t.questions.push(n),t},e.prototype.copyProperties=function(e,t,o){for(var n in t)e.hasOwnProperty(n)&&o.hasOwnProperty(e[n])&&(o[e[n]]=t[n])},e.prototype.addValidators=function(e){var t=[];e.validators&&lodash.forEach(e.validators,(function(e){switch(e.type){case"date":t.push(new DateValidationModel(e));break;case"js_expression":t.push(new JsExpressionValidationModel(e));break;case"conditionalAnswered":t.push(new ConditionalValidationModel(e));break;default:t.push(new ValidationModel(e))}}));var o=e.questionOptions;switch(o?o.rendering:""){case"number":o.max&&o.min&&(t.push(new MaxValidationModel({type:"max",max:o.max})),t.push(new MinValidationModel({type:"min",min:o.min})))}if("object"==typeof e.required){var n=e.required;"conditionalRequired"===n.type&&t.push(new ConditionalValidationModel({referenceQuestionId:n.referenceQuestionId,referenceQuestionAnswers:n.referenceQuestionAnswers,type:n.type,message:n.message}))}return t},e.prototype.addHistoricalExpressions=function(e,t){if(e.historicalExpression&&e.historicalExpression.length>0){t.setHistoricalValue(!0),void 0!==e.showHistoricalEncounterDate?t.showHistoricalEncounterDate("true"===e.showHistoricalEncounterDate):t.showHistoricalEncounterDate();var o=this.historicalHelperService.evaluate(e.historicalExpression,this.dataSources,void 0);if(t.historicalDataValue=o,e.historicalPrepopulateCondition&&o)return void(this.historicalHelperService.evaluatePrecondition(e.historicalPrepopulateCondition,this.dataSources,o)&&(t.defaultValue=o.value));if(e.historicalPrepopulate&&o){var n=moment$5(o.valueDate),r=moment$5().diff(n,"days");Number.isInteger(e.allowedHistoricalValueAgeInDays)?r<=e.allowedHistoricalValueAgeInDays&&(t.defaultValue=o.value):t.defaultValue=o.value}}},e.prototype.addCalculatorProperty=function(e,t){e.questionOptions&&"object"==typeof e.questionOptions.calculate&&(t.calculateExpression=e.questionOptions.calculate.calculateExpression)},e.prototype.addAlertProperty=function(e,t){e.alert&&(t.alert=e.alert)},e.prototype.addDisableOrHideProperty=function(e,t){e.disable&&(t.disable=e.disable),"object"==typeof e.disable&&(t.disable=e.disable.disableWhenExpression),e.hide&&(t.hide=e.hide),"object"==typeof e.hide&&e.hide.hideWhenExpression&&(t.hide=e.hide.hideWhenExpression)},e.prototype.generateId=function(e){for(var t="_";t.length<e&&e>0;){var o=Math.random();t+=o<.1?Math.floor(100*o):String.fromCharCode(Math.floor(26*o)+(o>.5?97:65))}return"_"+t},e}(),FormFactory=function(){function e(e,t,o){this.controlService=e,this.questionFactroy=t,this.controlRelationsFactory=o,this.hd={getValue:function(){return 20}}}return e.prototype.createForm=function(e,t){var o=new Form(e,this,this.questionFactroy);if(t)for(var n in t)t.hasOwnProperty(n)&&o.dataSourcesContainer.registerDataSource(n,t[n],!1);var r=this.questionFactroy.createQuestionModel(e,o);return o.rootNode=this.createNode(r,null,null,o),this.buildRelations(o.rootNode),o.updateHiddenDisabledStateForAllControls(),o.updateAlertsForAllControls(),o},e.prototype.buildRelations=function(e){Validations.JSExpressionValidatorsEnabled=!1,this.controlRelationsFactory.buildRelations(e),Validations.JSExpressionValidatorsEnabled=!0},e.prototype.createNode=function(e,t,o,n){return e instanceof NestedQuestion?e instanceof RepeatingQuestion?this.createArrayNode(e,t,o,n):this.createGroupNode(e,t,o,n):this.createLeafNode(e,t,o,n)},e.prototype.createLeafNode=function(e,t,o,n){var r=this.controlService.generateControlModel(e,o,!1,n);return new LeafNode(e,r,null,n,t?t.path:void 0)},e.prototype.createGroupNode=function(e,t,o,n){var r=this.controlService.generateControlModel(e,o,!1,n),i=new GroupNode(e,r,null,n,t?t.path:void 0);return this.createNodeChildren(e,i,r||o,n),i},e.prototype.createArrayNode=function(e,t,o,n){var r=this,i=this.controlService.generateControlModel(e,o,!1,n),a=new ArrayNode(e,i,o,this,n,t?t.path:void 0);return a.createChildFunc=this.createArrayNodeChild,a.removeChildFunc=this.removeArrayNodeChild,a.addChildNodeCreatedListener((function(e){Validations.JSExpressionValidatorsEnabled=!1,r.controlRelationsFactory.buildArrayNodeRelations(e),Validations.JSExpressionValidatorsEnabled=!0})),a},e.prototype.createNodeChildren=function(e,t,o,n){var r=this;return e.questions.forEach((function(e){var i=r.createNode(e,t,o,n);t.setChild(e.key,i)})),t.children},e.prototype.createArrayNodeChild=function(e,t,o){null==o&&(o=this);var n=new QuestionGroup({key:t.path+"."+t.children.length,type:"group",extras:e.extras,label:"",questions:e.questions});e.controlType===exports.AfeControlType.None&&(n.controlType=e.controlType);var r=o.createGroupNode(n,null,null,t.form);if(t.children.push(r),t.control instanceof AfeFormArray){var i=t.control;i.setControl(i.controls.length,r.control)}return r},e.prototype.removeArrayNodeChild=function(e,t){var o=t.children[e];if(t.children.splice(e,1),(null!==t.control||void 0!==t.control)&&t.control instanceof AfeFormArray){var n=t.control,r=n.controls.indexOf(o.control);r>=0&&n.removeAt(r)}},e.ctorParameters=function(){return[{type:FormControlService},{type:QuestionFactory},{type:ControlRelationsFactory}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[FormControlService,QuestionFactory,ControlRelationsFactory])],e)}(),moment$6=moment_,ObsAdapterHelper=function(){function e(){}return e.prototype.findObsAnswerToQuestion=function(e,t){var o=this,n=[];if(!this.isObsNode(e))return n;if(e instanceof LeafNode||e instanceof GroupNode&&"complex-obs"===e.question.extras.type)return lodash.each(t,(function(t){t.concept&&t.concept.uuid===e.question.extras.questionOptions.concept&&n.push(t)})),n;var r=this.getChildQuestionsConceptUuids(e);return r.length>0&&lodash.each(t,(function(t){t.concept&&t.concept.uuid===e.question.extras.questionOptions.concept&&Array.isArray(t.groupMembers)&&o.isSubsetOf(r,o.getGroupMembersConceptUuids(t))&&n.push(t)})),n},e.prototype.getChildQuestionsConceptUuids=function(e){var t=[];return e.question.extras&&e.question.extras.questions&&lodash.each(e.question.extras.questions,(function(e){e.questionOptions&&e.questionOptions.concept&&t.push(e.questionOptions.concept)})),t},e.prototype.getGroupMembersConceptUuids=function(e){var t=[];return Array.isArray(e.groupMembers)&&lodash.each(e.groupMembers,(function(e){t.push(e.concept.uuid)})),t},e.prototype.isObsNode=function(e){return e.question.extras&&("obs"===e.question.extras.type||"obsGroup"===e.question.extras.type||"complex-obs"===e.question.extras.type||"complex-obs-child"===e.question.extras.type)},e.prototype.isSubsetOf=function(e,t){return 0===t.length&&0===e.length||t.every((function(t){return e.indexOf(t)>=0}))},e.prototype.setSimpleObsNodeValue=function(e,t){if(e&&t.length>0){var o=t[0];e.initialValue=o,!this.isEmpty(o.value)&&o.value.uuid?this.setNodeFormControlValue(e,o.value.uuid):this.isEmpty(o.value)||this.setNodeFormControlValue(e,o.value)}},e.prototype.setMultiselectObsNodeValue=function(e,t){var o,n;if(e&&t.length>0){e.initialValue=t;var r=[];try{for(var i=__values(t),a=i.next();!a.done;a=i.next()){var s=a.value;r.push(s.value.uuid)}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}this.setNodeFormControlValue(e,r)}},e.prototype.setComplexObsNodeValue=function(e,t){if(e&&t.length>0){var o=void 0,n=void 0,r=e;for(var i in r.children)"value"===r.children[i].question.extras.questionOptions.obsField&&(o=r.children[i]),"obsDatetime"===r.children[i].question.extras.questionOptions.obsField&&(n=r.children[i]);this.setNodeValue(o,t),e.initialValue=o.initialValue,n.initialValue=o.initialValue,this.setNodeFormControlValue(n,o.initialValue.obsDatetime)}},e.prototype.setGroupObsNodeValue=function(e,t){if(e&&t.length>0){var o=e;for(var n in o.initialValue=t[0],o.children)this.setNodeValue(o.children[n],t[0].groupMembers)}},e.prototype.setRepeatingGroupObsNodeValue=function(e,t){if(e&&t.length>0){var o=e;o.initialValue=t;for(var n=0;n<t.length;n++){var r=o.createChildNode();this.setGroupObsNodeValue(r,[t[n]])}}},e.prototype.setNodeValue=function(e,t){switch(this.getObsNodeType(e)){case"unknown":if(e instanceof GroupNode){var o=e;for(var n in o.children)this.setNodeValue(o.children[n],t);break}if(e instanceof ArrayNode){for(var r=e,i=0;i<r.children.length;i++)this.setNodeValue(r.children[i],t);break}break;case"simple":var a=this.findObsAnswerToQuestion(e,t);this.setSimpleObsNodeValue(e,a);break;case"multiselect":var s=this.findObsAnswerToQuestion(e,t);this.setMultiselectObsNodeValue(e,s);break;case"complex":var l=this.findObsAnswerToQuestion(e,t);this.setComplexObsNodeValue(e,l);break;case"group":var c=this.findObsAnswerToQuestion(e,t);c.length>0&&this.setGroupObsNodeValue(e,c);break;case"repeatingGroup":var u=this.findObsAnswerToQuestion(e,t);u.length>0&&this.setRepeatingGroupObsNodeValue(e,u);break;default:console.error("Unknown obs node",e)}},e.prototype.setNodeFormControlValue=function(e,t){e.control.setValue(t),e.question.enableHistoricalValue&&void 0!==e.initialValue&&e.question.setHistoricalValue(!1)},e.prototype.getObsNodeType=function(e){return this.isObsNode(e)?e instanceof LeafNode&&("multiCheckbox"===e.question.extras.questionOptions.rendering||"checkbox"===e.question.extras.questionOptions.rendering||"multi-select"===e.question.extras.questionOptions.rendering)?"multiselect":e instanceof LeafNode?"simple":e instanceof GroupNode&&"complex-obs"===e.question.extras.type?"complex":e instanceof ArrayNode&&"obsGroup"===e.question.extras.type&&"repeating"===e.question.extras.questionOptions.rendering?"repeatingGroup":e instanceof GroupNode&&"obsGroup"===e.question.extras.type?"group":"unknownObs":"unknown"},e.prototype.getSimpleObsPayload=function(e){if(this.isEmpty(e.control.value))return e.initialValue?{uuid:e.initialValue.uuid,voided:!0}:null;if(e.initialValue&&!this.simpleNodeValueChanged(e))return null;var t={concept:e.question.extras.questionOptions.concept,value:e.control.value};return"date"===e.question.extras.questionOptions.rendering&&(t.value=this.toOpenMrsDateTimeString(e.control.value)),e.initialValue&&(delete t.concept,t.uuid=e.initialValue.uuid),t},e.prototype.getComplexObsPayload=function(e){var t,o,n=e;for(var r in n.children)"value"===n.children[r].question.extras.questionOptions.obsField&&(t=n.children[r]),"obsDatetime"===n.children[r].question.extras.questionOptions.obsField&&(o=n.children[r]);var i=this.getObsNodePayload(t);if(console.log("valuePayload",i),i.length>0)return i[0].obsDatetime=this.toOpenMrsDateTimeString(o.control.value),i[0];if(0===i.length&&e.initialValue&&!this.areDatesEqual(e.initialValue.obsDatetime,o.control.value)){var a={uuid:e.initialValue.uuid};return a.obsDatetime=this.toOpenMrsDateTimeString(o.control.value),a}return null},e.prototype.getMultiselectObsPayload=function(e){var t=[],o=[];return Array.isArray(e.initialValue)&&lodash.each(e.initialValue,(function(n){o.push(n.value.uuid),Array.isArray(e.control.value)?e.control.value.indexOf(n.value.uuid)<0&&t.push({uuid:n.uuid,voided:!0}):t.push({uuid:n.uuid,voided:!0})})),Array.isArray(e.control.value)&&lodash.each(e.control.value,(function(n){o.indexOf(n)<0&&t.push({concept:e.question.extras.questionOptions.concept,value:n})})),t},e.prototype.getGroupPayload=function(e){var t=this,o=e,n=[];if(lodash.each(o.children,(function(e){var o=t.getObsNodePayload(e);o.length>0&&(n=n.concat(o))})),0===n.length)return null;var r={groupMembers:n};return o.initialValue?r.uuid=o.initialValue.uuid:r.concept=o.question.extras.questionOptions.concept,r},e.prototype.getRepeatingGroupPayload=function(e){var t=this,o=e,n=[],r=[];return lodash.each(o.children,(function(e){var o=t.getObsNodePayload(e);o.length>0&&(n=n.concat(o)),e.initialValue&&e.initialValue.uuid&&r.push(e.initialValue.uuid)})),o.initialValue&&Array.isArray(o.initialValue)&&lodash.each(o.initialValue,(function(e){if(r.indexOf(e.uuid)<0){var t={uuid:e.uuid,voided:!0};n.push(t)}})),n.length<=0?null:n},e.prototype.getObsNodePayload=function(e){var t=[];switch(this.getObsNodeType(e)){case"unknown":if(e instanceof GroupNode){var o=e;for(var n in o.children){var r=this.getObsNodePayload(o.children[n]);Array.isArray(r)&&r.length>0&&(t=t.concat(r))}break}if(e instanceof ArrayNode){for(var i=e,a=0;a<i.children.length;a++){var s=this.getObsNodePayload(i.children[a]);Array.isArray(s)&&s.length>0&&(t=t.concat(s))}break}break;case"simple":var l=this.getSimpleObsPayload(e);null!==l&&t.push(l);break;case"multiselect":var c=this.getMultiselectObsPayload(e);Array.isArray(c)&&c.length>0&&(t=t.concat(c));break;case"complex":var u=this.getComplexObsPayload(e);null!==u&&t.push(u);break;case"group":var d=this.getGroupPayload(e);d&&null!==d&&t.push(d);break;case"repeatingGroup":var p=this.getRepeatingGroupPayload(e);Array.isArray(p)&&p.length>0&&(t=t.concat(p))}return t},e.prototype.simpleNodeValueChanged=function(e){return!!e.initialValue&&(e.initialValue.value&&e.initialValue.value.uuid?e.control.value!==e.initialValue.value.uuid:"date"===e.question.extras.questionOptions.rendering?!this.areDatesEqual(e.control.value,e.initialValue.value):e.control.value!==e.initialValue.value)},e.prototype.areDatesEqual=function(e,t){return moment$6(e).isSame(t)},e.prototype.isEmpty=function(e){return""===e||null==e},e.prototype.toOpenMrsDateTimeString=function(e){if(!this.isEmpty(e)){var t=moment$6(e).format().substring(0,19).replace("T"," ");return this.isEmpty(t)?void 0:t}},e}(),ObsValueAdapter=function(){function e(e){this.helper=e}return e.prototype.generateFormPayload=function(e){return this.helper.getObsNodePayload(e.rootNode)},e.prototype.populateForm=function(e,t){this.helper.setNodeValue(e.rootNode,t)},e.prototype.setValues=function(e,t,o){var n,r;if(e){var i=function(e){if(e instanceof LeafNode)a.setObsValue(e,t),e.question.enableHistoricalValue&&void 0!==e.initialValue&&e.question.setHistoricalValue(!1);else if(e.question&&e.question.extras&&"group"===e.question.renderingType||o){var n=lodash.find(t,(function(t){return t.concept.uuid===e.question.extras.questionOptions.concept&&t.groupMembers}));n&&(e.node&&(e.node.initialValue=n),a.setValues(e.groupMembers,n.groupMembers)),o&&e.payload&&a.setValues(e.groupMembers,e.payload.groupMembers)}else if(e instanceof GroupNode&&"complex-obs"===e.question.extras.type)a.setComplexObsValue(e,t);else{if(!e.question||!e.question.extras||"repeating"!==e.question.renderingType||o)throw new Error("not implemented");a.setRepeatingGroupValues(e,t),e.node.control.updateValueAndValidity()}},a=this;try{for(var s=__values(e),l=s.next();!l.done;l=s.next()){i(l.value)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}},e.prototype.setObsValue=function(e,t){if(e.question&&e.question.extras&&("obs"===e.question.extras.type||"complex-obs-child"===e.question.extras.type&&"value"===e.question.extras.questionOptions.obsField)&&"multiCheckbox"!==e.question.extras.questionOptions.rendering||"checkbox"!==e.question.extras.questionOptions.rendering||"multi-select"!==e.question.extras.questionOptions.rendering){var o=lodash.find(t,(function(t){return t.concept.uuid===e.question.extras.questionOptions.concept}));o&&(o.value instanceof Object?(e.control.setValue(o.value.uuid),e.control.updateValueAndValidity()):(e.control.setValue(o.value),e.control.updateValueAndValidity()),e.initialValue={obsUuid:o.uuid,value:o.value})}else{var n=lodash.filter(t,(function(t){return t.concept.uuid===e.question.extras.questionOptions.concept}));n&&n.length>0&&(e.control.setValue(this.getMultiselectValues(n)),e.control.updateValueAndValidity(),e.initialValue=n)}},e.prototype.setComplexObsValue=function(e,t){var o,n;for(var r in e.children)"value"===e.children[r].question.extras.questionOptions.obsField&&(o=e.children[r]),"obsDatetime"===e.children[r].question.extras.questionOptions.obsField&&(n=e.children[r]);this.setObsValue(o,t);var i=lodash.find(t,(function(t){return t.concept.uuid===e.question.extras.questionOptions.concept}));i&&(n.initialValue={obsUuid:i.uuid,value:i.obsDatetime},n.control.setValue(i.obsDatetime),n.control.updateValueAndValidity())},e.prototype.getMultiselectValues=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(a.value.uuid)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.setRepeatingGroupValues=function(e,t){var o,n,r=lodash.filter(t,(function(t){var o=t.concept.uuid===e.question.extras.questionOptions.concept,n=!1;if(o&&t.groupMembers){var r=t.groupMembers.map((function(e){return e.concept.uuid})),i=e.question.questions.map((function(e){return e.extras.questionOptions.concept}));n=lodash.intersection(r,i).length>0}return o&&n}));if(r.length>0){e.node.initialValue=r;for(var i=0;i<r.length;i++)e.node.createChildNode()}var a=[],s=0,l=function(t){var o=Object.keys(t.children).map((function(e){return t.children[e]})),n=r[s];a.push({question:e.question,groupMembers:o,payload:n}),s++};try{for(var c=__values(e.node.children),u=c.next();!u.done;u=c.next()){l(u.value)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}this.setValues(a,r,!0)},e.prototype.getQuestionNodes=function(e){var t,o,n,r,i=[];try{for(var a=__values(e),s=a.next();!s.done;s=a.next()){var l=s.value;try{for(var c=(n=void 0,__values(l.page)),u=c.next();!u.done;u=c.next()){var d=u.value;i.push(d.section)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(t)throw t.error}}return[].concat.apply([],i)},e.prototype.repeatingGroup=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push({question:a.question,groupMembers:this.traverse(a)})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.processGroup=function(e,t){if(e.question&&e.question.extras&&"group"===e.question.extras.questionOptions.rendering){var o=lodash.filter(this.getObsPayload(e.groupMembers),(function(e){return""!==e.value})),n=o.map((function(e){return e.voided}));o.length>0&&n.every(Boolean)?t.push({uuid:e.node.initialValue.uuid,voided:!0}):o.length>0&&(e.node.initialValue?t.push({uuid:e.node.initialValue.uuid,groupMembers:o}):t.push({concept:e.question.extras.questionOptions.concept,groupMembers:o}))}},e.prototype.mapInitialGroup=function(e){var t,o,n={};try{for(var r=__values(e.groupMembers),i=r.next();!i.done;i=r.next()){var a=i.value,s="";a.value instanceof Object?s=a.value.uuid:a.value?s=a.value:a.groupMembers&&a.groupMembers.length>0&&(n=this.mapInitialGroup(e)),n[a.concept.uuid+":"+s]=s}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.mapModelGroup=function(e,t){var o={};for(var n in t)if(t.hasOwnProperty(n)){var r=lodash.find(e.question.questions,{key:n}),i=t[n];i instanceof Object||""!==i&&(o[r.extras.questionOptions.concept+":"+i]=i)}return o},e.prototype.processRepeatingGroups=function(e,t){var o,n,r,i,a,s,l,c,u=[];if(e.node.initialValue)try{for(var d=__values(e.node.initialValue),p=d.next();!p.done;p=d.next()){var h=p.value;u.push({uuid:h.uuid,value:this.mapInitialGroup(h)})}}catch(e){o={error:e}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(o)throw o.error}}var f=[];try{for(var y=__values(e.node.control.value),m=y.next();!m.done;m=y.next()){var g=m.value;f.push({value:this.mapModelGroup(e,g)})}}catch(e){r={error:e}}finally{try{m&&!m.done&&(i=y.return)&&i.call(y)}finally{if(r)throw r.error}}var v=this.leftOuterJoinArrays(u,f),b=this.leftOuterJoinArrays(f,u),_=e.question.extras.questionOptions.concept,x=[];if(v.length>0){var w=this.createGroupDeletedObs(v);try{for(var C=__values(w),O=C.next();!O.done;O=C.next()){var S=O.value;t.push(S)}}catch(e){a={error:e}}finally{try{O&&!O.done&&(s=C.return)&&s.call(C)}finally{if(a)throw a.error}}b.length>0&&(x=this.createGroupNewObs(b,_))}else x=this.createGroupNewObs(b,_);if(x.length>0)try{for(var k=__values(x),q=k.next();!q.done;q=k.next()){var A=q.value;t.push(A)}}catch(e){l={error:e}}finally{try{q&&!q.done&&(c=k.return)&&c.call(k)}finally{if(l)throw l.error}}},e.prototype.leftOuterJoinArrays=function(e,t){return e.filter((function(e){return!t.some((function(t){return lodash.isEqual(e.value,t.value)}))}))},e.prototype.createGroupNewObs=function(e,t){var o,n,r=[];try{for(var i=__values(e),a=i.next();!a.done;a=i.next()){var s=a.value,l=[];for(var c in s.value){var u=c.split(":")[0],d=c.split(":")[1];l.push({concept:u,value:d})}r.push({concept:t,groupMembers:l})}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return r},e.prototype.createGroupDeletedObs=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push({uuid:a.uuid,voided:!0})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.getExactTime=function(e){return e.substring(0,19).replace("T"," ")},e.prototype.processObs=function(e,t){if(e.control&&e.question.extras){var o={concept:e.question.extras.questionOptions.concept,value:"date"!==e.question.extras.questionOptions.rendering||this.isEmpty(e.control.value)?e.control.value:this.getExactTime(e.control.value)};if("multiCheckbox"===e.question.extras.questionOptions.rendering||"checkbox"===e.question.extras.questionOptions.rendering||"multi-select"===e.question.extras.questionOptions.rendering){var n=this.processMultiSelect(e.question.extras.questionOptions.concept,e.control.value);if(e.initialValue){var r=e.initialValue.map((function(e){return{uuid:e.uuid,value:{concept:e.concept.uuid,value:e.value.uuid}}})),i=n.map((function(e){return{value:e}})),a=this.leftOuterJoinArrays(r,i),s=this.leftOuterJoinArrays(i,r);this.processDeletedMultiSelectObs(a,t),this.processNewMultiSelectObs(s,t)}else this.processNewMultiSelectObs(n,t)}else e.initialValue&&e.initialValue.value&&o?this.updateOrVoidObs(o,e.initialValue,t):""!==o.value&&null!==o.value&&t.push(o)}},e.prototype.processComplexObs=function(e,t){var o,n;for(var r in e.children)"value"===e.children[r].question.extras.questionOptions.obsField&&(o=e.children[r]),"obsDatetime"===e.children[r].question.extras.questionOptions.obsField&&(n=e.children[r]);if(o){this.processObs(o,t);var i=t.length>0?t[t.length-1]:void 0;i&&(i.concept&&i.concept===e.question.extras.questionOptions.concept||o.initialValue&&i.uuid===o.initialValue.obsUuid)&&n.initialValue&&n.control.value!==n.initialValue.value&&(i.obsDatetime=n.control.value)}},e.prototype.processDeletedMultiSelectObs=function(e,t){var o,n;try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;t.push({uuid:a.uuid,voided:!0})}}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}},e.prototype.processNewMultiSelectObs=function(e,t){var o,n;try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;a.value instanceof Object?t.push(a.value):t.push(a)}}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}},e.prototype.updateOrVoidObs=function(e,t,o){this.isEmpty(e.value)&&t.value?o.push({uuid:t.obsUuid,voided:!0}):!this.isEmpty(e.value)&&t.value&&o.push({uuid:t.obsUuid,value:e.value})},e.prototype.isEmpty=function(e){return""===e||null==e},e.prototype.traverse=function(e,t){var o=[];if(e.children){if(e.children instanceof Array)return this.repeatingGroup(e.children);if(e.children instanceof Object)for(var n in e.children)if(e.children.hasOwnProperty(n))switch(e.children[n].question.renderingType){case"page":var r=this.traverse(e.children[n]);o.push({page:r,label:e.children[n].question.label});break;case"section":var i=this.traverse(e.children[n]);o.push({section:i,node:e.children[n],label:e.children[n].question.label});break;case"group":var a=this.traverse(e.children[n]);o.push({node:e.children[n],question:e.children[n].question,groupMembers:a});break;case"repeating":var s=this.repeatingGroup(e.children[n].children);o.push({node:e.children[n],question:e.children[n].question,groupMembers:s});break;default:o.push(e.children[n])}}return o},e.prototype.processMultiSelect=function(e,t){var o,n,r=[];if(t&&null!==t)try{for(var i=__values(t),a=i.next();!a.done;a=i.next()){var s={concept:e,value:a.value};r.push(s)}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return r},e.prototype.isObs=function(e){return"obs"===e.question.extras.type||"obsGroup"===e.question.extras.type||"complex-obs"===e.question.extras.type},e.prototype.getObsPayload=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;this.isObs(a)&&(a.groupMembers,"group"===a.question.extras.questionOptions.rendering?this.processGroup(a,n):(a.groupMembers,"repeating"===a.question.extras.questionOptions.rendering?this.processRepeatingGroups(a,n):a instanceof GroupNode&&"complex-obs"===a.question.extras.type?this.processComplexObs(a,n):this.processObs(a,n)))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.ctorParameters=function(){return[{type:ObsAdapterHelper}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[ObsAdapterHelper])],e)}(),OrderValueAdapter=function(){function e(){this.formOrderNodes=[],this.provider=""}return e.prototype.generateFormPayload=function(e){return this.formOrderNodes=[],this._setOrderProvider(e),this._findTestOrderQuestionNodes(e.rootNode),this._createOrdersPayload(this.formOrderNodes,e)},e.prototype.populateForm=function(e,t){e.existingOrders=t,this.formOrderNodes=[],this._findTestOrderQuestionNodes(e.rootNode);var o=this._getExistingOrders(e);this._setOrderValues(this.formOrderNodes,o)},e.prototype._setOrderProvider=function(e){e.valueProcessingInfo.providerUuid&&(this.provider=e.valueProcessingInfo.providerUuid)},e.prototype._createOrdersPayload=function(e,t){var o,n,r,i=[],a=[],s=this._getExistingOrders(t),l=function(e){var t=e.control.value,o=[];for(var n in s&&s.map((function(e){o[e.concept]=e.concept})),t)if(t.hasOwnProperty(n)){var r=t[n][e.question.key],l=c._createPayloadOrder(r,e.question.extras);o[r]!==r&&""!==l.concept&&i.push(l),a[r]=r,""===l.orderNumber&&delete l.orderNumber,""===l.uuid&&delete l.uuid}},c=this;try{for(var u=__values(e),d=u.next();!d.done;d=u.next()){l(d.value)}}catch(e){o={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(o)throw o.error}}return r=this._getDeletedOrders(a,s),this._addDeletedOrdersToPayload(r,i)},e.prototype._getExistingOrders=function(e){if(e.existingOrders&&e.existingOrders.orders){var t=e.existingOrders.orders.map((function(e){return{concept:e.concept.uuid,orderNumber:e.orderNumber,orderUuid:e.uuid,voided:e.voided,dateVoided:e.auditInfo.dateVoided}}));return lodash.filter(t,(function(e){return!0!==e.voided&&!e.dateVoided}))}},e.prototype._setOrderValues=function(e,t){var o,n;this._findTestOrderQuestionNodes(e);var r=this.formOrderNodes;try{for(var i=__values(r),a=i.next();!a.done;a=i.next()){var s=a.value;this._setOrderNodeValues(s,t)}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}},e.prototype._addDeletedOrdersToPayload=function(e,t){for(var o in e)e.hasOwnProperty(o)&&t.push({uuid:e[o],voided:!0});return t},e.prototype._createPayloadOrder=function(e,t){var o={concept:"",type:"",orderer:"",careSetting:""};return o.concept=e,o.type=t.questionOptions.orderType,o.orderer=this.provider,o.careSetting=t.questionOptions.orderSettingUuid,""===o.orderer&&delete o.orderer,o},e.prototype._getDeletedOrders=function(e,t){var o=[];if(e)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n].concept;e[r]!==r&&o.push(t[n].orderUuid)}return o},e.prototype._setOrderNodeValues=function(e,t){var o,n,r=0;e.initialValue=t;try{for(var i=__values(t),a=i.next();!a.done;a=i.next()){var s=a.value;e.createChildNode();var l={};l[e.question.key]=s.concept;var c=e.children[r];c.control.setValue(l),c.initialValue=l,c.orderNumber=s.orderNumber,r++}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}},e.prototype._findTestOrderQuestionNodes=function(e){if(e.children&&e.children instanceof Object)for(var t in e.children)if(e.children.hasOwnProperty(t))switch(e.children[t].question.renderingType){case"page":case"section":case"group":this._findTestOrderQuestionNodes(e.children[t]);break;case"repeating":if(e.children)for(var o in e.children){var n=e.children[o].question;n.extras&&"testOrder"===n.extras.type&&this.formOrderNodes.push(e.children[o])}}},e=__decorate([core.Injectable()],e)}(),moment$7=moment_,EncounterAdapter=function(){function e(e,t){this.ordersAdapter=e,this.obsAdapter=t}return e.prototype.populateForm=function(e,t){this.populateNode(e.rootNode,t),Array.isArray(t.orders)&&this.ordersAdapter.populateForm(e,t),Array.isArray(t.obs)&&this.obsAdapter.populateForm(e,t.obs)},e.prototype.populateNode=function(e,t){if(null==t)throw new Error("Expected payload");this.getEncounterNodes(e).forEach((function(e){switch(e.question.extras.type){case"encounterDatetime":t.encounterDatetime&&(e.control.setValue(moment$7(t.encounterDatetime).toDate()),e.initialValue=moment$7(t.encounterDatetime).toDate());break;case"encounterProvider":if(Array.isArray(t.encounterProviders)&&t.encounterProviders.length>0){var o=t.encounterProviders[0].provider;o&&o.uuid&&(e.control.setValue(o.uuid),setTimeout((function(){e.control.setValue(o.uuid)})),e.initialValue=o.uuid)}break;case"encounterLocation":t.location&&t.location.uuid&&(e.control.setValue(t.location.uuid),e.initialValue=t.location.uuid)}}))},e.prototype.generateFormPayload=function(e){var t=this.generateNodePayload(e.rootNode);return this.setNonFilledPayloadMembers(e,t),t.obs=this.obsAdapter.generateFormPayload(e)||[],t.orders=this.ordersAdapter.generateFormPayload(e)||[],t},e.prototype.generateNodePayload=function(e){var t=this.getEncounterNodes(e),o={};return t.forEach((function(t){if(null!==t.control.value&&void 0!==t.control.value&&""!==t.control.value)switch(t.question.extras.type){case"encounterDatetime":var n=moment$7(t.control.value).utcOffset(e.form.valueProcessingInfo.utcOffset||"+0300");o.encounterDatetime=n.format("YYYY-MM-DD HH:mm:ss");break;case"encounterProvider":if(t.control.value&&""!==t.control.value){var r=[];r.push({provider:t.control.value,encounterRole:"a0b03050-c99b-11e0-9572-0800200c9a66"}),o.encounterProviders=r}break;case"encounterLocation":o.location=t.control.value}})),o},e.prototype.getEncounterNodes=function(e){var t=[];return this._getEncounterNodes(e,t),t},e.prototype.setNonFilledPayloadMembers=function(e,t){e.valueProcessingInfo.patientUuid&&this.setPayloadPatientUuid(t,e.valueProcessingInfo.patientUuid),e.valueProcessingInfo.visitUuid&&this.setPayloadVisitUuid(t,e.valueProcessingInfo.visitUuid),e.valueProcessingInfo.encounterTypeUuid&&this.setPayloadEncounterTypeUuid(t,e.valueProcessingInfo.encounterTypeUuid),e.valueProcessingInfo.formUuid&&this.setPayloadFormUuid(t,e.valueProcessingInfo.formUuid),e.valueProcessingInfo.encounterUuid&&this.setPayloadEncounterUuid(t,e.valueProcessingInfo.encounterUuid)},e.prototype.setPayloadPatientUuid=function(e,t){e.patient=t},e.prototype.setPayloadVisitUuid=function(e,t){e.visit=t},e.prototype.setPayloadEncounterTypeUuid=function(e,t){e.encounterType=t},e.prototype.setPayloadFormUuid=function(e,t){e.form=t},e.prototype.setPayloadEncounterUuid=function(e,t){e.uuid=t},e.prototype._getEncounterNodes=function(e,t){var o=this;if(this._isEncounterNode(e)&&t.push(e),e instanceof GroupNode){var n=e;for(var r in n.children)n.children[r]instanceof NodeBase&&this._getEncounterNodes(n.children[r],t)}e instanceof ArrayNode&&(n=e).children.forEach((function(e){o._getEncounterNodes(e,t)}))},e.prototype._isEncounterNode=function(e){return!(!e.question.extras||"encounterDatetime"!==e.question.extras.type&&"encounterProvider"!==e.question.extras.type&&"encounterLocation"!==e.question.extras.type)},e.ctorParameters=function(){return[{type:OrderValueAdapter},{type:ObsValueAdapter}]},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[OrderValueAdapter,ObsValueAdapter])],e)}(),PersonAttribuAdapter=function(){function e(){}return e.prototype.generateFormPayload=function(e){return this.generateNodePayload(e.rootNode)},e.prototype.generateNodePayload=function(e){var t=this.getPersonAttributeNodes(e),o=[];return t.forEach((function(e){null!==e.control.value&&void 0!==e.control.value&&""!==e.control.value&&e.initialValue!==e.control.value&&(!0===e.question.extras.questionOptions.isSimpleValue?o.push({attributeType:e.question.extras.questionOptions.attributeType,value:e.control.value}):o.push({attributeType:e.question.extras.questionOptions.attributeType,hydratedObject:e.control.value}))})),o},e.prototype.populateForm=function(e,t){this.populateNode(e.rootNode,t)},e.prototype.populateNode=function(e,t){if(!Array.isArray(t))throw new Error("Expected an array of attributes");this.getPersonAttributeNodes(e).forEach((function(e){t.forEach((function(t){t.attributeType.uuid===e.question.extras.questionOptions.attributeType&&(t.value.uuid?(e.control.setValue(t.value.uuid),e.initialValue=t.value.uuid):(e.control.setValue(t.value),e.initialValue=t.value))}))}))},e.prototype.getPersonAttributeNodes=function(e){var t=[];return this._getPersonAttributesNodes(e,t),t},e.prototype._getPersonAttributesNodes=function(e,t){var o=this;if(e.question.extras&&"personAttribute"===e.question.extras.type&&t.push(e),e instanceof GroupNode){var n=e;for(var r in n.children)n.children[r]instanceof NodeBase&&this._getPersonAttributesNodes(n.children[r],t)}e instanceof ArrayNode&&(n=e).children.forEach((function(e){o._getPersonAttributesNodes(e,t)}))},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),RemoteSelectComponent=function(){function e(e){this.renderer=e,this.placeholder="Search...",this.items=[],this.value=[],this.loading=!1,this.searchText="",this.notFoundMsg="match no found",this.done=new core.EventEmitter,this.characters=[],this.propagateChange=function(e){}}var t;return t=e,Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e,this._dataSource&&this._dataSource.dataFromSourceChanged&&this.subscribeToDataSourceDataChanges()},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.subscribeToDataSourceDataChanges=function(){var e=this;this._dataSource.dataFromSourceChanged.subscribe((function(t){t.length>0?(e.items=t,e.notFoundMsg="",e.restoreSelectedValue(e.selectC.value,t)):(e.notFoundMsg="Not found",e.items=[])}))},e.prototype.typed=function(e){this.search(e)},e.prototype.search=function(e){var t=this;this.dataSource&&(this.searchText=e,this.notFoundMsg="Loading.........",this.dataSource.searchOptions(e).subscribe((function(e){if(e.length>0){var o=lodash.map(t.value,lodash.clone).concat(e);t.items=lodash.uniqBy(o,"value")}t.notFoundMsg=""}),(function(e){t.notFoundMsg="Errored"})))},e.prototype.restoreSelectedValue=function(e,t){var o=this,n=!1;lodash.each(t,(function(t){t.value===e&&(setTimeout((function(){o.selectC.select(e),o.selectC.value=e})),n=!0)})),n||setTimeout((function(){o.selectC.select(""),o.selectC.value=""}))},e.prototype.canSearch=function(e){return(e.length-this.searchText.length>=2||e.length-this.searchText.length<=2&&""!==e)&&!1===this.loading},e.prototype.writeValue=function(e){var t=this;e&&""!==e&&this.dataSource&&(this.loading=!0,this.dataSource.resolveSelectedValue(e).subscribe((function(e){t.items=[e],setTimeout((function(){t.selectC.select(e.value),t.selectC.value=e.value})),t.loading=!1}),(function(e){t.loading=!1})))},e.prototype.registerOnChange=function(e){this.propagateChange=e},e.prototype.registerOnTouched=function(){},e.prototype.onChange=function(e){this.propagateChange(e.id)},e.prototype.removed=function(e){console.log("Removed"),this.propagateChange("")},e.prototype.selected=function(e){this.propagateChange(e.value)},e.ctorParameters=function(){return[{type:core.Renderer2}]},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"placeholder",void 0),__decorate([core.Input(),__metadata("design:type",String)],e.prototype,"componentID",void 0),__decorate([core.Output(),__metadata("design:type",core.EventEmitter)],e.prototype,"done",void 0),__decorate([core.ViewChild(SelectComponent,{static:!1}),__metadata("design:type",SelectComponent)],e.prototype,"selectC",void 0),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"dataSource",null),e=t=__decorate([core.Component({selector:"remote-select",template:'<div>\n    <ng-select [id]="componentID" [noFilter]="0" (selected)="selected($event)" (deselected)="removed($event)" [options]="items" [allowClear]="true"\n        [placeholder]="placeholder" [notFoundMsg]="notFoundMsg" (typed)="typed($event)" tabindex="0">\n    </ng-select>\n    <div *ngIf="loading">\n        resolving....\n    </div>\n</div>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}]}),__metadata("design:paramtypes",[core.Renderer2])],e)}(),RemoteSelectModule=function(){function e(){}return e=__decorate([core.NgModule({imports:[common.CommonModule,SelectModule,forms.FormsModule],exports:[RemoteSelectComponent],declarations:[RemoteSelectComponent],providers:[]})],e)}(),moment$8=moment_,AppointmentsOverviewComponent=function(){function e(){this.showAppointments=!1,this.loadingAppointments=!1,this.errorLoadingAppointments=!1,this.appointmentsLoaded=!1,this.appointments=[],this.today=""}return e.prototype.ngOnInit=function(){},e.prototype.ngOnChanges=function(){var e=this;this.node.control.valueChanges.subscribe((function(t){e.resetProperties();var o=e.node;if(o.question.extras.questionOptions.concept&&("a8a666ba-1350-11df-a1f1-0026b9348838"===o.question.extras.questionOptions.concept||"a89d2398-1350-11df-a1f1-0026b9348838"===o.question.extras.questionOptions.concept)&&!e.showAppointments){e.loadingAppointments=!0,e.showAppointments=!0;var n=void 0;o.form&&o.form.dataSourcesContainer.dataSources&&(n=o.form.dataSourcesContainer.dataSources.monthlyScheduleResourceService);var r=o.form.dataSourcesContainer.dataSources.userLocation.uuid;if(n&&r){var i=moment$8(t).startOf("week").add(1,"day").format("YYYY-MM-DD"),a=moment$8(t).endOf("week").subtract(1,"day").format("YYYY-MM-DD");e.today=moment$8(t).format("DD-MM-YYYY");for(var s=[],l=["781d85b0-1359-11df-a1f1-0026b9348838","781d897a-1359-11df-a1f1-0026b9348838","96047aaf-7ab3-45e9-be6a-b61810fe617d","c19aec66-1a40-4588-9b03-b6be55a8dd1d","f7793d42-11ac-4cfd-9b35-e0a21a7a7c31","334c9e98-173f-4454-a8ce-f80b20b7fdf0","96ba279b-b23b-4e78-aba9-dcbd46a96b7b","781d8880-1359-11df-a1f1-0026b9348838"].join(),c=1;c<=5;c++)s.push({date:moment$8(t).startOf("week").add(c,"day").format("DD-MM-YYYY"),count:0});n.getMonthlySchedule({startDate:i,endDate:a,limit:5,locationUuids:r,programType:l}).subscribe((function(t){e.appointmentsLoaded=!0,e.loadingAppointments=!1,s.map((function(e,o){e.count=void 0!==t[o]?t[o].count.scheduled:0})),e.appointments=s}),(function(t){e.loadingAppointments=!1,e.errorLoadingAppointments=!0,e.showAppointments=!1,console.error(t)}))}else e.showAppointments=!1,e.errorLoadingAppointments=!0}}))},e.prototype.resetProperties=function(){this.loadingAppointments=!1,this.appointmentsLoaded=!1,this.errorLoadingAppointments=!1,this.showAppointments=!1,this.appointments=[],this.today=""},__decorate([core.Input(),__metadata("design:type",LeafNode)],e.prototype,"node",void 0),e=__decorate([core.Component({selector:"appointments-overview",template:'<div *ngIf="showAppointments" class="appointments">\n  <p *ngIf="loadingAppointments">\n    <span *ngIf="!appointmentsLoaded && errorLoadingAppointments">Error checking appointments</span>\n    <span *ngIf="loadingAppointments"><span\n      class="fa fa-spinner fa-spin"></span>Checking appointments...</span>\n  </p>\n  <div *ngIf="appointmentsLoaded && !errorLoadingAppointments">\n    <table *ngIf="appointments.length>0" class="table table-stripped table-bordered">\n      <thead>\n      <tr>\n        <th *ngFor="let appointment of appointments" [ngClass]="{\'active\': appointment.date === today}">\n          <span>{{appointment.date}}</span>\n        </th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr>\n        <td *ngFor="let appointment of appointments"\n            [ngClass]="{\'active\': appointment.date === today}">\n          <span><strong><em>{{appointment.count}}</em></strong></span>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',styles:[".appointments{margin-top:12px;font-size:12px;color:#999}.appointments p{padding-top:12px}.appointments th{border-bottom:0!important;color:#333}.appointments td span,.appointments th span{display:block}.appointments td.active,.appointments th.active{background-color:#3c8dbc;color:#fff!important;padding:0}.appointments td.active span,.appointments th.active span{padding:4px}.appointments span.fa{display:inline-block;margin-right:7px}"]}),__metadata("design:paramtypes",[])],e)}(),comma=", ",newLine="\n",EncounterViewerService=function(){function e(){}return e.prototype.resolveSelectedValue=function(e){},e.prototype.searchOptions=function(e){},e.prototype.fileUpload=function(e){},e.prototype.fetchFile=function(e){},e.prototype.resolveSelectedValueFromSchema=function(e,t){var o,n=this;return t.pages&&lodash.forEach(t.pages,(function(t){var r=n.resolveSelectedValueFromSchema(e,t);r&&(o=r)})),t.sections&&lodash.forEach(t.sections,(function(t){var r=n.resolveSelectedValueFromSchema(e,t);r&&(o=r)})),t.questions&&lodash.forEach(t.questions,(function(t){if(t.questions){var r=n.resolveSelectedValueFromSchema(e,t);r&&(o=r)}else t.questionOptions.answers?lodash.forEach(t.questionOptions.answers,(function(t){t.concept===e&&(o=t.label)})):t.questionOptions.selectableOrders&&lodash.forEach(t.questionOptions.selectableOrders,(function(t){t.concept===e&&(o=t.label)}))})),o},e.prototype.hasAnswer=function(e){var t=!1;return e.initialValue&&(t=!0),t},e.prototype.questionsAnswered=function(e,t){var o=this,n=t||[];if("page"===e.question.renderingType)lodash.forEach(e.children,(function(e){o.questionsAnswered(e,n)}));else{if("section"!==e.question.renderingType)return this.hasAnswer(e);lodash.forEach(e.children,(function(e){"group"===e.question.renderingType?lodash.forEach(e.children,(function(e){var t=o.questionsAnswered(e,n);t&&n.push(t)})):o.hasAnswer(e)&&n.push(!0)}))}return n.length>0},e.prototype.isDate=function(e){return!!Date.parse(e)},e.prototype.convertTime=function(e){var t=new Date(e),o=t.getFullYear(),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],r=t.getDate(),i=t.getHours(),a=t.getMinutes();t.getSeconds();return 0===i&&0===a?r+" "+n+" "+o:r+" "+n+" "+o+" "+i+":"+a+(i<12?"AM":"PM")+" (EAT)"},e=__decorate([core.Injectable(),__metadata("design:paramtypes",[])],e)}(),EncounterViewerComponent=function(){function e(e,t){this.encounterViewerService=e,this.dataSources=t}return Object.defineProperty(e.prototype,"node",{set:function(e){this.rootNode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"schema",{set:function(e){this._schema=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encounter",{set:function(e){this.enc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"form",{set:function(e){this.rootNode=e.rootNode,this._schema=e.schema,console.log(this.getQuestionNodes(this.traverse(this.rootNode)))},enumerable:!0,configurable:!0}),e.prototype.getQuestionNodes=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push(a.page)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return[].concat.apply([],n)},e.prototype.ngOnInit=function(){this.rootNode,this.rootNode&&this.rootNode.question.extras&&"file"===this.rootNode.question.renderingType?this.fileDataSource=this.dataSources.dataSources[this.rootNode.question.dataSource]:this.rootNode&&this.rootNode.question.extras&&"remote-select"===this.rootNode.question.renderingType?this.remoteDataSource=this.dataSources.dataSources[this.rootNode.question.dataSource]:this.customDataSource=this.encounterViewerService},e.prototype.questionsAnswered=function(e){return this.encounterViewerService.questionsAnswered(e)},e.prototype.questionAnswered=function(e){return this.encounterViewerService.hasAnswer(e)},e.prototype.checkForColon=function(e){return-1===e.indexOf(":")},e.prototype.traverse=function(e,t){var o=[];if(e.children){if(e.children instanceof Array)return this.repeatingGroup(e.children);if(e.children instanceof Object){for(var n in e.children)if(e.children.hasOwnProperty(n))switch(e.children[n].question.renderingType){case"page":var r=this.traverse(e.children[n]);o.push({page:r});break;case"section":var i=this.traverse(e.children[n]);o.push({section:i});break;case"group":var a=this.traverse(e.children[n]);o.push({node:e.children[n],question:e.children[n].question,groupMembers:a});break;case"repeating":var s=this.repeatingGroup(e.children[n].children);o.push({node:e.children[n],question:e.children[n].question,groupMembers:s});break;default:o.push(e.children[n])}}else console.log("Console.log",e)}return o},e.prototype.repeatingGroup=function(e){var t,o,n=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;n.push({question:a.question,groupMembers:this.traverse(a)})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.ctorParameters=function(){return[{type:EncounterViewerService},{type:DataSources}]},__decorate([core.Input(),__metadata("design:type",AfeFormGroup)],e.prototype,"parentGroup",void 0),__decorate([core.Input(),__metadata("design:type",e)],e.prototype,"parentComponent",void 0),__decorate([core.Input(),__metadata("design:type",NodeBase),__metadata("design:paramtypes",[NodeBase])],e.prototype,"node",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"schema",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"encounter",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"form",null),e=__decorate([core.Component({selector:"encounter-viewer",template:'<div class="viewer">\n\n  <div *ngIf="rootNode.question.renderingType === \'form\'" class="form">\n    <div *ngFor="let question of rootNode.question.questions; let i = index;">\n      <div *ngIf="questionsAnswered(rootNode.children[question.key])">\n        <div [attr.id]="\'page\'+i" class="panel panel-default">\n          <p class="page-label panel-heading text-primary">{{question.label}}</p>\n          <div class="panel-body">\n            <encounter-viewer [node]="rootNode.children[question.key]" [schema]="_schema" [parentComponent]="this" [parentGroup]="rootNode.control"></encounter-viewer>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div *ngIf="rootNode.question.renderingType === \'page\'" class="page">\n    <encounter-viewer *ngFor="let question of rootNode.question.questions" [parentComponent]="this" [node]="rootNode.children[question.key]"\n      [schema]="_schema" [parentGroup]="parentGroup"></encounter-viewer>\n  </div>\n\n\n  <div *ngIf="rootNode.question.renderingType === \'section\'&& questionsAnswered(rootNode)"\n    class="section">\n    <div class="panel panel-primary">\n      <p class="panel-heading section-label">{{ rootNode.question.label }}</p>\n    </div>\n    <div *ngFor="let question of rootNode.question.questions">\n      <encounter-viewer [node]="rootNode.children[question.key]" [parentComponent]="this" [schema]="_schema" [parentGroup]="parentGroup"></encounter-viewer>\n    </div>\n  </div>\n\n  \x3c!--Leaf Controls--\x3e\n  <div style="margin-left:10px;">\n  <form *ngIf="rootNode.question.controlType === 0" [formGroup]="parentGroup">\n    <div *ngIf="rootNode.control.value">\n    <div class="question-answer">\n      <label *ngIf="rootNode.question.label" [attr.for]="rootNode.question.key" style="font-weight:400;">\n          {{ rootNode.question.label }}\n      </label>\n      <span *ngIf="checkForColon(rootNode.question.label)">:</span>\n      <div [ngSwitch]="rootNode.question.renderingType" style="display:inline-block; font-weight:bold;">\n          <div *ngSwitchCase=" \'file\' ">\n            <file-preview [formControlName]="rootNode.question.key" [id]="rootNode.question.key + \'id\'" [dataSource]="fileDataSource"></file-preview>\n          </div>\n          <div *ngSwitchCase="\'remote-select\'">\n            <remote-answer [formControlName]="rootNode.question.key" [id]="rootNode.question.key + \'id\'" [dataSource]="remoteDataSource"></remote-answer>\n          </div>\n          <div *ngSwitchDefault style="display:inline-block">\n              <question-control [schema]="_schema" [value]="rootNode.control.value" [dataSource]="customDataSource"></question-control>\n            </div>\n      </div>\n     \n    </div>\n    </div>\n  </form>\n</div>\n\n  \x3c!--Array Controls--\x3e\n  <div *ngIf="rootNode.question.controlType === 1 && questionsAnswered(rootNode)">\n    <div [ngSwitch]="rootNode.question.renderingType">\n      <div *ngSwitchCase=" \'repeating\' ">\n        <div [ngSwitch]="rootNode.question.extras.type">\n          <div *ngSwitchCase="\'testOrder\'">\n            <label>{{rootNode.question.label}}:</label>\n            <div *ngFor="let child of rootNode.children; let i=index ">\n              <encounter-viewer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n                " [parentGroup]="child.control " [schema]="_schema"></encounter-viewer>\n            </div>\n          </div>\n          \n          <div *ngSwitchCase="\'obsGroup\'">\n            <div *ngFor="let child of rootNode.children; let i=index ">\n              <encounter-viewer *ngFor="let question of child.question.questions " [parentComponent]="this" [node]="child.children[question.key]\n                " [parentGroup]="child.control " [schema]="_schema"></encounter-viewer>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div *ngIf="rootNode.question.controlType === 2">\n\n    \x3c!--GROUP--\x3e\n    <div [ngSwitch]="rootNode.question.renderingType ">\n      <div *ngSwitchCase=" \'group\' ">\n        <encounter-viewer *ngFor="let question of rootNode.question.questions " [parentComponent]="this" [node]="rootNode.children[question.key]\n                  " [parentGroup]="rootNode.control " [schema]="_schema"></encounter-viewer>\n      </div>\n      <div *ngSwitchCase=" \'field-set\' ">\n        <encounter-viewer *ngFor="let question of rootNode.question.questions " [parentComponent]="this" [node]="rootNode.children[question.key]\n                  " [parentGroup]="rootNode.control " [schema]="_schema"></encounter-viewer>\n      </div>\n    </div>\n  </div>\n\n\n\n  </div>\n',styles:[".page-label{font-size:20px;font-weight:700}.section-label{font-size:18px;font-weight:500}.panel-primary{border:none!important}.question-answer{font-size:16px}.panel{margin-bottom:5px}div.section{margin-bottom:15px!important}.line-breaker{white-space:pre-line}hr{margin:10px}"]}),__metadata("design:paramtypes",[EncounterViewerService,DataSources])],e)}(),moment$9=moment_,EncounterPdfViewerService=function(){function e(e,t,o){this.encounterViewerService=e,this.obsValueAdapter=t,this.dataSources=o,this.subscribedAnswers={questions:{stack:[]},answers:[]}}return e.prototype.getPages=function(e,t,o,n){var r,i,a,s,l=[],c=[];try{for(var u=__values(e),d=u.next();!d.done;d=u.next()){var p=d.value;if(o)c=c.concat(this.getSections(p.page,t,!1,n));else try{for(var h=(a=void 0,__values(t.rootNode.question.questions)),f=h.next();!f.done;f=h.next()){var y=f.value;p.label===t.rootNode.children[y.key].question.label&&this.encounterViewerService.questionsAnswered(t.rootNode.children[y.key])&&l.push({style:"tableExample",table:{widths:["*"],headerRows:1,keepWithHeaderRows:1,body:[[{text:p.label,style:"tableHeader"}],[{style:"tableExample",table:{widths:["*"],body:this.getSections(p.page,t,!0,n)},layout:"noBorders",margin:[5,0,0,0]}]]},layout:{hLineWidth:function(e,t){return 0===e||t.table.body.length,.5},vLineWidth:function(e,t){return 0===e||t.table.widths.length,.5},hLineColor:function(e,t){return 0===e||t.table.body.length,"#ddd"},vLineColor:function(e,t){return 0===e||t.table.body.length,"#ddd"}}})}}catch(e){a={error:e}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}}}catch(e){r={error:e}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return o?c:l},e.prototype.getSections=function(e,t,o,n){var r,i,a,s,l=this,c=[],u=[],d=[];e.map((function(e){l.encounterViewerService.questionsAnswered(e.node)&&u.push(e)}));try{for(var p=__values(u),h=p.next();!h.done;h=p.next()){var f=h.value;d=d.concat(this.getRemoteSectionData(f.section))}}catch(e){r={error:e}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(r)throw r.error}}if(o&&n){try{for(var y=__values(u),m=y.next();!m.done;m=y.next()){f=m.value;c.push([{table:{widths:["*"],body:[[{text:f.label,style:"tableSubheader"}],[this.getSectionData(f.section,n,t)]]},layout:"noBorders"}])}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=y.return)&&s.call(y)}finally{if(a)throw a.error}}return c}return d},e.prototype.appendResolvedAnswer=function(e,t,o){e&&t.stack.push({text:[(o?o.question.label:"Question label")+(o?o.question.label.indexOf(":")>1?"":":":"")+" ",{text:""+e,bold:!0}],style:"answers"})},e.prototype.getRemoteSectionData=function(e){var t,o,n=[];this.subscribedAnswers.questions.stack=[];try{for(var r=__values(e),i=r.next();!i.done;i=r.next()){var a=i.value;"remote-select"===a.question.renderingType&&(this.remoteDataSource=this.dataSources.dataSources[a.question.dataSource],""!==a.control.value&&this.remoteDataSource&&n.push(this.remoteDataSource.resolveSelectedValue(a.control.value)))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(t)throw t.error}}return n},e.prototype.getSectionData=function(e,t,o){var n,r,i={stack:[]},a="",s=function(e){var n,r;switch(e.question.renderingType){case"group":e.groupMembers&&i.stack.push(l.getSectionData(e.groupMembers,t,o));break;case"field-set":if(e.children){var s=[],c=Object.keys(e.children).map((function(t){return e.children[t]}));c&&(s.push(c),i.stack.push(l.getSectionData(s[0],t,o)))}break;case"repeating":e.groupMembers&&i.stack.push(l.getSectionData(e.groupMembers,t,o));break;case"remote-select":l.remoteDataSource=l.dataSources.dataSources[e.question.dataSource];try{for(var u=(n=void 0,__values(t)),d=u.next();!d.done;d=u.next()){var p=d.value;p.value===e.control.value&&l.appendResolvedAnswer(p.label,i,e)}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}break;default:var h=e.control.value;h&&(a=l.resolveValue(h,o),l.appendResolvedAnswer(a,i,e))}},l=this;try{for(var c=__values(e),u=c.next();!u.done;u=c.next()){s(u.value)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return i},e.prototype.resolveValue=function(e,t,o){var n=this;if(""!==e){if(this.isUuid(e)){var r=this.encounterViewerService.resolveSelectedValueFromSchema(e,t.schema);return o?r:r?r.toUpperCase():e}if(lodash.isArray(e)){var i=[];return lodash.forEach(e,(function(e){i.push(n.resolveValue(e,t,!0))})),i.toString()}if(this.isDate(e))return this.encounterViewerService.convertTime(e);if("object"==typeof e){var a=[],s=Object.keys(e).map((function(t){return[t,e[t]]}));return a.push(s),a}return e}},e.prototype.generatePdfDefinition=function(e){var t=this,o=new rxjs.BehaviorSubject({}),n=this.getPages(this.obsValueAdapter.traverse(e.rootNode),e,!0);return rxjs.combineLatest(n).subscribe((function(n){if(n){var r={pageSize:"A4",content:t.getPages(t.obsValueAdapter.traverse(e.rootNode),e,!1,n),styles:{answers:{fontSize:8},banner:{fontSize:9,bold:!0,margin:[50,15,30,0]},bannerItem:{margin:[2,2,2,2]},bannerLabel:{color:"#2f4f4f"},confidential:{color:"red",fontSize:8,bold:!0,margin:[60,0,0,0]},footer:{alignment:"center",fontSize:8,bold:!0},header:{fontSize:9,bold:!0,margin:[5,5,5,5]},pageNumber:{color:"#2f4f4f",fontSize:6},tableExample:{fontSize:10,margin:[5,0,0,5]},tableHeader:{fillColor:"#f5f5f5",width:["100%"],borderColor:"#333",fontSize:9,bold:!0,margin:[5,0,5,0]},tableSubheader:{fillColor:"#337ab7",width:["100%"],fontSize:9,color:"white",margin:[5,0,5,0]},timestamp:{bold:!0,color:"#2f4f4f"}},defaultStyle:{fontSize:7}};o.next(r)}})),o},e.prototype.displayPdf=function(e){var t,o=this,n=pdfMake;n.vfs=pdfMake.vfs,e.dataSourcesContainer.dataSources._dataSources&&(t=e.dataSourcesContainer.dataSources._dataSources.patientInfo),this.generatePdfDefinition(e).subscribe((function(e){if(!lodash.isEmpty(e)){if(void 0!==t){var r=[];t.name&&r.push({text:[{text:"Name: ",style:"bannerLabel"},{text:""+o.titleize(t.name)}],style:"bannerItem"}),t.nid&&r.push({text:[{text:"ID: ",style:"bannerLabel"},{text:""+t.nid}],style:"bannerItem"}),t.birthdate&&r.push({text:[{text:"DOB: ",style:"bannerLabel"},{text:moment$9(t.birthdate).format("l")+" ("+t.age+" yo)"}],style:"bannerItem"}),t.mui&&r.push({text:[{text:"MUI: ",style:"bannerLabel"},{text:""+t.mui}],style:"bannerItem"}),t.mhn&&r.push({text:[{text:"MTRH No: ",style:"bannerLabel"},{text:""+t.mhn}],style:"bannerItem"}),e.header={style:"banner",table:{body:[r]},layout:"noBorders"}}e.footer=function(e,t){return{style:"footer",widths:["*","auto"],table:{body:[[{text:"Note: Confidentiality is one of the core duties of all medical practitioners. Patients' personal health information should be kept private.",style:"confidential"},""],[{text:"Generated on "+(new Date).toUTCString(),style:"timestamp"},{text:e.toString()+" of "+t,style:"pageNumber"}]]},layout:"noBorders"}};var i=window.open("","_blank");n.createPdf(e).open({},i)}}),(function(e){console.log("Error: ",e)}))},e.prototype.isDate=function(e){return moment$9(e,moment$9.ISO_8601,!0).isValid()},e.prototype.isUuid=function(e){return 36===e.length&&-1===e.indexOf(" ")&&-1===e.indexOf(".")},e.prototype.titleize=function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},e.ctorParameters=function(){return[{type:EncounterViewerService},{type:ObsValueAdapter},{type:DataSources}]},e.ngInjectableDef=core.defineInjectable({factory:function(){return new e(core.inject(EncounterViewerService),core.inject(ObsValueAdapter),core.inject(DataSources))},token:e,providedIn:"root"}),e=__decorate([core.Injectable({providedIn:"root"}),__metadata("design:paramtypes",[EncounterViewerService,ObsValueAdapter,DataSources])],e)}(),EncounterContainerComponent=function(){function e(e,t){this.encAdapter=e,this.encounterPdfViewerService=t}return Object.defineProperty(e.prototype,"form",{set:function(e){this.$form=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"encounter",{set:function(e){this.$enc=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.displayPdf=function(){this.encounterPdfViewerService.displayPdf(this.$form)},e.ctorParameters=function(){return[{type:EncounterAdapter},{type:EncounterPdfViewerService}]},__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"form",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"encounter",null),e=__decorate([core.Component({selector:"encounter-renderer",template:'<a type="button" style="display: block; font-size: 28px; cursor: pointer" class="text-right" (click)="displayPdf()">\n  <span class="glyphicon text-primary glyphicon-print"></span>\n</a>\n<encounter-viewer class="card" [form]="$form" [encounter]="$enc"></encounter-viewer>',styles:[".card{box-shadow:0 2px 5px 0 rgba(0,0,0,.16),0 2px 10px 0 rgba(0,0,0,.12)}"]}),__metadata("design:paramtypes",[EncounterAdapter,EncounterPdfViewerService])],e)}(),QuestionControlComponent=function(){function e(){this.innerValue=""}return Object.defineProperty(e.prototype,"schema",{set:function(e){this._schema=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{set:function(e){this._value=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.writeValue(this._value)},e.prototype.isUuid=function(e){return 36===e.length&&-1===e.indexOf(" ")&&-1===e.indexOf(".")},e.prototype.writeValue=function(e,t){var o=this;if(e!==this.innerValue)if(this.isUuid(e)){if(t)return this._dataSource.resolveSelectedValueFromSchema(e,this._schema);var n=this._dataSource.resolveSelectedValueFromSchema(e,this._schema);this.innerValue=n?n.toUpperCase():e}else if(lodash.isArray(e)){var r=[];lodash.forEach(e,(function(e){r.push(o.writeValue(e,!0))})),this.innerValue=r}else if(this.isDate(e)){if(t)return this._dataSource.convertTime(e);this.innerValue=this._dataSource.convertTime(e)}else{if(t)return e;this.innerValue=e}},e.prototype.isDate=function(e){return this._dataSource.isDate(e)&&!lodash.isNumber(e)},__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"schema",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"value",null),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"dataSource",null),e=__decorate([core.Component({selector:"question-control",template:"<div>\n    {{innerValue}}\n</div>",styles:["input{border:none;box-shadow:none;color:#000;background:#fff!important;padding-top:23px;display:block;position:relative}"]}),__metadata("design:paramtypes",[])],e)}(),noop=function(){},0=noop,FilePreviewComponent=function(){function e(e){this.encounterService=e,this.fileUuid=null,this.resultsIsPdf=!1,this.onTouchedCallback=noop,this.onChangeCallback=noop}var t;return t=e,Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},Object.defineProperty(e.prototype,"value",{get:function(){return this.fileUuid},set:function(e){e!==this.fileUuid&&(this.fileUuid=e)},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){e!==this.fileUuid&&(this.fileUuid=e,this.checkFileType())},e.prototype.checkFileType=function(){-1!==this.fileUuid.search(/pdf/gi)&&(this.resultsIsPdf=!0)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},e.prototype.onBlur=function(){this.onTouchedCallback()},e.prototype.onChange=function(e){},e.prototype.getUrl=function(){this.dataSource.fetchFile(this.fileUuid,"pdf").subscribe((function(e){window.open(e.changingThisBreaksApplicationSecurity,"_blank")}))},e.ctorParameters=function(){return[{type:EncounterViewerService}]},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"source",void 0),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"dataSource",null),e=t=__decorate([core.Component({selector:"file-preview",template:'<div *ngIf="fileUuid">\n              <img *ngIf="!resultsIsPdf" class="img-responsive"\n                [src]="fileUuid | secure:this._dataSource.fetchFile" alt="image" />\n                </div>\n                <a *ngIf="resultsIsPdf" (click)="getUrl()" style="cursor: pointer"><u>Open PDF</u></a>\n                ',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}],styles:[""]}),__metadata("design:paramtypes",[EncounterViewerService])],e)}(),noop$1=function(){},0$1=noop$1,RemoteAnswerComponent=function(){function e(){this.innerValue=null,this.onTouchedCallback=noop$1,this.onChangeCallback=noop$1}var t;return t=e,Object.defineProperty(e.prototype,"dataSource",{get:function(){return this._dataSource},set:function(e){this._dataSource=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.innerValue},set:function(e){e!==this.innerValue&&(this.innerValue=e)},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){var t=this;e!==this.innerValue&&(this._dataSource?this._dataSource.resolveSelectedValue(e).subscribe((function(e){t.innerValue=e.label})):this.innerValue=e)},e.prototype.registerOnChange=function(e){this.onChangeCallback=e},e.prototype.registerOnTouched=function(e){this.onTouchedCallback=e},e.prototype.onBlur=function(){this.onTouchedCallback()},e.prototype.onChange=function(e){},__decorate([core.Input(),__metadata("design:type",Object)],e.prototype,"source",void 0),__decorate([core.Input(),__metadata("design:type",Object),__metadata("design:paramtypes",[Object])],e.prototype,"dataSource",null),e=t=__decorate([core.Component({selector:"remote-answer",template:'\n    <div *ngIf="innerValue">\n      {{innerValue}}\n      </div>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}]}),__metadata("design:paramtypes",[])],e)}(),EncounterViewerModule=function(){function e(){}return e=__decorate([core.NgModule({declarations:[EncounterViewerComponent,EncounterContainerComponent,QuestionControlComponent,FilePreviewComponent,RemoteAnswerComponent],imports:[forms.FormsModule,forms.ReactiveFormsModule,common.CommonModule,SharedModule],providers:[EncounterViewerService,EncounterPdfViewerService],exports:[EncounterContainerComponent]})],e)}(),CheckboxControlComponent=function(){function e(){this._value=[],this.onChange=function(e){},this.onTouched=function(){}}var t;return t=e,e.prototype.ngOnInit=function(){var e=this;this.options=this.options.map((function(t){return-1!==e.selected.indexOf(t.value)&&Object.assign(t,{checked:!0}),t}))},e.prototype.ngAfterViewInit=function(){},e.prototype.writeValue=function(e){this.value=e},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},Object.defineProperty(e.prototype,"value",{get:function(){return 0===this._value.length?"":this._value||this._value[0]},set:function(e){if(null==e||""===e)e=[];else if("string"==typeof e)e=[e];else if(!Array.isArray(e))throw new TypeError("Value must be a string or an array.")},enumerable:!0,configurable:!0}),e.prototype.selectOpt=function(e,t){var o=this;t.target.checked?this._value.push(e.value):this.options.forEach((function(t){t.value===e.value&&o._value.splice(t,1)})),this.onChange(this.value)},__decorate([core.Input(),__metadata("design:type",Array)],e.prototype,"options",void 0),__decorate([core.Input(),__metadata("design:type",Array)],e.prototype,"selected",void 0),e=t=__decorate([core.Component({selector:"checkbox",template:'<div *ngFor="let option of options; let i = index;">\n    <label class="form-control no-border">\n        <input type="checkbox" id="i + \'id\'" (change)="selectOpt(option, $event)" value="option.value" [checked]="option.checked">\n        {{ option.label }}\n    </label>\n</div>\n',providers:[{provide:forms.NG_VALUE_ACCESSOR,useExisting:core.forwardRef((function(){return t})),multi:!0}],styles:["\n    .no-border {\n      border: 0;\n      box-shadow: none;\n    }"]})],e)}(),CheckboxModule=function(){function e(){}return e=__decorate([core.NgModule({declarations:[CheckboxControlComponent],exports:[CheckboxControlComponent],imports:[common.CommonModule,forms.FormsModule]})],e)}(),FormEntryModule=function(){function e(){}return e=__decorate([core.NgModule({imports:[common.CommonModule,forms.ReactiveFormsModule,collapse.CollapseModule,SelectModule,DateTimePickerModule,RemoteSelectModule,RemoteFileUploadModule,EncounterViewerModule,CheckboxModule,material.MatIconModule,material.MatTabsModule,material.MatCardModule,NgxDateTimePickerModule,SharedModule],declarations:[FormRendererComponent,AfeNgSelectComponent,AppointmentsOverviewComponent,HistoricalValueDirective,ErrorRendererComponent,timeAgoPipe.TimeAgoPipe],providers:[forms.FormBuilder,FormControlService,FormErrorsService,ValidationFactory,HidersDisablersFactory,AlertsFactory,ExpressionRunner,JsExpressionHelper,HistoricalFieldHelperService,FormSchemaCompiler,FormFactory,QuestionFactory,ValidationFactory,ControlRelationsFactory,ObsAdapterHelper,ObsValueAdapter,EncounterAdapter,PersonAttribuAdapter,OrderValueAdapter,DebugModeService],exports:[FormRendererComponent,AfeNgSelectComponent,ErrorRendererComponent,DateTimePickerModule,EncounterViewerModule,NgxDateTimePickerModule]})],e)}(),Pair=function(e,t){this.key=e,this.value=t},RenderingType;RenderingType=exports.RenderingType||(exports.RenderingType={}),RenderingType[RenderingType.Form=0]="Form",RenderingType[RenderingType.Page=1]="Page",RenderingType[RenderingType.Section=2]="Section",RenderingType[RenderingType.Select=3]="Select",RenderingType[RenderingType.DropDown=4]="DropDown",exports.AfeFormArray=AfeFormArray,exports.AfeFormControl=AfeFormControl,exports.AfeFormGroup=AfeFormGroup,exports.CheckBoxQuestion=CheckBoxQuestion,exports.ConditionalValidationModel=ConditionalValidationModel,exports.ControlRelationsFactory=ControlRelationsFactory,exports.DataSources=DataSources,exports.DateQuestion=DateQuestion,exports.DateTimePickerModule=DateTimePickerModule,exports.DateValidationModel=DateValidationModel,exports.EncounterAdapter=EncounterAdapter,exports.EncounterPdfViewerService=EncounterPdfViewerService,exports.FileUploadQuestion=FileUploadQuestion,exports.Form=Form,exports.FormControlService=FormControlService,exports.FormEntryModule=FormEntryModule,exports.FormErrorsService=FormErrorsService,exports.FormFactory=FormFactory,exports.FormSchemaCompiler=FormSchemaCompiler,exports.HistoricalEncounterDataService=HistoricalEncounterDataService,exports.JsExpressionHelper=JsExpressionHelper,exports.JsExpressionValidationModel=JsExpressionValidationModel,exports.MaxValidationModel=MaxValidationModel,exports.MinValidationModel=MinValidationModel,exports.MultiSelectQuestion=MultiSelectQuestion,exports.NestedQuestion=NestedQuestion,exports.NgxDateTimePickerModule=NgxDateTimePickerModule,exports.ObsAdapterHelper=ObsAdapterHelper,exports.ObsValueAdapter=ObsValueAdapter,exports.Option=Option$1,exports.OrderValueAdapter=OrderValueAdapter,exports.Pair=Pair,exports.PersonAttribuAdapter=PersonAttribuAdapter,exports.QuestionBase=QuestionBase,exports.QuestionFactory=QuestionFactory,exports.QuestionGroup=QuestionGroup,exports.RepeatingQuestion=RepeatingQuestion,exports.SelectQuestion=SelectQuestion,exports.TestOrderQuestion=TestOrderQuestion,exports.TextAreaInputQuestion=TextAreaInputQuestion,exports.TextInputQuestion=TextInputQuestion,exports.UiSelectQuestion=UiSelectQuestion,exports.ValidationFactory=ValidationFactory,exports.ValidationModel=ValidationModel,exports.a=SelectModule,exports.b=SELECT_VALUE_ACCESSOR,exports.ba=MY_FORMATS,exports.bb=NgxDateTimePickerComponent,exports.bc=FormRendererComponent,exports.bd=DEFAULT_STYLES,exports.be=AfeNgSelectComponent,exports.bf=AppointmentsOverviewComponent,exports.bg=HistoricalValueDirective,exports.bh=HistoricalFieldHelperService,exports.bi=ErrorRendererComponent,exports.bj=HidersDisablersFactory,exports.bk=ExpressionRunner,exports.bl=DebugModeService,exports.bm=AlertsFactory,exports.c=SelectComponent,exports.d=STYLE,exports.e=SelectDropdownComponent,exports.f=STYLE$1,exports.g=DatePickerComponent,exports.h=TimePickerComponent,exports.i=ModalComponent,exports.j=MomentPipe,exports.k=DateTimePickerComponent,exports.l=RemoteSelectModule,exports.m=RemoteSelectComponent,exports.n=RemoteFileUploadModule,exports.o=SharedModule,exports.p=SecurePipe,exports.q=FileUploadComponent,exports.r=EncounterViewerModule,exports.s=EncounterViewerComponent,exports.t=EncounterViewerService,exports.u=EncounterContainerComponent,exports.v=QuestionControlComponent,exports.w=FilePreviewComponent,exports.x=RemoteAnswerComponent,exports.y=CheckboxModule,exports.z=CheckboxControlComponent,Object.defineProperty(exports,"__esModule",{value:!0})}));
//# sourceMappingURL=ampath-kenya-ngx-openmrs-formentry.umd.min.js.map